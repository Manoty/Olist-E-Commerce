[0m12:22:24.424811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190B1AD84D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190B1ADB9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190B1ADAA10>]}


============================== 12:22:24.434491 | c2085d51-3d18-499a-b38d-8e2ed6cda440 ==============================
[0m12:22:24.434491 [info ] [MainThread]: Running with dbt=1.7.9
[0m12:22:24.436489 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m12:22:24.438483 [info ] [MainThread]: dbt version: 1.7.9
[0m12:22:24.439480 [info ] [MainThread]: python version: 3.11.3
[0m12:22:24.441478 [info ] [MainThread]: python path: C:\kev\Olist Ecommerce\olist\venv\Scripts\python.exe
[0m12:22:24.443471 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m12:22:24.453483 [info ] [MainThread]: Using profiles dir at C:\Users\Evans Moseti\.dbt
[0m12:22:24.456438 [info ] [MainThread]: Using profiles.yml file at C:\Users\Evans Moseti\.dbt\profiles.yml
[0m12:22:24.460424 [info ] [MainThread]: Using dbt_project.yml file at C:\kev\Olist Ecommerce\olist\dbt_project.yml
[0m12:22:24.473547 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:22:24.475540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c2085d51-3d18-499a-b38d-8e2ed6cda440', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190B1B59A10>]}
[0m12:22:24.616524 [info ] [MainThread]: Configuration:
[0m12:22:24.617522 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m12:22:24.619574 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:22:24.622596 [info ] [MainThread]: Required dependencies:
[0m12:22:24.625423 [debug] [MainThread]: Executing "git --help"
[0m12:22:24.690330 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:22:24.692327 [debug] [MainThread]: STDERR: "b''"
[0m12:22:24.693363 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:22:24.695318 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:22:24.696316 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:22:24.697312 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'olist_project'


[0m12:22:24.700308 [debug] [MainThread]: Command `dbt debug` failed at 12:22:24.700308 after 0.41 seconds
[0m12:22:24.701301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190AAE19DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190AAE19A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190B1B17350>]}
[0m12:22:24.705291 [debug] [MainThread]: Flushing usage events
[0m12:25:11.642247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249101B8510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249101BB110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249101BBC10>]}


============================== 12:25:11.647254 | 87269ded-d882-403d-83b7-14ac81fe7388 ==============================
[0m12:25:11.647254 [info ] [MainThread]: Running with dbt=1.7.9
[0m12:25:11.652286 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m12:25:11.652286 [info ] [MainThread]: dbt version: 1.7.9
[0m12:25:11.652286 [info ] [MainThread]: python version: 3.11.3
[0m12:25:11.652286 [info ] [MainThread]: python path: C:\kev\Olist Ecommerce\olist\venv\Scripts\python.exe
[0m12:25:11.659202 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m12:25:11.892513 [info ] [MainThread]: Using profiles dir at C:\Users\Evans Moseti\.dbt
[0m12:25:11.892513 [info ] [MainThread]: Using profiles.yml file at C:\Users\Evans Moseti\.dbt\profiles.yml
[0m12:25:11.892513 [info ] [MainThread]: Using dbt_project.yml file at C:\kev\Olist Ecommerce\olist\dbt_project.yml
[0m12:25:11.892513 [info ] [MainThread]: adapter type: duckdb
[0m12:25:11.906859 [info ] [MainThread]: adapter version: 1.7.5
[0m12:25:11.926175 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:25:11.929166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '87269ded-d882-403d-83b7-14ac81fe7388', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002491035E2D0>]}
[0m12:25:12.072617 [info ] [MainThread]: Configuration:
[0m12:25:12.077626 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:25:12.077626 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:25:12.082146 [info ] [MainThread]: Required dependencies:
[0m12:25:12.083980 [debug] [MainThread]: Executing "git --help"
[0m12:25:12.158618 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:25:12.160613 [debug] [MainThread]: STDERR: "b''"
[0m12:25:12.161629 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:25:12.162609 [info ] [MainThread]: Connection:
[0m12:25:12.164603 [info ] [MainThread]:   database: olist
[0m12:25:12.166597 [info ] [MainThread]:   schema: analytics
[0m12:25:12.167594 [info ] [MainThread]:   path: ../olist.duckdb
[0m12:25:12.169601 [info ] [MainThread]:   config_options: None
[0m12:25:12.170598 [info ] [MainThread]:   extensions: None
[0m12:25:12.171597 [info ] [MainThread]:   settings: None
[0m12:25:12.174206 [info ] [MainThread]:   external_root: .
[0m12:25:12.176283 [info ] [MainThread]:   use_credential_provider: None
[0m12:25:12.180025 [info ] [MainThread]:   attach: None
[0m12:25:12.181715 [info ] [MainThread]:   filesystems: None
[0m12:25:12.182713 [info ] [MainThread]:   remote: None
[0m12:25:12.184748 [info ] [MainThread]:   plugins: None
[0m12:25:12.184748 [info ] [MainThread]:   disable_transactions: False
[0m12:25:12.188102 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m12:25:12.193331 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:25:12.193331 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:25:12.193331 [debug] [MainThread]: On debug: select 1 as id
[0m12:25:12.193331 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:12.238939 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:25:12.242915 [debug] [MainThread]: On debug: Close
[0m12:25:12.244956 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:25:12.244956 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:25:12.244956 [debug] [MainThread]: Command `dbt debug` succeeded at 12:25:12.244956 after 0.72 seconds
[0m12:25:12.252484 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:25:12.252484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002490F642B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002490FCBD550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002490FCBD4D0>]}
[0m12:25:12.256751 [debug] [MainThread]: Flushing usage events
[0m12:27:21.371605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7A616450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7A51BC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7A51BA50>]}


============================== 12:27:21.380583 | 02c24eba-df14-4070-a42f-9cf5f93c6756 ==============================
[0m12:27:21.380583 [info ] [MainThread]: Running with dbt=1.7.9
[0m12:27:21.383573 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m12:27:21.640914 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:27:21.642907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '02c24eba-df14-4070-a42f-9cf5f93c6756', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7A77B950>]}
[0m12:27:21.898367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02c24eba-df14-4070-a42f-9cf5f93c6756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7A78C290>]}
[0m12:27:22.068254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02c24eba-df14-4070-a42f-9cf5f93c6756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7A830190>]}
[0m12:27:22.071209 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m12:27:22.104122 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m12:27:22.106114 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:27:22.107112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '02c24eba-df14-4070-a42f-9cf5f93c6756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7A6EDC50>]}
[0m12:27:27.177508 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.olist_project.stg_customers__customers' (models\staging\stg_customers__customers.sql) depends on a source named 'olist.raw_customers' which was not found
[0m12:27:27.183492 [debug] [MainThread]: Command `dbt run` failed at 12:27:27.182495 after 5.95 seconds
[0m12:27:27.184489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7A6D9450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A79EE0B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7BC56850>]}
[0m12:27:27.185486 [debug] [MainThread]: Flushing usage events
[0m12:31:07.914306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B44BC7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B43980410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B44BAD890>]}


============================== 12:31:07.920538 | b7936412-63e4-424c-a09f-9c2c0fb56713 ==============================
[0m12:31:07.920538 [info ] [MainThread]: Running with dbt=1.7.9
[0m12:31:07.923527 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m12:31:08.139560 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:31:08.141559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b7936412-63e4-424c-a09f-9c2c0fb56713', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B44C38FD0>]}
[0m12:31:08.307925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7936412-63e4-424c-a09f-9c2c0fb56713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B44BFA350>]}
[0m12:31:08.447867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7936412-63e4-424c-a09f-9c2c0fb56713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B44BAE950>]}
[0m12:31:08.450649 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m12:31:08.466609 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m12:31:08.468606 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:31:08.471610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b7936412-63e4-424c-a09f-9c2c0fb56713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B45E37B10>]}
[0m12:31:10.308792 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.olist_project.stg_customers__customers' (models\staging\stg_customers__customers.sql) depends on a source named 'olist.raw_customers' which was not found
[0m12:31:10.311787 [debug] [MainThread]: Command `dbt run` failed at 12:31:10.310789 after 2.51 seconds
[0m12:31:10.312782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B44BC2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B45EE8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B3DDF9F10>]}
[0m12:31:10.314159 [debug] [MainThread]: Flushing usage events
[0m12:33:20.633370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C401C34F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C401A3F850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C401401490>]}


============================== 12:33:20.639499 | d74dc34e-4298-471c-9148-345848a45093 ==============================
[0m12:33:20.639499 [info ] [MainThread]: Running with dbt=1.7.9
[0m12:33:20.641604 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m12:33:20.855824 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:33:20.857545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd74dc34e-4298-471c-9148-345848a45093', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C401402E10>]}
[0m12:33:21.017138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd74dc34e-4298-471c-9148-345848a45093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C401C6EF50>]}
[0m12:33:21.155454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd74dc34e-4298-471c-9148-345848a45093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C402DF0C10>]}
[0m12:33:21.158201 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m12:33:21.173359 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m12:33:21.175354 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:33:21.178348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd74dc34e-4298-471c-9148-345848a45093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C401CB6C50>]}
[0m12:33:23.631333 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m12:33:23.642047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd74dc34e-4298-471c-9148-345848a45093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4031886D0>]}
[0m12:33:23.676129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd74dc34e-4298-471c-9148-345848a45093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C403265150>]}
[0m12:33:23.677125 [info ] [MainThread]: Found 6 models, 9 seeds, 9 tests, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m12:33:23.679121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd74dc34e-4298-471c-9148-345848a45093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C40318AB50>]}
[0m12:33:23.685105 [info ] [MainThread]: 
[0m12:33:23.687233 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:33:23.690226 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m12:33:23.723137 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m12:33:23.724135 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"olist"'
    
  
  
[0m12:33:23.725133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:23.803131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:33:23.807122 [debug] [ThreadPool]: On list_olist: Close
[0m12:33:23.812236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_analytics_staging)
[0m12:33:23.815229 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "analytics_staging"
"
[0m12:33:23.826776 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:33:23.827773 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
        select type from duckdb_databases()
        where database_name='olist'
        and type='sqlite'
    
  
[0m12:33:23.828771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:23.844726 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:33:23.847719 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:33:23.848715 [debug] [ThreadPool]: On create_olist_analytics_staging: BEGIN
[0m12:33:23.849713 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:33:23.850710 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:33:23.851707 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
    
        create schema if not exists "olist"."analytics_staging"
    
[0m12:33:23.854708 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:33:23.857692 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m12:33:23.858688 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:33:23.859687 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m12:33:23.866667 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:33:23.867665 [debug] [ThreadPool]: On create_olist_analytics_staging: Close
[0m12:33:23.885617 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m12:33:23.898191 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m12:33:23.899187 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m12:33:23.906167 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m12:33:23.908162 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m12:33:23.909159 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m12:33:23.910158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:23.911154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:23.934616 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:33:23.935615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:33:23.936611 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m12:33:23.937707 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m12:33:23.938707 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m12:33:23.940701 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m12:33:24.127969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:33:24.133955 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:33:24.136947 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m12:33:24.139939 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m12:33:24.142929 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m12:33:24.144923 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m12:33:24.147916 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m12:33:24.148913 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m12:33:24.160882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd74dc34e-4298-471c-9148-345848a45093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C40318FA90>]}
[0m12:33:24.163876 [debug] [MainThread]: Using duckdb connection "master"
[0m12:33:24.165869 [debug] [MainThread]: On master: BEGIN
[0m12:33:24.166866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:33:24.184818 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:33:24.185816 [debug] [MainThread]: On master: COMMIT
[0m12:33:24.187810 [debug] [MainThread]: Using duckdb connection "master"
[0m12:33:24.188806 [debug] [MainThread]: On master: COMMIT
[0m12:33:24.190801 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:33:24.191801 [debug] [MainThread]: On master: Close
[0m12:33:24.195787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:33:24.196785 [info ] [MainThread]: 
[0m12:33:24.211041 [debug] [Thread-1 (]: Began running node model.olist_project.stg_customers__customers
[0m12:33:24.213036 [debug] [Thread-2 (]: Began running node model.olist_project.stg_order_items__order_items
[0m12:33:24.216030 [debug] [Thread-3 (]: Began running node model.olist_project.stg_orders__orders
[0m12:33:24.217025 [debug] [Thread-4 (]: Began running node model.olist_project.stg_payments__payments
[0m12:33:24.218024 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_customers__customers ........ [RUN]
[0m12:33:24.221017 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_order_items__order_items .... [RUN]
[0m12:33:24.224008 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_orders__orders .............. [RUN]
[0m12:33:24.226002 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_staging.stg_payments__payments .......... [RUN]
[0m12:33:24.229992 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_project.stg_customers__customers'
[0m12:33:24.233983 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_project.stg_order_items__order_items'
[0m12:33:24.235976 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_project.stg_orders__orders'
[0m12:33:24.237971 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_project.stg_payments__payments'
[0m12:33:24.240962 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_customers__customers
[0m12:33:24.241961 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_order_items__order_items
[0m12:33:24.243956 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_orders__orders
[0m12:33:24.245949 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_payments__payments
[0m12:33:24.264901 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_customers__customers"
[0m12:33:24.274871 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_order_items__order_items"
[0m12:33:24.284846 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_orders__orders"
[0m12:33:24.289831 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_payments__payments"
[0m12:33:24.303793 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (compile): 12:33:24.246946 => 12:33:24.302799
[0m12:33:24.305789 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_customers__customers
[0m12:33:24.307794 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (compile): 12:33:24.275868 => 12:33:24.306786
[0m12:33:24.308781 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (compile): 12:33:24.285841 => 12:33:24.307794
[0m12:33:24.321985 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (compile): 12:33:24.265896 => 12:33:24.321985
[0m12:33:24.370489 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_customers__customers"
[0m12:33:24.371497 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_orders__orders
[0m12:33:24.372484 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_payments__payments
[0m12:33:24.373480 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_order_items__order_items
[0m12:33:24.381493 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_orders__orders"
[0m12:33:24.389438 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_payments__payments"
[0m12:33:24.398451 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_order_items__order_items"
[0m12:33:24.402405 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m12:33:24.404414 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m12:33:24.405394 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: BEGIN
[0m12:33:24.407391 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m12:33:24.408389 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m12:33:24.409384 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: BEGIN
[0m12:33:24.410417 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:33:24.411380 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: BEGIN
[0m12:33:24.413374 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: BEGIN
[0m12:33:24.414373 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:33:24.427334 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m12:33:24.428333 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:33:24.429361 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:33:24.431327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:33:24.432324 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m12:33:24.434317 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m12:33:24.435315 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m12:33:24.436347 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m12:33:24.437418 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_orders__orders__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
  from "olist"."main"."raw_orders"
)

, cleaned as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_at,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_at,
    order_delivered_customer_date::timestamp as order_delivered_customer_at,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_at,
    case 
      when order_delivered_customer_date is not null 
      then (order_delivered_customer_date::timestamp - order_purchase_timestamp::timestamp).days
      else null 
    end as days_to_delivery,
    case
      when order_delivered_customer_date > order_estimated_delivery_date then true
      else false
    end as is_late_delivery
  from source
)

select * from cleaned
    );
  
  
[0m12:33:24.438448 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m12:33:24.439414 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m12:33:24.440517 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_customers__customers__dbt_tmp"
  
    as (
      

with source as (
  select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
  from "olist"."main"."raw_customers"
)

select
  customer_id,
  customer_unique_id,
  customer_zip_code_prefix,
  customer_city,
  customer_state
from source
    );
  
  
[0m12:33:24.442514 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_payments__payments__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
  from "olist"."main"."raw_order_payments"
)

select * from source
    );
  
  
[0m12:33:24.443511 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."main"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m12:33:24.538857 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (execute): 12:33:24.308781 => 12:33:24.538857
[0m12:33:24.539858 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (execute): 12:33:24.390439 => 12:33:24.539858
[0m12:33:24.540976 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (execute): 12:33:24.374479 => 12:33:24.540976
[0m12:33:24.541851 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (execute): 12:33:24.383460 => 12:33:24.541851
[0m12:33:24.542850 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: ROLLBACK
[0m12:33:24.544846 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: ROLLBACK
[0m12:33:24.545841 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: ROLLBACK
[0m12:33:24.546845 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: ROLLBACK
[0m12:33:24.602970 [debug] [Thread-4 (]: Failed to rollback 'model.olist_project.stg_payments__payments'
[0m12:33:24.605000 [debug] [Thread-1 (]: Failed to rollback 'model.olist_project.stg_customers__customers'
[0m12:33:24.608955 [debug] [Thread-2 (]: Failed to rollback 'model.olist_project.stg_order_items__order_items'
[0m12:33:24.609954 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: Close
[0m12:33:24.615401 [debug] [Thread-3 (]: Failed to rollback 'model.olist_project.stg_orders__orders'
[0m12:33:24.616475 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: Close
[0m12:33:24.617007 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: Close
[0m12:33:24.620523 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: Close
[0m12:33:24.625508 [debug] [Thread-4 (]: Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "temp.pg_catalog.pg_depend"?
  LINE 20:   from "olist"."main"."raw_order_payments"
                  ^
[0m12:33:24.634961 [debug] [Thread-1 (]: Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "information_schema.columns"?
  LINE 20:   from "olist"."main"."raw_customers"
                  ^
[0m12:33:24.635927 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd74dc34e-4298-471c-9148-345848a45093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C403490950>]}
[0m12:33:24.639030 [debug] [Thread-2 (]: Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m12:33:24.639508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd74dc34e-4298-471c-9148-345848a45093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4034A2590>]}
[0m12:33:24.642155 [debug] [Thread-3 (]: Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "information_schema.tables"?
  LINE 23:   from "olist"."main"."raw_orders"
                  ^
[0m12:33:24.645145 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd74dc34e-4298-471c-9148-345848a45093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4034A0E50>]}
[0m12:33:24.643149 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model analytics_staging.stg_payments__payments . [[31mERROR[0m in 0.40s]
[0m12:33:24.647412 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd74dc34e-4298-471c-9148-345848a45093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C40349B0D0>]}
[0m12:33:24.646128 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model analytics_staging.stg_customers__customers  [[31mERROR[0m in 0.41s]
[0m12:33:24.648903 [error] [Thread-2 (]: 2 of 6 ERROR creating sql table model analytics_staging.stg_order_items__order_items  [[31mERROR[0m in 0.41s]
[0m12:33:24.651357 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_payments__payments
[0m12:33:24.656344 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_customers__customers
[0m12:33:24.654349 [error] [Thread-3 (]: 3 of 6 ERROR creating sql table model analytics_staging.stg_orders__orders ..... [[31mERROR[0m in 0.41s]
[0m12:33:24.658379 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_order_items__order_items
[0m12:33:24.660334 [debug] [Thread-4 (]: Began running node model.olist_project.stg_products__products
[0m12:33:24.662328 [debug] [Thread-1 (]: Began running node model.olist_project.stg_sellers__sellers
[0m12:33:24.666318 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_orders__orders
[0m12:33:24.669311 [info ] [Thread-4 (]: 5 of 6 START sql table model analytics_staging.stg_products__products .......... [RUN]
[0m12:33:24.672304 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics_staging.stg_sellers__sellers ............ [RUN]
[0m12:33:24.675294 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_payments__payments, now model.olist_project.stg_products__products)
[0m12:33:24.676291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_customers__customers, now model.olist_project.stg_sellers__sellers)
[0m12:33:24.677288 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_products__products
[0m12:33:24.678286 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_sellers__sellers
[0m12:33:24.685268 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_products__products"
[0m12:33:24.694242 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_sellers__sellers"
[0m12:33:24.707212 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_products__products (compile): 12:33:24.679291 => 12:33:24.705215
[0m12:33:24.709203 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_sellers__sellers (compile): 12:33:24.686266 => 12:33:24.708207
[0m12:33:24.711198 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_products__products
[0m12:33:24.715319 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_sellers__sellers
[0m12:33:24.725293 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_products__products"
[0m12:33:24.737388 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_sellers__sellers"
[0m12:33:24.740377 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m12:33:24.742008 [debug] [Thread-4 (]: On model.olist_project.stg_products__products: BEGIN
[0m12:33:24.742999 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m12:33:24.744993 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:33:24.745990 [debug] [Thread-1 (]: On model.olist_project.stg_sellers__sellers: BEGIN
[0m12:33:24.763948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:24.764940 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m12:33:24.767933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:33:24.768929 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m12:33:24.770925 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m12:33:24.772919 [debug] [Thread-4 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_products__products__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."main"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m12:33:24.774914 [debug] [Thread-1 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp"
  
    as (
      

with source as (
  select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
  from "olist"."main"."raw_sellers"
)

select * from source
    );
  
  
[0m12:33:24.865217 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_sellers__sellers (execute): 12:33:24.726290 => 12:33:24.864220
[0m12:33:24.866215 [debug] [Thread-1 (]: On model.olist_project.stg_sellers__sellers: ROLLBACK
[0m12:33:24.875189 [debug] [Thread-1 (]: Failed to rollback 'model.olist_project.stg_sellers__sellers'
[0m12:33:24.877184 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_products__products (execute): 12:33:24.716318 => 12:33:24.877184
[0m12:33:24.879179 [debug] [Thread-1 (]: On model.olist_project.stg_sellers__sellers: Close
[0m12:33:24.881174 [debug] [Thread-4 (]: On model.olist_project.stg_products__products: ROLLBACK
[0m12:33:24.892144 [debug] [Thread-1 (]: Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "information_schema.tables"?
  LINE 19:   from "olist"."main"."raw_sellers"
                  ^
[0m12:33:24.894141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd74dc34e-4298-471c-9148-345848a45093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C403465350>]}
[0m12:33:24.899125 [debug] [Thread-4 (]: Failed to rollback 'model.olist_project.stg_products__products'
[0m12:33:24.896133 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model analytics_staging.stg_sellers__sellers ... [[31mERROR[0m in 0.22s]
[0m12:33:24.902117 [debug] [Thread-4 (]: On model.olist_project.stg_products__products: Close
[0m12:33:24.904111 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_sellers__sellers
[0m12:33:24.917076 [debug] [Thread-4 (]: Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m12:33:24.919072 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd74dc34e-4298-471c-9148-345848a45093', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C403182A50>]}
[0m12:33:24.921068 [error] [Thread-4 (]: 5 of 6 ERROR creating sql table model analytics_staging.stg_products__products . [[31mERROR[0m in 0.24s]
[0m12:33:24.924059 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_products__products
[0m12:33:24.928048 [debug] [MainThread]: Using duckdb connection "master"
[0m12:33:24.929046 [debug] [MainThread]: On master: BEGIN
[0m12:33:24.930042 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:33:24.949988 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:33:24.951984 [debug] [MainThread]: On master: COMMIT
[0m12:33:24.953979 [debug] [MainThread]: Using duckdb connection "master"
[0m12:33:24.954977 [debug] [MainThread]: On master: COMMIT
[0m12:33:24.956972 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:33:24.958966 [debug] [MainThread]: On master: Close
[0m12:33:24.962955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:24.964949 [debug] [MainThread]: Connection 'create_olist_analytics_staging' was properly closed.
[0m12:33:24.965946 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m12:33:24.967055 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m12:33:24.969055 [debug] [MainThread]: Connection 'model.olist_project.stg_sellers__sellers' was properly closed.
[0m12:33:24.971047 [debug] [MainThread]: Connection 'model.olist_project.stg_order_items__order_items' was properly closed.
[0m12:33:24.972044 [debug] [MainThread]: Connection 'model.olist_project.stg_orders__orders' was properly closed.
[0m12:33:24.975035 [debug] [MainThread]: Connection 'model.olist_project.stg_products__products' was properly closed.
[0m12:33:24.984010 [info ] [MainThread]: 
[0m12:33:24.986007 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m12:33:24.992377 [debug] [MainThread]: Command end result
[0m12:33:25.017435 [info ] [MainThread]: 
[0m12:33:25.019430 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m12:33:25.021423 [info ] [MainThread]: 
[0m12:33:25.025415 [error] [MainThread]:   Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "temp.pg_catalog.pg_depend"?
  LINE 20:   from "olist"."main"."raw_order_payments"
                  ^
[0m12:33:25.027407 [info ] [MainThread]: 
[0m12:33:25.029402 [error] [MainThread]:   Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "information_schema.columns"?
  LINE 20:   from "olist"."main"."raw_customers"
                  ^
[0m12:33:25.030399 [info ] [MainThread]: 
[0m12:33:25.032394 [error] [MainThread]:   Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m12:33:25.035386 [info ] [MainThread]: 
[0m12:33:25.036383 [error] [MainThread]:   Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "information_schema.tables"?
  LINE 23:   from "olist"."main"."raw_orders"
                  ^
[0m12:33:25.038389 [info ] [MainThread]: 
[0m12:33:25.041666 [error] [MainThread]:   Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "information_schema.tables"?
  LINE 19:   from "olist"."main"."raw_sellers"
                  ^
[0m12:33:25.044175 [info ] [MainThread]: 
[0m12:33:25.045170 [error] [MainThread]:   Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m12:33:25.047165 [info ] [MainThread]: 
[0m12:33:25.048163 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m12:33:25.051155 [debug] [MainThread]: Command `dbt run` failed at 12:33:25.051155 after 4.52 seconds
[0m12:33:25.053150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C40103AB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C47ADB9AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C47ADB9990>]}
[0m12:33:25.054147 [debug] [MainThread]: Flushing usage events
[0m12:35:27.460601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5D9017C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5D841AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5D841AF50>]}


============================== 12:35:27.466735 | 21d54f52-aec6-4f7c-bb84-448d699e9d52 ==============================
[0m12:35:27.466735 [info ] [MainThread]: Running with dbt=1.7.9
[0m12:35:27.468601 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m12:35:27.474618 [info ] [MainThread]: target not specified in profile 'olist_project', using 'default'
[0m12:35:27.476580 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'olist_project' does not have a target named 'default'. The valid target names for this profile are:
   - dev
[0m12:35:27.479574 [debug] [MainThread]: Command `dbt run` failed at 12:35:27.478574 after 0.15 seconds
[0m12:35:27.480569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5D8ADD9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5D8462B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5D5F0E290>]}
[0m12:35:27.482566 [debug] [MainThread]: Flushing usage events
[0m12:39:18.282339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB52AA750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB52F5710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB52F7AD0>]}


============================== 12:39:18.288435 | 1ad26239-9edd-4745-b3c2-1aebef3d4bb2 ==============================
[0m12:39:18.288435 [info ] [MainThread]: Running with dbt=1.7.9
[0m12:39:18.290395 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m12:39:18.496820 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:39:18.498641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1ad26239-9edd-4745-b3c2-1aebef3d4bb2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB50DFA10>]}
[0m12:39:18.662363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ad26239-9edd-4745-b3c2-1aebef3d4bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB6436690>]}
[0m12:39:18.799990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ad26239-9edd-4745-b3c2-1aebef3d4bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB649BF90>]}
[0m12:39:18.801948 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m12:39:18.814831 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m12:39:18.899447 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:39:18.900444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1ad26239-9edd-4745-b3c2-1aebef3d4bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB4D9DB10>]}
[0m12:39:21.571224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m12:39:21.581199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ad26239-9edd-4745-b3c2-1aebef3d4bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB69C07D0>]}
[0m12:39:21.617269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ad26239-9edd-4745-b3c2-1aebef3d4bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB67BAA90>]}
[0m12:39:21.619332 [info ] [MainThread]: Found 6 models, 9 seeds, 4 tests, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m12:39:21.621327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ad26239-9edd-4745-b3c2-1aebef3d4bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB6566310>]}
[0m12:39:21.625333 [info ] [MainThread]: 
[0m12:39:21.628313 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:39:21.631300 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m12:39:21.670947 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m12:39:21.675934 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"olist"'
    
  
  
[0m12:39:21.676932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:21.704179 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:21.707166 [debug] [ThreadPool]: On list_olist: Close
[0m12:39:21.746063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_analytics_staging)
[0m12:39:21.749055 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "analytics_staging"
"
[0m12:39:21.769999 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:39:21.771994 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
        select type from duckdb_databases()
        where database_name='olist'
        and type='sqlite'
    
  
[0m12:39:21.774987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:21.800395 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:21.804384 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:39:21.806380 [debug] [ThreadPool]: On create_olist_analytics_staging: BEGIN
[0m12:39:21.808374 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:21.809370 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:39:21.810368 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
    
        create schema if not exists "olist"."analytics_staging"
    
[0m12:39:21.813362 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:21.820548 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m12:39:21.855454 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:39:21.856451 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m12:39:21.858446 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:21.859444 [debug] [ThreadPool]: On create_olist_analytics_staging: Close
[0m12:39:21.899304 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m12:39:21.915262 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m12:39:21.916257 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m12:39:21.919251 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m12:39:21.921244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:21.927228 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m12:39:21.942186 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:21.943185 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m12:39:21.944182 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m12:39:21.945180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:21.946176 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m12:39:21.948171 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:21.950167 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m12:39:21.951164 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m12:39:22.028440 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:22.032430 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m12:39:22.033428 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:22.035423 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m12:39:22.037526 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m12:39:22.037526 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m12:39:22.039522 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m12:39:22.041706 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m12:39:22.046693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ad26239-9edd-4745-b3c2-1aebef3d4bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB68910D0>]}
[0m12:39:22.047692 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:22.048689 [debug] [MainThread]: On master: BEGIN
[0m12:39:22.049685 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:22.062170 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:22.063168 [debug] [MainThread]: On master: COMMIT
[0m12:39:22.064166 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:22.065163 [debug] [MainThread]: On master: COMMIT
[0m12:39:22.066160 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:22.067158 [debug] [MainThread]: On master: Close
[0m12:39:22.070150 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:22.072145 [info ] [MainThread]: 
[0m12:39:22.077131 [debug] [Thread-1 (]: Began running node model.olist_project.stg_customers__customers
[0m12:39:22.078128 [debug] [Thread-2 (]: Began running node model.olist_project.stg_order_items__order_items
[0m12:39:22.079125 [debug] [Thread-3 (]: Began running node model.olist_project.stg_orders__orders
[0m12:39:22.079125 [debug] [Thread-4 (]: Began running node model.olist_project.stg_payments__payments
[0m12:39:22.080122 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_customers__customers ........ [RUN]
[0m12:39:22.082119 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_order_items__order_items .... [RUN]
[0m12:39:22.083116 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_orders__orders .............. [RUN]
[0m12:39:22.087106 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_project.stg_customers__customers'
[0m12:39:22.085110 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_staging.stg_payments__payments .......... [RUN]
[0m12:39:22.090098 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_project.stg_order_items__order_items'
[0m12:39:22.092092 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_project.stg_orders__orders'
[0m12:39:22.094087 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_customers__customers
[0m12:39:22.095082 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_project.stg_payments__payments'
[0m12:39:22.100070 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_order_items__order_items
[0m12:39:22.101068 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_orders__orders
[0m12:39:22.125003 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_customers__customers"
[0m12:39:22.126001 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_payments__payments
[0m12:39:22.132981 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_order_items__order_items"
[0m12:39:22.139964 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_orders__orders"
[0m12:39:22.147555 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_payments__payments"
[0m12:39:22.149550 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (compile): 12:39:22.102065 => 12:39:22.148553
[0m12:39:22.151546 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (compile): 12:39:22.126998 => 12:39:22.151546
[0m12:39:22.154537 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_customers__customers
[0m12:39:22.155534 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (compile): 12:39:22.133980 => 12:39:22.155534
[0m12:39:22.157529 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (compile): 12:39:22.141578 => 12:39:22.156533
[0m12:39:22.158526 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_order_items__order_items
[0m12:39:22.215639 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_customers__customers"
[0m12:39:22.216887 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_orders__orders
[0m12:39:22.217884 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_payments__payments
[0m12:39:22.224865 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_order_items__order_items"
[0m12:39:22.231410 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_orders__orders"
[0m12:39:22.231410 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m12:39:22.241924 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_payments__payments"
[0m12:39:22.249651 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m12:39:22.250649 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: BEGIN
[0m12:39:22.252644 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m12:39:22.253641 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: BEGIN
[0m12:39:22.255636 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m12:39:22.256633 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:39:22.257629 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: BEGIN
[0m12:39:22.258627 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:39:22.259625 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: BEGIN
[0m12:39:22.272674 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:39:22.273672 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:39:22.274670 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m12:39:22.275668 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:39:22.276665 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m12:39:22.277660 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m12:39:22.278659 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m12:39:22.280655 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m12:39:22.281650 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_customers__customers__dbt_tmp"
  
    as (
      

with source as (
  select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
  from "olist"."olist"."raw_customers"
)

select
  customer_id,
  customer_unique_id,
  customer_zip_code_prefix,
  customer_city,
  customer_state
from source
    );
  
  
[0m12:39:22.282649 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m12:39:22.283649 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."olist"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."olist"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m12:39:22.284645 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m12:39:22.286638 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_orders__orders__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
  from "olist"."olist"."raw_orders"
)

, cleaned as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_at,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_at,
    order_delivered_customer_date::timestamp as order_delivered_customer_at,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_at,
    case 
      when order_delivered_customer_date is not null 
      then (order_delivered_customer_date::timestamp - order_purchase_timestamp::timestamp).days
      else null 
    end as days_to_delivery,
    case
      when order_delivered_customer_date > order_estimated_delivery_date then true
      else false
    end as is_late_delivery
  from source
)

select * from cleaned
    );
  
  
[0m12:39:22.288754 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_payments__payments__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
  from "olist"."olist"."raw_order_payments"
)

select * from source
    );
  
  
[0m12:39:22.362689 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (execute): 12:39:22.231410 => 12:39:22.361690
[0m12:39:22.363686 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: ROLLBACK
[0m12:39:22.366678 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (execute): 12:39:22.218882 => 12:39:22.365683
[0m12:39:22.370404 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (execute): 12:39:22.226861 => 12:39:22.369403
[0m12:39:22.372397 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: ROLLBACK
[0m12:39:22.375387 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (execute): 12:39:22.158526 => 12:39:22.374391
[0m12:39:22.376384 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: ROLLBACK
[0m12:39:22.379376 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: ROLLBACK
[0m12:39:22.394337 [debug] [Thread-4 (]: Failed to rollback 'model.olist_project.stg_payments__payments'
[0m12:39:22.397329 [debug] [Thread-2 (]: Failed to rollback 'model.olist_project.stg_order_items__order_items'
[0m12:39:22.399323 [debug] [Thread-1 (]: Failed to rollback 'model.olist_project.stg_customers__customers'
[0m12:39:22.400321 [debug] [Thread-3 (]: Failed to rollback 'model.olist_project.stg_orders__orders'
[0m12:39:22.401318 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: Close
[0m12:39:22.403315 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: Close
[0m12:39:22.404312 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: Close
[0m12:39:22.406306 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: Close
[0m12:39:22.423261 [debug] [Thread-4 (]: Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "temp.pg_catalog.pg_depend"?
  LINE 20:   from "olist"."olist"."raw_order_payments"
                  ^
[0m12:39:22.426251 [debug] [Thread-2 (]: Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."olist"."raw_products"
                  ^
[0m12:39:22.427249 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ad26239-9edd-4745-b3c2-1aebef3d4bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB6AC6450>]}
[0m12:39:22.430240 [debug] [Thread-1 (]: Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "system.information_schema.columns"?
  LINE 20:   from "olist"."olist"."raw_customers"
                  ^
[0m12:39:22.431238 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ad26239-9edd-4745-b3c2-1aebef3d4bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB6ADC890>]}
[0m12:39:22.434230 [debug] [Thread-3 (]: Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 23:   from "olist"."olist"."raw_orders"
                  ^
[0m12:39:22.436226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ad26239-9edd-4745-b3c2-1aebef3d4bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB52B1D10>]}
[0m12:39:22.434230 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model analytics_staging.stg_payments__payments . [[31mERROR[0m in 0.33s]
[0m12:39:22.439323 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ad26239-9edd-4745-b3c2-1aebef3d4bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB6B37B10>]}
[0m12:39:22.437327 [error] [Thread-2 (]: 2 of 6 ERROR creating sql table model analytics_staging.stg_order_items__order_items  [[31mERROR[0m in 0.34s]
[0m12:39:22.442314 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_payments__payments
[0m12:39:22.440320 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model analytics_staging.stg_customers__customers  [[31mERROR[0m in 0.35s]
[0m12:39:22.446305 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_order_items__order_items
[0m12:39:22.444312 [error] [Thread-3 (]: 3 of 6 ERROR creating sql table model analytics_staging.stg_orders__orders ..... [[31mERROR[0m in 0.35s]
[0m12:39:22.448300 [debug] [Thread-4 (]: Began running node model.olist_project.stg_products__products
[0m12:39:22.450295 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_customers__customers
[0m12:39:22.452289 [debug] [Thread-2 (]: Began running node model.olist_project.stg_sellers__sellers
[0m12:39:22.455793 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_orders__orders
[0m12:39:22.458784 [info ] [Thread-4 (]: 5 of 6 START sql table model analytics_staging.stg_products__products .......... [RUN]
[0m12:39:22.460780 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics_staging.stg_sellers__sellers ............ [RUN]
[0m12:39:22.463772 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_payments__payments, now model.olist_project.stg_products__products)
[0m12:39:22.465765 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_order_items__order_items, now model.olist_project.stg_sellers__sellers)
[0m12:39:22.467760 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_products__products
[0m12:39:22.468756 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_sellers__sellers
[0m12:39:22.476739 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_products__products"
[0m12:39:22.484715 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_sellers__sellers"
[0m12:39:22.486710 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_products__products (compile): 12:39:22.468756 => 12:39:22.485711
[0m12:39:22.488834 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_products__products
[0m12:39:22.490829 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_sellers__sellers (compile): 12:39:22.476739 => 12:39:22.490829
[0m12:39:22.499230 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_products__products"
[0m12:39:22.500228 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_sellers__sellers
[0m12:39:22.509203 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_sellers__sellers"
[0m12:39:22.510202 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m12:39:22.512195 [debug] [Thread-4 (]: On model.olist_project.stg_products__products: BEGIN
[0m12:39:22.513192 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:39:22.514190 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m12:39:22.528153 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m12:39:22.529150 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: BEGIN
[0m12:39:22.530148 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m12:39:22.531144 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:39:22.532142 [debug] [Thread-4 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_products__products__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."olist"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."olist"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m12:39:22.533139 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m12:39:22.535137 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m12:39:22.537130 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp"
  
    as (
      

with source as (
  select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
  from "olist"."olist"."raw_sellers"
)

select * from source
    );
  
  
[0m12:39:22.584222 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_sellers__sellers (execute): 12:39:22.501225 => 12:39:22.583223
[0m12:39:22.585230 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_products__products (execute): 12:39:22.491896 => 12:39:22.585230
[0m12:39:22.586217 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: ROLLBACK
[0m12:39:22.587214 [debug] [Thread-4 (]: On model.olist_project.stg_products__products: ROLLBACK
[0m12:39:22.594194 [debug] [Thread-2 (]: Failed to rollback 'model.olist_project.stg_sellers__sellers'
[0m12:39:22.595191 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: Close
[0m12:39:22.598183 [debug] [Thread-4 (]: Failed to rollback 'model.olist_project.stg_products__products'
[0m12:39:22.601175 [debug] [Thread-4 (]: On model.olist_project.stg_products__products: Close
[0m12:39:22.609154 [debug] [Thread-2 (]: Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 19:   from "olist"."olist"."raw_sellers"
                  ^
[0m12:39:22.611149 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ad26239-9edd-4745-b3c2-1aebef3d4bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB6ABB890>]}
[0m12:39:22.614248 [debug] [Thread-4 (]: Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."olist"."raw_products"
                  ^
[0m12:39:22.612252 [error] [Thread-2 (]: 6 of 6 ERROR creating sql table model analytics_staging.stg_sellers__sellers ... [[31mERROR[0m in 0.15s]
[0m12:39:22.616243 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ad26239-9edd-4745-b3c2-1aebef3d4bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB6844650>]}
[0m12:39:22.617348 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_sellers__sellers
[0m12:39:22.618347 [error] [Thread-4 (]: 5 of 6 ERROR creating sql table model analytics_staging.stg_products__products . [[31mERROR[0m in 0.15s]
[0m12:39:22.621341 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_products__products
[0m12:39:22.625328 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:22.627323 [debug] [MainThread]: On master: BEGIN
[0m12:39:22.628321 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:22.645382 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:22.646380 [debug] [MainThread]: On master: COMMIT
[0m12:39:22.649374 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:22.650370 [debug] [MainThread]: On master: COMMIT
[0m12:39:22.651368 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:22.653363 [debug] [MainThread]: On master: Close
[0m12:39:22.656358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:22.657351 [debug] [MainThread]: Connection 'create_olist_analytics_staging' was properly closed.
[0m12:39:22.659348 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m12:39:22.661340 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m12:39:22.662509 [debug] [MainThread]: Connection 'model.olist_project.stg_customers__customers' was properly closed.
[0m12:39:22.663509 [debug] [MainThread]: Connection 'model.olist_project.stg_sellers__sellers' was properly closed.
[0m12:39:22.663509 [debug] [MainThread]: Connection 'model.olist_project.stg_orders__orders' was properly closed.
[0m12:39:22.664507 [debug] [MainThread]: Connection 'model.olist_project.stg_products__products' was properly closed.
[0m12:39:22.666604 [info ] [MainThread]: 
[0m12:39:22.667602 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m12:39:22.671590 [debug] [MainThread]: Command end result
[0m12:39:22.690542 [info ] [MainThread]: 
[0m12:39:22.694532 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m12:39:22.695528 [info ] [MainThread]: 
[0m12:39:22.697522 [error] [MainThread]:   Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "temp.pg_catalog.pg_depend"?
  LINE 20:   from "olist"."olist"."raw_order_payments"
                  ^
[0m12:39:22.698520 [info ] [MainThread]: 
[0m12:39:22.700523 [error] [MainThread]:   Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."olist"."raw_products"
                  ^
[0m12:39:22.702509 [info ] [MainThread]: 
[0m12:39:22.704504 [error] [MainThread]:   Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "system.information_schema.columns"?
  LINE 20:   from "olist"."olist"."raw_customers"
                  ^
[0m12:39:22.707497 [info ] [MainThread]: 
[0m12:39:22.708493 [error] [MainThread]:   Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 23:   from "olist"."olist"."raw_orders"
                  ^
[0m12:39:22.711488 [info ] [MainThread]: 
[0m12:39:22.713481 [error] [MainThread]:   Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 19:   from "olist"."olist"."raw_sellers"
                  ^
[0m12:39:22.715474 [info ] [MainThread]: 
[0m12:39:22.720221 [error] [MainThread]:   Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."olist"."raw_products"
                  ^
[0m12:39:22.724214 [info ] [MainThread]: 
[0m12:39:22.725208 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m12:39:22.728201 [debug] [MainThread]: Command `dbt run` failed at 12:39:22.728201 after 4.55 seconds
[0m12:39:22.731193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEAE489AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEAE489D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB529BB50>]}
[0m12:39:22.733186 [debug] [MainThread]: Flushing usage events
[0m12:40:29.154151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E94529490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E93EEB150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E914FE610>]}


============================== 12:40:29.160707 | 28b00e06-e40c-4970-aea3-48dd87bff795 ==============================
[0m12:40:29.160707 [info ] [MainThread]: Running with dbt=1.7.9
[0m12:40:29.162703 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m12:40:29.373040 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:40:29.375035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '28b00e06-e40c-4970-aea3-48dd87bff795', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E945D80D0>]}
[0m12:40:29.542972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28b00e06-e40c-4970-aea3-48dd87bff795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E94529610>]}
[0m12:40:29.676602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28b00e06-e40c-4970-aea3-48dd87bff795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E946AA810>]}
[0m12:40:29.678626 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m12:40:29.695732 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m12:40:29.841582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:29.844576 [debug] [MainThread]: Partial parsing: updated file: olist_project://models\staging\sources.yml
[0m12:40:30.230791 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m12:40:30.241786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28b00e06-e40c-4970-aea3-48dd87bff795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E958CB310>]}
[0m12:40:30.272371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28b00e06-e40c-4970-aea3-48dd87bff795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E95904410>]}
[0m12:40:30.273368 [info ] [MainThread]: Found 9 seeds, 6 models, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m12:40:30.275362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28b00e06-e40c-4970-aea3-48dd87bff795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E956DAAD0>]}
[0m12:40:30.279387 [info ] [MainThread]: 
[0m12:40:30.282344 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:40:30.284375 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m12:40:30.305319 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m12:40:30.306316 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"olist"'
    
  
  
[0m12:40:30.307276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:30.324414 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:40:30.327407 [debug] [ThreadPool]: On list_olist: Close
[0m12:40:30.332393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_analytics_staging)
[0m12:40:30.335385 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "analytics_staging"
"
[0m12:40:30.349492 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:40:30.350454 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
        select type from duckdb_databases()
        where database_name='olist'
        and type='sqlite'
    
  
[0m12:40:30.351453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:40:30.365414 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:40:30.367410 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:40:30.368408 [debug] [ThreadPool]: On create_olist_analytics_staging: BEGIN
[0m12:40:30.369404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:40:30.370402 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:40:30.371399 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
    
        create schema if not exists "olist"."analytics_staging"
    
[0m12:40:30.373392 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:40:30.375389 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m12:40:30.376654 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:40:30.377689 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m12:40:30.378649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:40:30.379684 [debug] [ThreadPool]: On create_olist_analytics_staging: Close
[0m12:40:30.386629 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m12:40:30.387631 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m12:40:30.398595 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m12:40:30.407573 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m12:40:30.408570 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m12:40:30.410564 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m12:40:30.411563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:30.412558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:30.424527 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:40:30.425526 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:40:30.426522 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m12:40:30.427520 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m12:40:30.428516 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m12:40:30.429515 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m12:40:30.516761 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:40:30.521807 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:40:30.526815 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m12:40:30.531874 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m12:40:30.528844 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m12:40:30.534241 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m12:40:30.536236 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m12:40:30.539353 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m12:40:30.544547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28b00e06-e40c-4970-aea3-48dd87bff795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E957D3BD0>]}
[0m12:40:30.545544 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:30.546543 [debug] [MainThread]: On master: BEGIN
[0m12:40:30.547538 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:30.559506 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:40:30.560505 [debug] [MainThread]: On master: COMMIT
[0m12:40:30.561503 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:30.562592 [debug] [MainThread]: On master: COMMIT
[0m12:40:30.563593 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:40:30.565586 [debug] [MainThread]: On master: Close
[0m12:40:30.568673 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:30.570668 [info ] [MainThread]: 
[0m12:40:30.575654 [debug] [Thread-1 (]: Began running node model.olist_project.stg_customers__customers
[0m12:40:30.576651 [debug] [Thread-2 (]: Began running node model.olist_project.stg_order_items__order_items
[0m12:40:30.577649 [debug] [Thread-3 (]: Began running node model.olist_project.stg_orders__orders
[0m12:40:30.577649 [debug] [Thread-4 (]: Began running node model.olist_project.stg_payments__payments
[0m12:40:30.578646 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_customers__customers ........ [RUN]
[0m12:40:30.579644 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_order_items__order_items .... [RUN]
[0m12:40:30.581637 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_orders__orders .............. [RUN]
[0m12:40:30.586626 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_project.stg_customers__customers'
[0m12:40:30.583639 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_staging.stg_payments__payments .......... [RUN]
[0m12:40:30.589616 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_project.stg_order_items__order_items'
[0m12:40:30.590614 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_project.stg_orders__orders'
[0m12:40:30.594610 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_customers__customers
[0m12:40:30.596599 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_project.stg_payments__payments'
[0m12:40:30.598593 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_order_items__order_items
[0m12:40:30.600587 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_orders__orders
[0m12:40:30.620535 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_customers__customers"
[0m12:40:30.621530 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_payments__payments
[0m12:40:30.628518 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_order_items__order_items"
[0m12:40:30.686724 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_orders__orders"
[0m12:40:30.692708 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_payments__payments"
[0m12:40:30.694703 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (compile): 12:40:30.602584 => 12:40:30.693705
[0m12:40:30.696696 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (compile): 12:40:30.622528 => 12:40:30.696696
[0m12:40:30.698692 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_customers__customers
[0m12:40:30.699688 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (compile): 12:40:30.629547 => 12:40:30.698692
[0m12:40:30.701684 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_order_items__order_items
[0m12:40:30.702681 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (compile): 12:40:30.687723 => 12:40:30.701684
[0m12:40:30.761524 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_customers__customers"
[0m12:40:30.762522 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_orders__orders
[0m12:40:30.769501 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_order_items__order_items"
[0m12:40:30.770498 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_payments__payments
[0m12:40:30.779476 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_orders__orders"
[0m12:40:30.780472 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m12:40:30.788450 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_payments__payments"
[0m12:40:30.789448 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m12:40:30.791444 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: BEGIN
[0m12:40:30.792451 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m12:40:30.794436 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: BEGIN
[0m12:40:30.796430 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m12:40:30.797429 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:30.798424 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: BEGIN
[0m12:40:30.799423 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:40:30.800420 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: BEGIN
[0m12:40:30.812489 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:40:30.813492 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:40:30.815483 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m12:40:30.816586 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:40:30.817586 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m12:40:30.818584 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m12:40:30.819581 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m12:40:30.821574 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m12:40:30.822571 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_customers__customers__dbt_tmp"
  
    as (
      

with source as (
  select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
  from "olist"."olist"."raw_customers"
)

select
  customer_id,
  customer_unique_id,
  customer_zip_code_prefix,
  customer_city,
  customer_state
from source
    );
  
  
[0m12:40:30.823569 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m12:40:30.824568 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."olist"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."olist"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m12:40:30.825600 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m12:40:30.827558 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_orders__orders__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
  from "olist"."olist"."raw_orders"
)

, cleaned as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_at,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_at,
    order_delivered_customer_date::timestamp as order_delivered_customer_at,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_at,
    case 
      when order_delivered_customer_date is not null 
      then (order_delivered_customer_date::timestamp - order_purchase_timestamp::timestamp).days
      else null 
    end as days_to_delivery,
    case
      when order_delivered_customer_date > order_estimated_delivery_date then true
      else false
    end as is_late_delivery
  from source
)

select * from cleaned
    );
  
  
[0m12:40:30.830552 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_payments__payments__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
  from "olist"."olist"."raw_order_payments"
)

select * from source
    );
  
  
[0m12:40:30.901632 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (execute): 12:40:30.772495 => 12:40:30.900634
[0m12:40:30.904624 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: ROLLBACK
[0m12:40:30.916596 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (execute): 12:40:30.703678 => 12:40:30.915596
[0m12:40:30.917589 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: ROLLBACK
[0m12:40:30.919585 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (execute): 12:40:30.782468 => 12:40:30.918588
[0m12:40:30.920581 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (execute): 12:40:30.762522 => 12:40:30.920581
[0m12:40:30.923573 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: ROLLBACK
[0m12:40:30.925567 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: ROLLBACK
[0m12:40:30.930556 [debug] [Thread-3 (]: Failed to rollback 'model.olist_project.stg_orders__orders'
[0m12:40:30.933547 [debug] [Thread-1 (]: Failed to rollback 'model.olist_project.stg_customers__customers'
[0m12:40:30.936538 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: Close
[0m12:40:30.937674 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: Close
[0m12:40:30.940666 [debug] [Thread-4 (]: Failed to rollback 'model.olist_project.stg_payments__payments'
[0m12:40:30.946180 [debug] [Thread-2 (]: Failed to rollback 'model.olist_project.stg_order_items__order_items'
[0m12:40:30.949171 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: Close
[0m12:40:30.952163 [debug] [Thread-3 (]: Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "information_schema.tables"?
  LINE 23:   from "olist"."olist"."raw_orders"
                  ^
[0m12:40:30.953161 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: Close
[0m12:40:30.959144 [debug] [Thread-1 (]: Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "information_schema.columns"?
  LINE 20:   from "olist"."olist"."raw_customers"
                  ^
[0m12:40:30.960142 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28b00e06-e40c-4970-aea3-48dd87bff795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E95B90150>]}
[0m12:40:30.970116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28b00e06-e40c-4970-aea3-48dd87bff795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E95868990>]}
[0m12:40:30.974106 [debug] [Thread-4 (]: Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "pg_catalog.pg_depend"?
  LINE 20:   from "olist"."olist"."raw_order_payments"
                  ^
[0m12:40:30.980089 [debug] [Thread-2 (]: Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "pg_catalog.pg_proc"?
  LINE 24:   from "olist"."olist"."raw_products"
                  ^
[0m12:40:30.975102 [error] [Thread-3 (]: 3 of 6 ERROR creating sql table model analytics_staging.stg_orders__orders ..... [[31mERROR[0m in 0.37s]
[0m12:40:30.981088 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28b00e06-e40c-4970-aea3-48dd87bff795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E95ADE810>]}
[0m12:40:30.977099 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model analytics_staging.stg_customers__customers  [[31mERROR[0m in 0.38s]
[0m12:40:30.982085 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28b00e06-e40c-4970-aea3-48dd87bff795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E9465A810>]}
[0m12:40:30.984080 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_orders__orders
[0m12:40:30.987072 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_customers__customers
[0m12:40:30.985076 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model analytics_staging.stg_payments__payments . [[31mERROR[0m in 0.39s]
[0m12:40:30.990063 [debug] [Thread-3 (]: Began running node model.olist_project.stg_products__products
[0m12:40:30.989066 [error] [Thread-2 (]: 2 of 6 ERROR creating sql table model analytics_staging.stg_order_items__order_items  [[31mERROR[0m in 0.39s]
[0m12:40:30.993055 [debug] [Thread-1 (]: Began running node model.olist_project.stg_sellers__sellers
[0m12:40:30.995049 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_payments__payments
[0m12:40:30.998042 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_order_items__order_items
[0m12:40:30.996047 [info ] [Thread-3 (]: 5 of 6 START sql table model analytics_staging.stg_products__products .......... [RUN]
[0m12:40:31.005023 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_orders__orders, now model.olist_project.stg_products__products)
[0m12:40:31.002032 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics_staging.stg_sellers__sellers ............ [RUN]
[0m12:40:31.007016 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_products__products
[0m12:40:31.009012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_customers__customers, now model.olist_project.stg_sellers__sellers)
[0m12:40:31.017088 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_products__products"
[0m12:40:31.018086 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_sellers__sellers
[0m12:40:31.026065 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_sellers__sellers"
[0m12:40:31.031053 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_sellers__sellers (compile): 12:40:31.019086 => 12:40:31.028060
[0m12:40:31.032564 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_sellers__sellers
[0m12:40:31.034558 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_products__products (compile): 12:40:31.010010 => 12:40:31.033560
[0m12:40:31.044058 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_sellers__sellers"
[0m12:40:31.047052 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_products__products
[0m12:40:31.058020 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_products__products"
[0m12:40:31.059019 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m12:40:31.061012 [debug] [Thread-1 (]: On model.olist_project.stg_sellers__sellers: BEGIN
[0m12:40:31.064005 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m12:40:31.065002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:31.066000 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: BEGIN
[0m12:40:31.079571 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:40:31.080568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:40:31.081565 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m12:40:31.083559 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m12:40:31.084557 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m12:40:31.085563 [debug] [Thread-1 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp"
  
    as (
      

with source as (
  select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
  from "olist"."olist"."raw_sellers"
)

select * from source
    );
  
  
[0m12:40:31.086551 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_products__products__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."olist"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."olist"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m12:40:31.145746 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_sellers__sellers (execute): 12:40:31.034558 => 12:40:31.144747
[0m12:40:31.146743 [debug] [Thread-1 (]: On model.olist_project.stg_sellers__sellers: ROLLBACK
[0m12:40:31.150732 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_products__products (execute): 12:40:31.048051 => 12:40:31.149734
[0m12:40:31.151737 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: ROLLBACK
[0m12:40:31.154720 [debug] [Thread-1 (]: Failed to rollback 'model.olist_project.stg_sellers__sellers'
[0m12:40:31.156715 [debug] [Thread-1 (]: On model.olist_project.stg_sellers__sellers: Close
[0m12:40:31.160704 [debug] [Thread-3 (]: Failed to rollback 'model.olist_project.stg_products__products'
[0m12:40:31.161701 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: Close
[0m12:40:31.169913 [debug] [Thread-1 (]: Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 19:   from "olist"."olist"."raw_sellers"
                  ^
[0m12:40:31.170911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28b00e06-e40c-4970-aea3-48dd87bff795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E9591A690>]}
[0m12:40:31.174901 [debug] [Thread-3 (]: Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."olist"."raw_products"
                  ^
[0m12:40:31.171909 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model analytics_staging.stg_sellers__sellers ... [[31mERROR[0m in 0.16s]
[0m12:40:31.175898 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28b00e06-e40c-4970-aea3-48dd87bff795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E95AA4FD0>]}
[0m12:40:31.177894 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_sellers__sellers
[0m12:40:31.178890 [error] [Thread-3 (]: 5 of 6 ERROR creating sql table model analytics_staging.stg_products__products . [[31mERROR[0m in 0.17s]
[0m12:40:31.181885 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_products__products
[0m12:40:31.184875 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:31.186870 [debug] [MainThread]: On master: BEGIN
[0m12:40:31.187868 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:31.208813 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:40:31.209808 [debug] [MainThread]: On master: COMMIT
[0m12:40:31.210805 [debug] [MainThread]: Using duckdb connection "master"
[0m12:40:31.211803 [debug] [MainThread]: On master: COMMIT
[0m12:40:31.213798 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:40:31.214796 [debug] [MainThread]: On master: Close
[0m12:40:31.219615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:31.220613 [debug] [MainThread]: Connection 'create_olist_analytics_staging' was properly closed.
[0m12:40:31.223603 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m12:40:31.224601 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m12:40:31.225598 [debug] [MainThread]: Connection 'model.olist_project.stg_sellers__sellers' was properly closed.
[0m12:40:31.226595 [debug] [MainThread]: Connection 'model.olist_project.stg_order_items__order_items' was properly closed.
[0m12:40:31.227592 [debug] [MainThread]: Connection 'model.olist_project.stg_products__products' was properly closed.
[0m12:40:31.227592 [debug] [MainThread]: Connection 'model.olist_project.stg_payments__payments' was properly closed.
[0m12:40:31.229588 [info ] [MainThread]: 
[0m12:40:31.231583 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m12:40:31.235570 [debug] [MainThread]: Command end result
[0m12:40:31.252565 [info ] [MainThread]: 
[0m12:40:31.254561 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m12:40:31.256556 [info ] [MainThread]: 
[0m12:40:31.257553 [error] [MainThread]:   Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "information_schema.tables"?
  LINE 23:   from "olist"."olist"."raw_orders"
                  ^
[0m12:40:31.259547 [info ] [MainThread]: 
[0m12:40:31.260545 [error] [MainThread]:   Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "information_schema.columns"?
  LINE 20:   from "olist"."olist"."raw_customers"
                  ^
[0m12:40:31.263952 [info ] [MainThread]: 
[0m12:40:31.265948 [error] [MainThread]:   Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "pg_catalog.pg_depend"?
  LINE 20:   from "olist"."olist"."raw_order_payments"
                  ^
[0m12:40:31.267954 [info ] [MainThread]: 
[0m12:40:31.269937 [error] [MainThread]:   Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "pg_catalog.pg_proc"?
  LINE 24:   from "olist"."olist"."raw_products"
                  ^
[0m12:40:31.271931 [info ] [MainThread]: 
[0m12:40:31.273927 [error] [MainThread]:   Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 19:   from "olist"."olist"."raw_sellers"
                  ^
[0m12:40:31.278913 [info ] [MainThread]: 
[0m12:40:31.281906 [error] [MainThread]:   Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."olist"."raw_products"
                  ^
[0m12:40:31.284899 [info ] [MainThread]: 
[0m12:40:31.286892 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m12:40:31.288886 [debug] [MainThread]: Command `dbt run` failed at 12:40:31.288886 after 2.24 seconds
[0m12:40:31.293748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E9397AB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E917D6690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E8D749DD0>]}
[0m12:40:31.295744 [debug] [MainThread]: Flushing usage events
[0m12:43:43.717174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D399056D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3987D8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3987DB590>]}


============================== 12:43:43.724751 | 9daa307e-a03a-4279-b529-f80e6b1d28d1 ==============================
[0m12:43:43.724751 [info ] [MainThread]: Running with dbt=1.7.9
[0m12:43:43.726370 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m12:43:43.939602 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:43:43.941560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9daa307e-a03a-4279-b529-f80e6b1d28d1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D399050950>]}
[0m12:43:44.111130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9daa307e-a03a-4279-b529-f80e6b1d28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39906B3D0>]}
[0m12:43:44.249635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9daa307e-a03a-4279-b529-f80e6b1d28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39906B3D0>]}
[0m12:43:44.251628 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m12:43:44.265671 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m12:43:44.411834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:43:44.413831 [debug] [MainThread]: Partial parsing: updated file: olist_project://models\staging\sources.yml
[0m12:43:44.785289 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m12:43:44.794645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9daa307e-a03a-4279-b529-f80e6b1d28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39A58B050>]}
[0m12:43:44.820726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9daa307e-a03a-4279-b529-f80e6b1d28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39A3F9290>]}
[0m12:43:44.822719 [info ] [MainThread]: Found 9 seeds, 6 models, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m12:43:44.823717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9daa307e-a03a-4279-b529-f80e6b1d28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39A45C290>]}
[0m12:43:44.829699 [info ] [MainThread]: 
[0m12:43:44.831698 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:43:44.833693 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m12:43:44.857773 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m12:43:44.859768 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"olist"'
    
  
  
[0m12:43:44.861766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:44.880617 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:44.883608 [debug] [ThreadPool]: On list_olist: Close
[0m12:43:44.889756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_analytics_staging)
[0m12:43:44.890746 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "analytics_staging"
"
[0m12:43:44.905736 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:43:44.906704 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
        select type from duckdb_databases()
        where database_name='olist'
        and type='sqlite'
    
  
[0m12:43:44.907703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:44.920706 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:44.923737 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:43:44.924734 [debug] [ThreadPool]: On create_olist_analytics_staging: BEGIN
[0m12:43:44.925698 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:44.927689 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:43:44.927689 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
    
        create schema if not exists "olist"."analytics_staging"
    
[0m12:43:44.928685 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:44.930720 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m12:43:44.931714 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:43:44.932676 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m12:43:44.933709 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:44.934670 [debug] [ThreadPool]: On create_olist_analytics_staging: Close
[0m12:43:44.942650 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m12:43:44.943646 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m12:43:44.955014 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m12:43:44.959002 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m12:43:44.959528 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m12:43:44.961538 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m12:43:44.962795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:44.963788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:44.988205 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:44.989202 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:44.990198 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m12:43:44.992256 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m12:43:44.994269 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m12:43:44.995249 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m12:43:45.078560 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:45.079558 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:43:45.082552 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m12:43:45.085542 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m12:43:45.087679 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m12:43:45.088678 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m12:43:45.089674 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m12:43:45.091862 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m12:43:45.096849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9daa307e-a03a-4279-b529-f80e6b1d28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39A2A5750>]}
[0m12:43:45.097846 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:45.098844 [debug] [MainThread]: On master: BEGIN
[0m12:43:45.099841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:45.112903 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:43:45.113903 [debug] [MainThread]: On master: COMMIT
[0m12:43:45.114900 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:45.115898 [debug] [MainThread]: On master: COMMIT
[0m12:43:45.117271 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:43:45.118269 [debug] [MainThread]: On master: Close
[0m12:43:45.121260 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:43:45.122258 [info ] [MainThread]: 
[0m12:43:45.127243 [debug] [Thread-1 (]: Began running node model.olist_project.stg_customers__customers
[0m12:43:45.128241 [debug] [Thread-2 (]: Began running node model.olist_project.stg_order_items__order_items
[0m12:43:45.129239 [debug] [Thread-3 (]: Began running node model.olist_project.stg_orders__orders
[0m12:43:45.130237 [debug] [Thread-4 (]: Began running node model.olist_project.stg_payments__payments
[0m12:43:45.130237 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_customers__customers ........ [RUN]
[0m12:43:45.132233 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_order_items__order_items .... [RUN]
[0m12:43:45.134227 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_orders__orders .............. [RUN]
[0m12:43:45.139475 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_project.stg_customers__customers'
[0m12:43:45.136221 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_staging.stg_payments__payments .......... [RUN]
[0m12:43:45.141470 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_project.stg_order_items__order_items'
[0m12:43:45.144461 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_project.stg_orders__orders'
[0m12:43:45.146456 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_customers__customers
[0m12:43:45.148451 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_project.stg_payments__payments'
[0m12:43:45.150446 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_order_items__order_items
[0m12:43:45.151442 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_orders__orders
[0m12:43:45.174383 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_customers__customers"
[0m12:43:45.175378 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_payments__payments
[0m12:43:45.184353 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_order_items__order_items"
[0m12:43:45.241864 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_orders__orders"
[0m12:43:45.248845 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_payments__payments"
[0m12:43:45.249814 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (compile): 12:43:45.152445 => 12:43:45.248845
[0m12:43:45.252804 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (compile): 12:43:45.176376 => 12:43:45.251806
[0m12:43:45.254799 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_customers__customers
[0m12:43:45.255796 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (compile): 12:43:45.184353 => 12:43:45.254799
[0m12:43:45.256793 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_order_items__order_items
[0m12:43:45.257788 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (compile): 12:43:45.243829 => 12:43:45.257788
[0m12:43:45.316807 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_customers__customers"
[0m12:43:45.317804 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_orders__orders
[0m12:43:45.327781 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_order_items__order_items"
[0m12:43:45.328775 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_payments__payments
[0m12:43:45.336791 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_orders__orders"
[0m12:43:45.337913 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m12:43:45.341535 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_payments__payments"
[0m12:43:45.341535 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m12:43:45.341535 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: BEGIN
[0m12:43:45.341535 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m12:43:45.352768 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: BEGIN
[0m12:43:45.353764 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:43:45.354763 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m12:43:45.355760 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: BEGIN
[0m12:43:45.356756 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:43:45.370953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:43:45.371952 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: BEGIN
[0m12:43:45.372985 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:43:45.374945 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m12:43:45.374945 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m12:43:45.376938 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:43:45.377936 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m12:43:45.378969 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m12:43:45.379933 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_customers__customers__dbt_tmp"
  
    as (
      

with source as (
  select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
  from "olist"."main"."raw_customers"
)

select
  customer_id,
  customer_unique_id,
  customer_zip_code_prefix,
  customer_city,
  customer_state
from source
    );
  
  
[0m12:43:45.381926 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m12:43:45.382921 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m12:43:45.384918 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."main"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m12:43:45.386912 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m12:43:45.390901 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_payments__payments__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
  from "olist"."main"."raw_order_payments"
)

select * from source
    );
  
  
[0m12:43:45.388905 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_orders__orders__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
  from "olist"."main"."raw_orders"
)

, cleaned as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_at,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_at,
    order_delivered_customer_date::timestamp as order_delivered_customer_at,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_at,
    case 
      when order_delivered_customer_date is not null 
      then (order_delivered_customer_date::timestamp - order_purchase_timestamp::timestamp).days
      else null 
    end as days_to_delivery,
    case
      when order_delivered_customer_date > order_estimated_delivery_date then true
      else false
    end as is_late_delivery
  from source
)

select * from cleaned
    );
  
  
[0m12:43:45.466973 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (execute): 12:43:45.329772 => 12:43:45.466973
[0m12:43:45.471499 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (execute): 12:43:45.258824 => 12:43:45.471499
[0m12:43:45.471499 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: ROLLBACK
[0m12:43:45.471499 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (execute): 12:43:45.338948 => 12:43:45.471499
[0m12:43:45.471499 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: ROLLBACK
[0m12:43:45.480127 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (execute): 12:43:45.317804 => 12:43:45.480127
[0m12:43:45.481124 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: ROLLBACK
[0m12:43:45.485115 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: ROLLBACK
[0m12:43:45.501106 [debug] [Thread-2 (]: Failed to rollback 'model.olist_project.stg_order_items__order_items'
[0m12:43:45.504063 [debug] [Thread-1 (]: Failed to rollback 'model.olist_project.stg_customers__customers'
[0m12:43:45.506057 [debug] [Thread-3 (]: Failed to rollback 'model.olist_project.stg_orders__orders'
[0m12:43:45.507055 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: Close
[0m12:43:45.510048 [debug] [Thread-4 (]: Failed to rollback 'model.olist_project.stg_payments__payments'
[0m12:43:45.511045 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: Close
[0m12:43:45.513162 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: Close
[0m12:43:45.516148 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: Close
[0m12:43:45.522389 [debug] [Thread-2 (]: Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m12:43:45.534394 [debug] [Thread-1 (]: Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "information_schema.columns"?
  LINE 20:   from "olist"."main"."raw_customers"
                  ^
[0m12:43:45.535360 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9daa307e-a03a-4279-b529-f80e6b1d28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39A408550>]}
[0m12:43:45.538488 [debug] [Thread-3 (]: Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 23:   from "olist"."main"."raw_orders"
                  ^
[0m12:43:45.539489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9daa307e-a03a-4279-b529-f80e6b1d28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39A2D5FD0>]}
[0m12:43:45.542545 [debug] [Thread-4 (]: Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "olist.pg_catalog.pg_depend"?
  LINE 20:   from "olist"."main"."raw_order_payments"
                  ^
[0m12:43:45.546534 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9daa307e-a03a-4279-b529-f80e6b1d28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39A45C190>]}
[0m12:43:45.543542 [error] [Thread-2 (]: 2 of 6 ERROR creating sql table model analytics_staging.stg_order_items__order_items  [[31mERROR[0m in 0.39s]
[0m12:43:45.548529 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9daa307e-a03a-4279-b529-f80e6b1d28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39A2E0F90>]}
[0m12:43:45.547532 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model analytics_staging.stg_customers__customers  [[31mERROR[0m in 0.40s]
[0m12:43:45.552540 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_order_items__order_items
[0m12:43:45.550523 [error] [Thread-3 (]: 3 of 6 ERROR creating sql table model analytics_staging.stg_orders__orders ..... [[31mERROR[0m in 0.40s]
[0m12:43:45.556508 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_customers__customers
[0m12:43:45.553517 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model analytics_staging.stg_payments__payments . [[31mERROR[0m in 0.40s]
[0m12:43:45.557505 [debug] [Thread-2 (]: Began running node model.olist_project.stg_products__products
[0m12:43:45.562493 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_orders__orders
[0m12:43:45.563491 [debug] [Thread-1 (]: Began running node model.olist_project.stg_sellers__sellers
[0m12:43:45.565485 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_payments__payments
[0m12:43:45.567480 [info ] [Thread-2 (]: 5 of 6 START sql table model analytics_staging.stg_products__products .......... [RUN]
[0m12:43:45.569474 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics_staging.stg_sellers__sellers ............ [RUN]
[0m12:43:45.574461 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_order_items__order_items, now model.olist_project.stg_products__products)
[0m12:43:45.577452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_customers__customers, now model.olist_project.stg_sellers__sellers)
[0m12:43:45.579447 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_products__products
[0m12:43:45.580445 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_sellers__sellers
[0m12:43:45.596141 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_products__products"
[0m12:43:45.603121 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_sellers__sellers"
[0m12:43:45.607112 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_products__products (compile): 12:43:45.582438 => 12:43:45.607112
[0m12:43:45.609106 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_products__products
[0m12:43:45.610109 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_sellers__sellers (compile): 12:43:45.597137 => 12:43:45.609106
[0m12:43:45.618240 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_products__products"
[0m12:43:45.619237 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_sellers__sellers
[0m12:43:45.630208 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_sellers__sellers"
[0m12:43:45.631207 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m12:43:45.633201 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: BEGIN
[0m12:43:45.635195 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:43:45.636192 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m12:43:45.648378 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m12:43:45.649376 [debug] [Thread-1 (]: On model.olist_project.stg_sellers__sellers: BEGIN
[0m12:43:45.650372 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m12:43:45.651370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:45.653365 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_products__products__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."main"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m12:43:45.654366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:43:45.656357 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m12:43:45.657354 [debug] [Thread-1 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp"
  
    as (
      

with source as (
  select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
  from "olist"."main"."raw_sellers"
)

select * from source
    );
  
  
[0m12:43:45.719157 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_sellers__sellers (execute): 12:43:45.620235 => 12:43:45.719157
[0m12:43:45.721151 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_products__products (execute): 12:43:45.611102 => 12:43:45.720154
[0m12:43:45.722148 [debug] [Thread-1 (]: On model.olist_project.stg_sellers__sellers: ROLLBACK
[0m12:43:45.723145 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: ROLLBACK
[0m12:43:45.729130 [debug] [Thread-1 (]: Failed to rollback 'model.olist_project.stg_sellers__sellers'
[0m12:43:45.732121 [debug] [Thread-2 (]: Failed to rollback 'model.olist_project.stg_products__products'
[0m12:43:45.733119 [debug] [Thread-1 (]: On model.olist_project.stg_sellers__sellers: Close
[0m12:43:45.734127 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: Close
[0m12:43:45.745487 [debug] [Thread-1 (]: Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "information_schema.tables"?
  LINE 19:   from "olist"."main"."raw_sellers"
                  ^
[0m12:43:45.747481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9daa307e-a03a-4279-b529-f80e6b1d28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3991A4C90>]}
[0m12:43:45.749512 [debug] [Thread-2 (]: Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m12:43:45.752468 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9daa307e-a03a-4279-b529-f80e6b1d28d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D39A413750>]}
[0m12:43:45.750509 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model analytics_staging.stg_sellers__sellers ... [[31mERROR[0m in 0.17s]
[0m12:43:45.755462 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_sellers__sellers
[0m12:43:45.753465 [error] [Thread-2 (]: 5 of 6 ERROR creating sql table model analytics_staging.stg_products__products . [[31mERROR[0m in 0.18s]
[0m12:43:45.757454 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_products__products
[0m12:43:45.760484 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:45.761446 [debug] [MainThread]: On master: BEGIN
[0m12:43:45.763151 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:45.776226 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:43:45.777261 [debug] [MainThread]: On master: COMMIT
[0m12:43:45.778221 [debug] [MainThread]: Using duckdb connection "master"
[0m12:43:45.779222 [debug] [MainThread]: On master: COMMIT
[0m12:43:45.781215 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:43:45.782213 [debug] [MainThread]: On master: Close
[0m12:43:45.786242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:45.788404 [debug] [MainThread]: Connection 'create_olist_analytics_staging' was properly closed.
[0m12:43:45.789402 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m12:43:45.790398 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m12:43:45.792399 [debug] [MainThread]: Connection 'model.olist_project.stg_sellers__sellers' was properly closed.
[0m12:43:45.793390 [debug] [MainThread]: Connection 'model.olist_project.stg_products__products' was properly closed.
[0m12:43:45.793390 [debug] [MainThread]: Connection 'model.olist_project.stg_orders__orders' was properly closed.
[0m12:43:45.795385 [debug] [MainThread]: Connection 'model.olist_project.stg_payments__payments' was properly closed.
[0m12:43:45.797379 [info ] [MainThread]: 
[0m12:43:45.799376 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m12:43:45.803362 [debug] [MainThread]: Command end result
[0m12:43:45.821879 [info ] [MainThread]: 
[0m12:43:45.823875 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m12:43:45.825869 [info ] [MainThread]: 
[0m12:43:45.826867 [error] [MainThread]:   Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m12:43:45.829859 [info ] [MainThread]: 
[0m12:43:45.831856 [error] [MainThread]:   Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "information_schema.columns"?
  LINE 20:   from "olist"."main"."raw_customers"
                  ^
[0m12:43:45.836841 [info ] [MainThread]: 
[0m12:43:45.837838 [error] [MainThread]:   Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 23:   from "olist"."main"."raw_orders"
                  ^
[0m12:43:45.839835 [info ] [MainThread]: 
[0m12:43:45.841934 [error] [MainThread]:   Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "olist.pg_catalog.pg_depend"?
  LINE 20:   from "olist"."main"."raw_order_payments"
                  ^
[0m12:43:45.842932 [info ] [MainThread]: 
[0m12:43:45.845925 [error] [MainThread]:   Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "information_schema.tables"?
  LINE 19:   from "olist"."main"."raw_sellers"
                  ^
[0m12:43:45.847919 [info ] [MainThread]: 
[0m12:43:45.849915 [error] [MainThread]:   Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m12:43:45.851908 [info ] [MainThread]: 
[0m12:43:45.853903 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m12:43:45.857893 [debug] [MainThread]: Command `dbt run` failed at 12:43:45.855898 after 2.24 seconds
[0m12:43:45.859888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D398833710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3987D2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D399033B50>]}
[0m12:43:45.860884 [debug] [MainThread]: Flushing usage events
[0m12:45:55.852445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FFD04FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FFB484D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FFCF6D10>]}


============================== 12:45:55.858463 | bf6cff26-c7dd-4dc4-b7b7-33e9f8153f8f ==============================
[0m12:45:55.858463 [info ] [MainThread]: Running with dbt=1.7.9
[0m12:45:55.860421 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m12:45:56.066476 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:45:56.068472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bf6cff26-c7dd-4dc4-b7b7-33e9f8153f8f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FFDABAD0>]}
[0m12:45:56.239285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf6cff26-c7dd-4dc4-b7b7-33e9f8153f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FFEEFE90>]}
[0m12:45:56.376464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf6cff26-c7dd-4dc4-b7b7-33e9f8153f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FFF176D0>]}
[0m12:45:56.383707 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m12:45:56.396451 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m12:45:56.430715 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:45:56.431678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf6cff26-c7dd-4dc4-b7b7-33e9f8153f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025381001B10>]}
[0m12:45:58.804787 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m12:45:58.816791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf6cff26-c7dd-4dc4-b7b7-33e9f8153f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025381301890>]}
[0m12:45:58.849947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf6cff26-c7dd-4dc4-b7b7-33e9f8153f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253814141D0>]}
[0m12:45:58.851943 [info ] [MainThread]: Found 6 models, 9 seeds, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m12:45:58.853936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf6cff26-c7dd-4dc4-b7b7-33e9f8153f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FFDAB990>]}
[0m12:45:58.858922 [info ] [MainThread]: 
[0m12:45:58.861915 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:45:58.865905 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m12:45:58.891928 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m12:45:58.892928 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"olist"'
    
  
  
[0m12:45:58.893924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:58.918611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:45:58.921602 [debug] [ThreadPool]: On list_olist: Close
[0m12:45:58.926589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_analytics_staging)
[0m12:45:58.929581 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "analytics_staging"
"
[0m12:45:58.940650 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:45:58.941908 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
        select type from duckdb_databases()
        where database_name='olist'
        and type='sqlite'
    
  
[0m12:45:58.942909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:58.955872 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:45:58.958863 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:45:58.959861 [debug] [ThreadPool]: On create_olist_analytics_staging: BEGIN
[0m12:45:58.960858 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:45:58.962853 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:45:58.963852 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
    
        create schema if not exists "olist"."analytics_staging"
    
[0m12:45:58.965845 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:45:58.967842 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m12:45:58.973824 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:45:58.974821 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m12:45:58.976816 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:45:58.977814 [debug] [ThreadPool]: On create_olist_analytics_staging: Close
[0m12:45:58.981366 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m12:45:58.981366 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m12:45:58.999123 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m12:45:59.005107 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m12:45:59.006105 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m12:45:59.007102 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m12:45:59.008099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:59.009097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:59.022993 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:45:59.023991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:45:59.024987 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m12:45:59.026982 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m12:45:59.027979 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m12:45:59.029974 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m12:45:59.110979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:45:59.117240 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m12:45:59.120237 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m12:45:59.121231 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m12:45:59.124223 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:45:59.128211 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m12:45:59.130208 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m12:45:59.131204 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m12:45:59.137309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf6cff26-c7dd-4dc4-b7b7-33e9f8153f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253810F7650>]}
[0m12:45:59.138308 [debug] [MainThread]: Using duckdb connection "master"
[0m12:45:59.139307 [debug] [MainThread]: On master: BEGIN
[0m12:45:59.140305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:59.152597 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:45:59.153596 [debug] [MainThread]: On master: COMMIT
[0m12:45:59.154592 [debug] [MainThread]: Using duckdb connection "master"
[0m12:45:59.155591 [debug] [MainThread]: On master: COMMIT
[0m12:45:59.157584 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:45:59.158580 [debug] [MainThread]: On master: Close
[0m12:45:59.161573 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:45:59.162807 [info ] [MainThread]: 
[0m12:45:59.164830 [debug] [Thread-1 (]: Began running node model.olist_project.stg_customers__customers
[0m12:45:59.164830 [debug] [Thread-2 (]: Began running node model.olist_project.stg_order_items__order_items
[0m12:45:59.171351 [debug] [Thread-3 (]: Began running node model.olist_project.stg_orders__orders
[0m12:45:59.171351 [debug] [Thread-4 (]: Began running node model.olist_project.stg_payments__payments
[0m12:45:59.171351 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_customers__customers ........ [RUN]
[0m12:45:59.183401 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_project.stg_customers__customers'
[0m12:45:59.184399 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_customers__customers
[0m12:45:59.176601 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_order_items__order_items .... [RUN]
[0m12:45:59.208214 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_customers__customers"
[0m12:45:59.211207 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_project.stg_order_items__order_items'
[0m12:45:59.177599 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_orders__orders .............. [RUN]
[0m12:45:59.215324 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_order_items__order_items
[0m12:45:59.218432 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_project.stg_orders__orders'
[0m12:45:59.219429 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (compile): 12:45:59.185397 => 12:45:59.218432
[0m12:45:59.230408 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_order_items__order_items"
[0m12:45:59.179404 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_staging.stg_payments__payments .......... [RUN]
[0m12:45:59.232393 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_orders__orders
[0m12:45:59.235386 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_customers__customers
[0m12:45:59.238513 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_project.stg_payments__payments'
[0m12:45:59.248449 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_orders__orders"
[0m12:45:59.249445 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (compile): 12:45:59.220427 => 12:45:59.248449
[0m12:45:59.321509 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_customers__customers"
[0m12:45:59.322505 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_payments__payments
[0m12:45:59.324500 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_order_items__order_items
[0m12:45:59.326495 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (compile): 12:45:59.239511 => 12:45:59.325496
[0m12:45:59.333477 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_payments__payments"
[0m12:45:59.334473 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m12:45:59.343663 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_order_items__order_items"
[0m12:45:59.344662 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_orders__orders
[0m12:45:59.347653 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: BEGIN
[0m12:45:59.348650 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (compile): 12:45:59.326495 => 12:45:59.347653
[0m12:45:59.360618 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_orders__orders"
[0m12:45:59.362612 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m12:45:59.363611 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:45:59.365604 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_payments__payments
[0m12:45:59.367726 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: BEGIN
[0m12:45:59.385676 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m12:45:59.394652 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_payments__payments"
[0m12:45:59.395652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:45:59.396646 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:45:59.397644 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: BEGIN
[0m12:45:59.399638 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m12:45:59.401633 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m12:45:59.402630 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m12:45:59.403627 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:45:59.404625 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_customers__customers__dbt_tmp"
  
    as (
      

with source as (
  select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
  from "olist"."main"."raw_customers"
)

select
  customer_id,
  customer_unique_id,
  customer_zip_code_prefix,
  customer_city,
  customer_state
from source
    );
  
  
[0m12:45:59.406620 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: BEGIN
[0m12:45:59.407619 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m12:45:59.409612 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m12:45:59.411607 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:45:59.414599 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."main"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m12:45:59.415595 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m12:45:59.417590 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m12:45:59.420586 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_orders__orders__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
  from main.raw_orders
)

, cleaned as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_at,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_at,
    order_delivered_customer_date::timestamp as order_delivered_customer_at,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_at,
    case 
      when order_delivered_customer_date is not null 
      then (order_delivered_customer_date::timestamp - order_purchase_timestamp::timestamp).days
      else null 
    end as days_to_delivery,
    case
      when order_delivered_customer_date > order_estimated_delivery_date then true
      else false
    end as is_late_delivery
  from source
)

select * from cleaned
    );
  
  
[0m12:45:59.423575 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m12:45:59.430557 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_payments__payments__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
  from "olist"."main"."raw_order_payments"
)

select * from source
    );
  
  
[0m12:45:59.488816 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (execute): 12:45:59.250443 => 12:45:59.487816
[0m12:45:59.490810 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (execute): 12:45:59.350645 => 12:45:59.489812
[0m12:45:59.491846 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: ROLLBACK
[0m12:45:59.491846 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: ROLLBACK
[0m12:45:59.496351 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (execute): 12:45:59.386674 => 12:45:59.491846
[0m12:45:59.496351 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (execute): 12:45:59.335471 => 12:45:59.496351
[0m12:45:59.501383 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: ROLLBACK
[0m12:45:59.501383 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: ROLLBACK
[0m12:45:59.525636 [debug] [Thread-3 (]: Failed to rollback 'model.olist_project.stg_orders__orders'
[0m12:45:59.527632 [debug] [Thread-4 (]: Failed to rollback 'model.olist_project.stg_payments__payments'
[0m12:45:59.529625 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: Close
[0m12:45:59.532617 [debug] [Thread-1 (]: Failed to rollback 'model.olist_project.stg_customers__customers'
[0m12:45:59.536605 [debug] [Thread-2 (]: Failed to rollback 'model.olist_project.stg_order_items__order_items'
[0m12:45:59.537758 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: Close
[0m12:45:59.541875 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: Close
[0m12:45:59.543870 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: Close
[0m12:45:59.546862 [debug] [Thread-3 (]: Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "information_schema.tables"?
  LINE 23:   from main.raw_orders
                  ^
[0m12:45:59.596528 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf6cff26-c7dd-4dc4-b7b7-33e9f8153f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025381406210>]}
[0m12:45:59.606755 [debug] [Thread-1 (]: Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "information_schema.columns"?
  LINE 20:   from "olist"."main"."raw_customers"
                  ^
[0m12:45:59.609747 [debug] [Thread-2 (]: Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m12:45:59.611742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf6cff26-c7dd-4dc4-b7b7-33e9f8153f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025381395A90>]}
[0m12:45:59.612847 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf6cff26-c7dd-4dc4-b7b7-33e9f8153f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025381457C50>]}
[0m12:45:59.596528 [debug] [Thread-4 (]: Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "pg_catalog.pg_depend"?
  LINE 20:   from "olist"."main"."raw_order_payments"
                  ^
[0m12:45:59.621943 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf6cff26-c7dd-4dc4-b7b7-33e9f8153f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253813CD9D0>]}
[0m12:45:59.601555 [error] [Thread-3 (]: 3 of 6 ERROR creating sql table model analytics_staging.stg_orders__orders ..... [[31mERROR[0m in 0.38s]
[0m12:45:59.626929 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_orders__orders
[0m12:45:59.628925 [debug] [Thread-3 (]: Began running node model.olist_project.stg_products__products
[0m12:45:59.614844 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model analytics_staging.stg_customers__customers  [[31mERROR[0m in 0.43s]
[0m12:45:59.666074 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_customers__customers
[0m12:45:59.668069 [debug] [Thread-1 (]: Began running node model.olist_project.stg_sellers__sellers
[0m12:45:59.616955 [error] [Thread-2 (]: 2 of 6 ERROR creating sql table model analytics_staging.stg_order_items__order_items  [[31mERROR[0m in 0.40s]
[0m12:45:59.675055 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_order_items__order_items
[0m12:45:59.624934 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model analytics_staging.stg_payments__payments . [[31mERROR[0m in 0.38s]
[0m12:45:59.709243 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_payments__payments
[0m12:45:59.631916 [info ] [Thread-3 (]: 5 of 6 START sql table model analytics_staging.stg_products__products .......... [RUN]
[0m12:45:59.734377 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_orders__orders, now model.olist_project.stg_products__products)
[0m12:45:59.746917 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_products__products
[0m12:45:59.672057 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics_staging.stg_sellers__sellers ............ [RUN]
[0m12:45:59.761397 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_products__products"
[0m12:45:59.763388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_customers__customers, now model.olist_project.stg_sellers__sellers)
[0m12:45:59.765381 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_sellers__sellers
[0m12:45:59.776351 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_products__products (compile): 12:45:59.748918 => 12:45:59.776351
[0m12:45:59.779345 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_sellers__sellers"
[0m12:45:59.784330 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_sellers__sellers (compile): 12:45:59.766379 => 12:45:59.783332
[0m12:45:59.781337 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_products__products
[0m12:45:59.786325 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_sellers__sellers
[0m12:45:59.798292 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_products__products"
[0m12:45:59.810259 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_sellers__sellers"
[0m12:45:59.812472 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m12:45:59.813467 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: BEGIN
[0m12:45:59.815458 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m12:45:59.816455 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:45:59.817452 [debug] [Thread-1 (]: On model.olist_project.stg_sellers__sellers: BEGIN
[0m12:45:59.830418 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m12:45:59.831414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:59.832412 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m12:45:59.834407 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:45:59.835404 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_products__products__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."main"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m12:45:59.836401 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m12:45:59.838396 [debug] [Thread-1 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp"
  
    as (
      

with source as (
  select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
  from "olist"."main"."raw_sellers"
)

select * from source
    );
  
  
[0m12:45:59.920180 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_sellers__sellers (execute): 12:45:59.799289 => 12:45:59.920180
[0m12:45:59.921181 [debug] [Thread-1 (]: On model.olist_project.stg_sellers__sellers: ROLLBACK
[0m12:45:59.928156 [debug] [Thread-1 (]: Failed to rollback 'model.olist_project.stg_sellers__sellers'
[0m12:45:59.930151 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_products__products (execute): 12:45:59.787322 => 12:45:59.929153
[0m12:45:59.932146 [debug] [Thread-1 (]: On model.olist_project.stg_sellers__sellers: Close
[0m12:45:59.933143 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: ROLLBACK
[0m12:45:59.944114 [debug] [Thread-1 (]: Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 19:   from "olist"."main"."raw_sellers"
                  ^
[0m12:45:59.945113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf6cff26-c7dd-4dc4-b7b7-33e9f8153f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538150D4D0>]}
[0m12:45:59.948103 [debug] [Thread-3 (]: Failed to rollback 'model.olist_project.stg_products__products'
[0m12:45:59.950098 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: Close
[0m12:45:59.949102 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model analytics_staging.stg_sellers__sellers ... [[31mERROR[0m in 0.18s]
[0m12:45:59.961069 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_sellers__sellers
[0m12:45:59.966056 [debug] [Thread-3 (]: Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m12:45:59.967053 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf6cff26-c7dd-4dc4-b7b7-33e9f8153f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253813949D0>]}
[0m12:45:59.970045 [error] [Thread-3 (]: 5 of 6 ERROR creating sql table model analytics_staging.stg_products__products . [[31mERROR[0m in 0.23s]
[0m12:45:59.974037 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_products__products
[0m12:45:59.980018 [debug] [MainThread]: Using duckdb connection "master"
[0m12:45:59.981017 [debug] [MainThread]: On master: BEGIN
[0m12:45:59.984008 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:46:00.001828 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:46:00.001828 [debug] [MainThread]: On master: COMMIT
[0m12:46:00.001828 [debug] [MainThread]: Using duckdb connection "master"
[0m12:46:00.001828 [debug] [MainThread]: On master: COMMIT
[0m12:46:00.001828 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:46:00.001828 [debug] [MainThread]: On master: Close
[0m12:46:00.011716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:00.013711 [debug] [MainThread]: Connection 'create_olist_analytics_staging' was properly closed.
[0m12:46:00.018698 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m12:46:00.020693 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m12:46:00.021690 [debug] [MainThread]: Connection 'model.olist_project.stg_sellers__sellers' was properly closed.
[0m12:46:00.022687 [debug] [MainThread]: Connection 'model.olist_project.stg_order_items__order_items' was properly closed.
[0m12:46:00.024683 [debug] [MainThread]: Connection 'model.olist_project.stg_products__products' was properly closed.
[0m12:46:00.025681 [debug] [MainThread]: Connection 'model.olist_project.stg_payments__payments' was properly closed.
[0m12:46:00.026677 [info ] [MainThread]: 
[0m12:46:00.027675 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m12:46:00.032174 [debug] [MainThread]: Command end result
[0m12:46:00.050127 [info ] [MainThread]: 
[0m12:46:00.053118 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m12:46:00.055116 [info ] [MainThread]: 
[0m12:46:00.056111 [error] [MainThread]:   Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "information_schema.tables"?
  LINE 23:   from main.raw_orders
                  ^
[0m12:46:00.058107 [info ] [MainThread]: 
[0m12:46:00.060101 [error] [MainThread]:   Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "information_schema.columns"?
  LINE 20:   from "olist"."main"."raw_customers"
                  ^
[0m12:46:00.062289 [info ] [MainThread]: 
[0m12:46:00.064286 [error] [MainThread]:   Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m12:46:00.068177 [info ] [MainThread]: 
[0m12:46:00.069175 [error] [MainThread]:   Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "pg_catalog.pg_depend"?
  LINE 20:   from "olist"."main"."raw_order_payments"
                  ^
[0m12:46:00.072167 [info ] [MainThread]: 
[0m12:46:00.073164 [error] [MainThread]:   Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 19:   from "olist"."main"."raw_sellers"
                  ^
[0m12:46:00.075159 [info ] [MainThread]: 
[0m12:46:00.077154 [error] [MainThread]:   Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m12:46:00.080148 [info ] [MainThread]: 
[0m12:46:00.081144 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m12:46:00.086130 [debug] [MainThread]: Command `dbt run` failed at 12:46:00.086130 after 4.35 seconds
[0m12:46:00.087129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FF48B2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253FF4F33D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253F8F09A50>]}
[0m12:46:00.088127 [debug] [MainThread]: Flushing usage events
[0m12:49:38.073169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F1DE7C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F18BD450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F1DE1310>]}


============================== 12:49:38.082153 | 78c1f9ec-0c07-4813-b6c8-2e972b5f2fbf ==============================
[0m12:49:38.082153 [info ] [MainThread]: Running with dbt=1.7.9
[0m12:49:38.084139 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m12:49:38.319229 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:49:38.321024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '78c1f9ec-0c07-4813-b6c8-2e972b5f2fbf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F1E22350>]}
[0m12:49:38.484802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78c1f9ec-0c07-4813-b6c8-2e972b5f2fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F2F46410>]}
[0m12:49:38.636646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78c1f9ec-0c07-4813-b6c8-2e972b5f2fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F1BA0510>]}
[0m12:49:38.639640 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m12:49:38.655769 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m12:49:38.806242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:49:38.809229 [debug] [MainThread]: Partial parsing: updated file: olist_project://models\staging\sources.yml
[0m12:49:38.810225 [debug] [MainThread]: Partial parsing: updated file: olist_project://models\staging\stg_orders__orders.sql
[0m12:49:39.264650 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m12:49:39.274697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78c1f9ec-0c07-4813-b6c8-2e972b5f2fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F3366AD0>]}
[0m12:49:39.300628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78c1f9ec-0c07-4813-b6c8-2e972b5f2fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F3267850>]}
[0m12:49:39.303620 [info ] [MainThread]: Found 9 seeds, 6 models, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m12:49:39.304619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78c1f9ec-0c07-4813-b6c8-2e972b5f2fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F1E03C50>]}
[0m12:49:39.309604 [info ] [MainThread]: 
[0m12:49:39.311602 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:49:39.314592 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m12:49:39.345057 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m12:49:39.346056 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"olist"'
    
  
  
[0m12:49:39.347053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:39.368105 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:49:39.372096 [debug] [ThreadPool]: On list_olist: Close
[0m12:49:39.376121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_analytics_staging)
[0m12:49:39.378119 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "analytics_staging"
"
[0m12:49:39.390196 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:49:39.390196 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
        select type from duckdb_databases()
        where database_name='olist'
        and type='sqlite'
    
  
[0m12:49:39.391194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:39.406336 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:49:39.410326 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:49:39.411360 [debug] [ThreadPool]: On create_olist_analytics_staging: BEGIN
[0m12:49:39.412443 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:49:39.413444 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:49:39.414438 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
    
        create schema if not exists "olist"."analytics_staging"
    
[0m12:49:39.415602 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:49:39.418597 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m12:49:39.419593 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:49:39.420630 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m12:49:39.421624 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:49:39.422586 [debug] [ThreadPool]: On create_olist_analytics_staging: Close
[0m12:49:39.430563 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m12:49:39.433558 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m12:49:39.448516 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m12:49:39.457492 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m12:49:39.458489 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m12:49:39.460483 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m12:49:39.462479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:39.464628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:39.482740 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:49:39.483736 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:49:39.484734 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m12:49:39.486730 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m12:49:39.487727 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m12:49:39.489720 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m12:49:39.598918 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:49:39.599913 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:49:39.603904 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m12:49:39.606896 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m12:49:39.608889 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m12:49:39.610883 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m12:49:39.611882 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m12:49:39.614876 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m12:49:39.623072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78c1f9ec-0c07-4813-b6c8-2e972b5f2fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F3300F50>]}
[0m12:49:39.625066 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:39.627061 [debug] [MainThread]: On master: BEGIN
[0m12:49:39.628060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:39.644017 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:49:39.645012 [debug] [MainThread]: On master: COMMIT
[0m12:49:39.646010 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:39.647006 [debug] [MainThread]: On master: COMMIT
[0m12:49:39.648004 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:49:39.649001 [debug] [MainThread]: On master: Close
[0m12:49:39.652992 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:49:39.654987 [info ] [MainThread]: 
[0m12:49:39.659972 [debug] [Thread-1 (]: Began running node model.olist_project.stg_customers__customers
[0m12:49:39.660970 [debug] [Thread-2 (]: Began running node model.olist_project.stg_order_items__order_items
[0m12:49:39.661967 [debug] [Thread-3 (]: Began running node model.olist_project.stg_orders__orders
[0m12:49:39.662965 [debug] [Thread-4 (]: Began running node model.olist_project.stg_payments__payments
[0m12:49:39.663961 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_customers__customers ........ [RUN]
[0m12:49:39.665957 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_order_items__order_items .... [RUN]
[0m12:49:39.667951 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_orders__orders .............. [RUN]
[0m12:49:39.672939 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_project.stg_customers__customers'
[0m12:49:39.669948 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_staging.stg_payments__payments .......... [RUN]
[0m12:49:39.675931 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_project.stg_order_items__order_items'
[0m12:49:39.677925 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_project.stg_orders__orders'
[0m12:49:39.678922 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_customers__customers
[0m12:49:39.680916 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_project.stg_payments__payments'
[0m12:49:39.683911 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_order_items__order_items
[0m12:49:39.687899 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_orders__orders
[0m12:49:39.709838 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_customers__customers"
[0m12:49:39.710835 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_payments__payments
[0m12:49:39.721927 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_order_items__order_items"
[0m12:49:39.779804 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_orders__orders"
[0m12:49:39.786788 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_payments__payments"
[0m12:49:39.787907 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (compile): 12:49:39.688897 => 12:49:39.787907
[0m12:49:39.790902 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (compile): 12:49:39.711834 => 12:49:39.789904
[0m12:49:39.792109 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_customers__customers
[0m12:49:39.794105 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (compile): 12:49:39.722935 => 12:49:39.793106
[0m12:49:39.796099 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (compile): 12:49:39.780801 => 12:49:39.796099
[0m12:49:39.798096 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_order_items__order_items
[0m12:49:39.865368 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_customers__customers"
[0m12:49:39.865368 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_orders__orders
[0m12:49:39.867364 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_payments__payments
[0m12:49:39.874387 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_order_items__order_items"
[0m12:49:39.882325 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_orders__orders"
[0m12:49:39.889443 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m12:49:39.891600 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_payments__payments"
[0m12:49:39.893597 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: BEGIN
[0m12:49:39.895591 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m12:49:39.896588 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m12:49:39.898585 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:39.899581 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m12:49:39.900579 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: BEGIN
[0m12:49:39.901574 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: BEGIN
[0m12:49:39.914648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:49:39.915641 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: BEGIN
[0m12:49:39.916776 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:49:39.917776 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:49:39.918775 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m12:49:39.920766 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:49:39.922761 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m12:49:39.924757 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m12:49:39.925212 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_customers__customers__dbt_tmp"
  
    as (
      

with source as (
  select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
  from "olist"."analytics"."raw_customers"
)

select
  customer_id,
  customer_unique_id,
  customer_zip_code_prefix,
  customer_city,
  customer_state
from source
    );
  
  
[0m12:49:39.927115 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m12:49:39.927802 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m12:49:39.928495 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m12:49:39.930498 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m12:49:39.932489 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."analytics"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."analytics"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m12:49:39.933485 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_orders__orders__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
  from "olist"."analytics"."raw_orders"
)


, cleaned as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_at,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_at,
    order_delivered_customer_date::timestamp as order_delivered_customer_at,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_at,
    case 
      when order_delivered_customer_date is not null 
      then (order_delivered_customer_date::timestamp - order_purchase_timestamp::timestamp).days
      else null 
    end as days_to_delivery,
    case
      when order_delivered_customer_date > order_estimated_delivery_date then true
      else false
    end as is_late_delivery
  from source
)

select * from cleaned
    );
  
  
[0m12:49:39.935480 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_payments__payments__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
  from "olist"."analytics"."raw_order_payments"
)

select * from source
    );
  
  
[0m12:49:40.012671 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (execute): 12:49:39.883319 => 12:49:40.011672
[0m12:49:40.014150 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: ROLLBACK
[0m12:49:40.017843 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (execute): 12:49:39.799091 => 12:49:40.017843
[0m12:49:40.019837 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: ROLLBACK
[0m12:49:40.025821 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (execute): 12:49:39.875342 => 12:49:40.024823
[0m12:49:40.026818 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (execute): 12:49:39.867364 => 12:49:40.026818
[0m12:49:40.027815 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: ROLLBACK
[0m12:49:40.029820 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: ROLLBACK
[0m12:49:40.042775 [debug] [Thread-2 (]: Failed to rollback 'model.olist_project.stg_order_items__order_items'
[0m12:49:40.045767 [debug] [Thread-3 (]: Failed to rollback 'model.olist_project.stg_orders__orders'
[0m12:49:40.047762 [debug] [Thread-4 (]: Failed to rollback 'model.olist_project.stg_payments__payments'
[0m12:49:40.048759 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: Close
[0m12:49:40.051750 [debug] [Thread-1 (]: Failed to rollback 'model.olist_project.stg_customers__customers'
[0m12:49:40.052750 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: Close
[0m12:49:40.053746 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: Close
[0m12:49:40.057735 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: Close
[0m12:49:40.066204 [debug] [Thread-2 (]: Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "pg_catalog.pg_proc"?
  LINE 24:   from "olist"."analytics"."raw_products"
                  ^
[0m12:49:40.074547 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c1f9ec-0c07-4813-b6c8-2e972b5f2fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F30B6AD0>]}
[0m12:49:40.077538 [debug] [Thread-3 (]: Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "information_schema.tables"?
  LINE 23:   from "olist"."analytics"."raw_orders"
                  ^
[0m12:49:40.081930 [debug] [Thread-4 (]: Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "pg_catalog.pg_depend"?
  LINE 20:   from "olist"."analytics"."raw_order_payments"
  )
  
  select * from source
      );
    
    ...
                  ^
[0m12:49:40.079582 [error] [Thread-2 (]: 2 of 6 ERROR creating sql table model analytics_staging.stg_order_items__order_items  [[31mERROR[0m in 0.40s]
[0m12:49:40.083923 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c1f9ec-0c07-4813-b6c8-2e972b5f2fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F33A8AD0>]}
[0m12:49:40.087006 [debug] [Thread-1 (]: Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "information_schema.columns"?
  LINE 20:   from "olist"."analytics"."raw_customers"
                  ^
[0m12:49:40.088006 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c1f9ec-0c07-4813-b6c8-2e972b5f2fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F3266A50>]}
[0m12:49:40.089016 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_order_items__order_items
[0m12:49:40.092993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c1f9ec-0c07-4813-b6c8-2e972b5f2fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F329C750>]}
[0m12:49:40.090998 [error] [Thread-3 (]: 3 of 6 ERROR creating sql table model analytics_staging.stg_orders__orders ..... [[31mERROR[0m in 0.41s]
[0m12:49:40.095984 [debug] [Thread-2 (]: Began running node model.olist_project.stg_products__products
[0m12:49:40.094988 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model analytics_staging.stg_payments__payments . [[31mERROR[0m in 0.41s]
[0m12:49:40.101971 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_orders__orders
[0m12:49:40.099975 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model analytics_staging.stg_customers__customers  [[31mERROR[0m in 0.42s]
[0m12:49:40.105958 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_payments__payments
[0m12:49:40.102967 [info ] [Thread-2 (]: 5 of 6 START sql table model analytics_staging.stg_products__products .......... [RUN]
[0m12:49:40.109509 [debug] [Thread-3 (]: Began running node model.olist_project.stg_sellers__sellers
[0m12:49:40.112607 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_customers__customers
[0m12:49:40.115722 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_order_items__order_items, now model.olist_project.stg_products__products)
[0m12:49:40.122704 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_products__products
[0m12:49:40.136923 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_products__products"
[0m12:49:40.117720 [info ] [Thread-3 (]: 6 of 6 START sql table model analytics_staging.stg_sellers__sellers ............ [RUN]
[0m12:49:40.140982 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_orders__orders, now model.olist_project.stg_sellers__sellers)
[0m12:49:40.142908 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_sellers__sellers
[0m12:49:40.164851 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_sellers__sellers"
[0m12:49:40.167843 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_sellers__sellers (compile): 12:49:40.143907 => 12:49:40.166844
[0m12:49:40.169843 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_products__products (compile): 12:49:40.123703 => 12:49:40.168839
[0m12:49:40.174826 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_sellers__sellers
[0m12:49:40.176818 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_products__products
[0m12:49:40.192775 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_sellers__sellers"
[0m12:49:40.213719 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_products__products"
[0m12:49:40.216710 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m12:49:40.218705 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m12:49:40.218705 [debug] [Thread-3 (]: On model.olist_project.stg_sellers__sellers: BEGIN
[0m12:49:40.220700 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: BEGIN
[0m12:49:40.222695 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:49:40.224701 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:49:40.240647 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m12:49:40.242641 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m12:49:40.243639 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m12:49:40.244636 [debug] [Thread-3 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp"
  
    as (
      

with source as (
  select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
  from "olist"."analytics"."raw_sellers"
)

select * from source
    );
  
  
[0m12:49:40.245634 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m12:49:40.247628 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_products__products__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."analytics"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."analytics"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m12:49:40.330985 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_products__products (execute): 12:49:40.193771 => 12:49:40.329984
[0m12:49:40.332983 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_sellers__sellers (execute): 12:49:40.177815 => 12:49:40.331984
[0m12:49:40.334973 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: ROLLBACK
[0m12:49:40.335970 [debug] [Thread-3 (]: On model.olist_project.stg_sellers__sellers: ROLLBACK
[0m12:49:40.344070 [debug] [Thread-2 (]: Failed to rollback 'model.olist_project.stg_products__products'
[0m12:49:40.346064 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: Close
[0m12:49:40.348063 [debug] [Thread-3 (]: Failed to rollback 'model.olist_project.stg_sellers__sellers'
[0m12:49:40.352049 [debug] [Thread-3 (]: On model.olist_project.stg_sellers__sellers: Close
[0m12:49:40.362133 [debug] [Thread-2 (]: Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."analytics"."raw_products"
                  ^
[0m12:49:40.363131 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c1f9ec-0c07-4813-b6c8-2e972b5f2fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F3390D10>]}
[0m12:49:40.368227 [debug] [Thread-3 (]: Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "information_schema.tables"?
  LINE 19:   from "olist"."analytics"."raw_sellers"
                  ^
[0m12:49:40.365124 [error] [Thread-2 (]: 5 of 6 ERROR creating sql table model analytics_staging.stg_products__products . [[31mERROR[0m in 0.25s]
[0m12:49:40.369225 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78c1f9ec-0c07-4813-b6c8-2e972b5f2fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F30665D0>]}
[0m12:49:40.370221 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_products__products
[0m12:49:40.373214 [error] [Thread-3 (]: 6 of 6 ERROR creating sql table model analytics_staging.stg_sellers__sellers ... [[31mERROR[0m in 0.23s]
[0m12:49:40.376206 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_sellers__sellers
[0m12:49:40.380195 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:40.381193 [debug] [MainThread]: On master: BEGIN
[0m12:49:40.383205 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:49:40.403136 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:49:40.405128 [debug] [MainThread]: On master: COMMIT
[0m12:49:40.407123 [debug] [MainThread]: Using duckdb connection "master"
[0m12:49:40.408122 [debug] [MainThread]: On master: COMMIT
[0m12:49:40.410115 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:49:40.412110 [debug] [MainThread]: On master: Close
[0m12:49:40.415101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:40.419340 [debug] [MainThread]: Connection 'create_olist_analytics_staging' was properly closed.
[0m12:49:40.422333 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m12:49:40.424326 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m12:49:40.425325 [debug] [MainThread]: Connection 'model.olist_project.stg_customers__customers' was properly closed.
[0m12:49:40.426320 [debug] [MainThread]: Connection 'model.olist_project.stg_products__products' was properly closed.
[0m12:49:40.427319 [debug] [MainThread]: Connection 'model.olist_project.stg_sellers__sellers' was properly closed.
[0m12:49:40.428315 [debug] [MainThread]: Connection 'model.olist_project.stg_payments__payments' was properly closed.
[0m12:49:40.429312 [info ] [MainThread]: 
[0m12:49:40.431308 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m12:49:40.434298 [debug] [MainThread]: Command end result
[0m12:49:40.452253 [info ] [MainThread]: 
[0m12:49:40.453263 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m12:49:40.455246 [info ] [MainThread]: 
[0m12:49:40.456241 [error] [MainThread]:   Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "pg_catalog.pg_proc"?
  LINE 24:   from "olist"."analytics"."raw_products"
                  ^
[0m12:49:40.459234 [info ] [MainThread]: 
[0m12:49:40.461227 [error] [MainThread]:   Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "information_schema.tables"?
  LINE 23:   from "olist"."analytics"."raw_orders"
                  ^
[0m12:49:40.463276 [info ] [MainThread]: 
[0m12:49:40.465273 [error] [MainThread]:   Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "pg_catalog.pg_depend"?
  LINE 20:   from "olist"."analytics"."raw_order_payments"
  )
  
  select * from source
      );
    
    ...
                  ^
[0m12:49:40.468399 [info ] [MainThread]: 
[0m12:49:40.470379 [error] [MainThread]:   Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "information_schema.columns"?
  LINE 20:   from "olist"."analytics"."raw_customers"
                  ^
[0m12:49:40.474367 [info ] [MainThread]: 
[0m12:49:40.477360 [error] [MainThread]:   Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."analytics"."raw_products"
                  ^
[0m12:49:40.479355 [info ] [MainThread]: 
[0m12:49:40.482347 [error] [MainThread]:   Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "information_schema.tables"?
  LINE 19:   from "olist"."analytics"."raw_sellers"
                  ^
[0m12:49:40.484342 [info ] [MainThread]: 
[0m12:49:40.487487 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m12:49:40.493473 [debug] [MainThread]: Command `dbt run` failed at 12:49:40.493473 after 2.53 seconds
[0m12:49:40.496465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157EAFB9F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157EAFB9AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157F1DC3750>]}
[0m12:49:40.498461 [debug] [MainThread]: Flushing usage events
[0m12:51:50.573630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C784B8090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C77CB3CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C784BB790>]}


============================== 12:51:50.579911 | 1ba1381f-efa5-47c8-b455-99897f6e96df ==============================
[0m12:51:50.579911 [info ] [MainThread]: Running with dbt=1.7.9
[0m12:51:50.581907 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m12:51:50.806485 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:51:50.808553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1ba1381f-efa5-47c8-b455-99897f6e96df', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C778EA750>]}
[0m12:51:50.963264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ba1381f-efa5-47c8-b455-99897f6e96df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C76CF21D0>]}
[0m12:51:51.103420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ba1381f-efa5-47c8-b455-99897f6e96df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C76CF21D0>]}
[0m12:51:51.105379 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m12:51:51.115522 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m12:51:51.246280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:51:51.248266 [debug] [MainThread]: Partial parsing: updated file: olist_project://models\staging\sources.yml
[0m12:51:51.752857 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m12:51:51.759835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ba1381f-efa5-47c8-b455-99897f6e96df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C7988C890>]}
[0m12:51:51.786840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ba1381f-efa5-47c8-b455-99897f6e96df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C798A2190>]}
[0m12:51:51.787841 [info ] [MainThread]: Found 9 seeds, 6 models, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m12:51:51.789835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ba1381f-efa5-47c8-b455-99897f6e96df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C7988D290>]}
[0m12:51:51.794054 [info ] [MainThread]: 
[0m12:51:51.796013 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:51:51.800004 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m12:51:51.827058 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m12:51:51.830050 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"olist"'
    
  
  
[0m12:51:51.831047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:51.847312 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:51:51.850308 [debug] [ThreadPool]: On list_olist: Close
[0m12:51:51.855291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_analytics_staging)
[0m12:51:51.856251 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "analytics_staging"
"
[0m12:51:51.869215 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:51:51.870213 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
        select type from duckdb_databases()
        where database_name='olist'
        and type='sqlite'
    
  
[0m12:51:51.871211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:51:51.885175 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:51:51.887169 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:51:51.888167 [debug] [ThreadPool]: On create_olist_analytics_staging: BEGIN
[0m12:51:51.889164 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:51:51.890161 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:51:51.891158 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
    
        create schema if not exists "olist"."analytics_staging"
    
[0m12:51:51.893151 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:51:51.894149 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m12:51:51.895146 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m12:51:51.896143 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m12:51:51.898140 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:51:51.899137 [debug] [ThreadPool]: On create_olist_analytics_staging: Close
[0m12:51:51.905119 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m12:51:51.907114 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m12:51:51.917284 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m12:51:51.922271 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m12:51:51.923266 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m12:51:51.924263 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m12:51:51.925262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:51.926258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:51.939401 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:51:51.941808 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:51:51.941808 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m12:51:51.943803 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m12:51:51.944800 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m12:51:51.945796 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m12:51:52.022971 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:51:52.025962 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m12:51:52.026960 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:51:52.028999 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m12:51:52.029989 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m12:51:52.031949 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m12:51:52.032945 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m12:51:52.033943 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m12:51:52.039926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ba1381f-efa5-47c8-b455-99897f6e96df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C785684D0>]}
[0m12:51:52.040961 [debug] [MainThread]: Using duckdb connection "master"
[0m12:51:52.041922 [debug] [MainThread]: On master: BEGIN
[0m12:51:52.042919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:51:52.054886 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:51:52.056881 [debug] [MainThread]: On master: COMMIT
[0m12:51:52.057878 [debug] [MainThread]: Using duckdb connection "master"
[0m12:51:52.058876 [debug] [MainThread]: On master: COMMIT
[0m12:51:52.060871 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:51:52.061868 [debug] [MainThread]: On master: Close
[0m12:51:52.066418 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:51:52.067633 [info ] [MainThread]: 
[0m12:51:52.073615 [debug] [Thread-1 (]: Began running node model.olist_project.stg_customers__customers
[0m12:51:52.074613 [debug] [Thread-2 (]: Began running node model.olist_project.stg_order_items__order_items
[0m12:51:52.074613 [debug] [Thread-3 (]: Began running node model.olist_project.stg_orders__orders
[0m12:51:52.075640 [debug] [Thread-4 (]: Began running node model.olist_project.stg_payments__payments
[0m12:51:52.076607 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_customers__customers ........ [RUN]
[0m12:51:52.077605 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_order_items__order_items .... [RUN]
[0m12:51:52.079600 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_orders__orders .............. [RUN]
[0m12:51:52.084587 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_project.stg_customers__customers'
[0m12:51:52.081595 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_staging.stg_payments__payments .......... [RUN]
[0m12:51:52.086582 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_project.stg_order_items__order_items'
[0m12:51:52.095558 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_order_items__order_items
[0m12:51:52.088577 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_project.stg_orders__orders'
[0m12:51:52.091568 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_project.stg_payments__payments'
[0m12:51:52.089572 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_customers__customers
[0m12:51:52.118496 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_order_items__order_items"
[0m12:51:52.119494 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_orders__orders
[0m12:51:52.121489 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_payments__payments
[0m12:51:52.129466 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_customers__customers"
[0m12:51:52.188989 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_orders__orders"
[0m12:51:52.194941 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_payments__payments"
[0m12:51:52.195937 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (compile): 12:51:52.097554 => 12:51:52.194941
[0m12:51:52.197932 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (compile): 12:51:52.122486 => 12:51:52.197932
[0m12:51:52.199929 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_order_items__order_items
[0m12:51:52.200923 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (compile): 12:51:52.130463 => 12:51:52.200923
[0m12:51:52.202920 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_customers__customers
[0m12:51:52.203916 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (compile): 12:51:52.189986 => 12:51:52.203916
[0m12:51:52.270254 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_order_items__order_items"
[0m12:51:52.271235 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_orders__orders
[0m12:51:52.278256 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_customers__customers"
[0m12:51:52.279216 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_payments__payments
[0m12:51:52.286195 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_orders__orders"
[0m12:51:52.288365 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m12:51:52.295651 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_payments__payments"
[0m12:51:52.296620 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m12:51:52.298614 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: BEGIN
[0m12:51:52.299612 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m12:51:52.301603 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: BEGIN
[0m12:51:52.302600 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:51:52.303598 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m12:51:52.304596 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: BEGIN
[0m12:51:52.305629 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:51:52.317657 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m12:51:52.318695 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: BEGIN
[0m12:51:52.319653 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:51:52.320651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:51:52.321687 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m12:51:52.322644 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:51:52.324641 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m12:51:52.325636 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m12:51:52.326633 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."main"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m12:51:52.327633 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m12:51:52.328630 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m12:51:52.329660 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_customers__customers__dbt_tmp"
  
    as (
      

with source as (
  select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
  from "olist"."main"."raw_customers"
)

select
  customer_id,
  customer_unique_id,
  customer_zip_code_prefix,
  customer_city,
  customer_state
from source
    );
  
  
[0m12:51:52.332620 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m12:51:52.333615 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_orders__orders__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
  from "olist"."main"."raw_orders"
)


, cleaned as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_at,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_at,
    order_delivered_customer_date::timestamp as order_delivered_customer_at,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_at,
    case 
      when order_delivered_customer_date is not null 
      then (order_delivered_customer_date::timestamp - order_purchase_timestamp::timestamp).days
      else null 
    end as days_to_delivery,
    case
      when order_delivered_customer_date > order_estimated_delivery_date then true
      else false
    end as is_late_delivery
  from source
)

select * from cleaned
    );
  
  
[0m12:51:52.335610 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_payments__payments__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
  from "olist"."main"."raw_order_payments"
)

select * from source
    );
  
  
[0m12:51:52.401504 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (execute): 12:51:52.280213 => 12:51:52.400507
[0m12:51:52.402502 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: ROLLBACK
[0m12:51:52.408488 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (execute): 12:51:52.204913 => 12:51:52.408488
[0m12:51:52.410480 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: ROLLBACK
[0m12:51:52.413133 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (execute): 12:51:52.272233 => 12:51:52.412476
[0m12:51:52.417243 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (execute): 12:51:52.289358 => 12:51:52.417167
[0m12:51:52.418243 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: ROLLBACK
[0m12:51:52.420240 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: ROLLBACK
[0m12:51:52.430245 [debug] [Thread-3 (]: Failed to rollback 'model.olist_project.stg_orders__orders'
[0m12:51:52.433204 [debug] [Thread-4 (]: Failed to rollback 'model.olist_project.stg_payments__payments'
[0m12:51:52.436230 [debug] [Thread-2 (]: Failed to rollback 'model.olist_project.stg_order_items__order_items'
[0m12:51:52.438314 [debug] [Thread-1 (]: Failed to rollback 'model.olist_project.stg_customers__customers'
[0m12:51:52.439276 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: Close
[0m12:51:52.440279 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: Close
[0m12:51:52.441270 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: Close
[0m12:51:52.442268 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: Close
[0m12:51:52.453167 [debug] [Thread-3 (]: Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "information_schema.tables"?
  LINE 23:   from "olist"."main"."raw_orders"
                  ^
[0m12:51:52.460147 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba1381f-efa5-47c8-b455-99897f6e96df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C79A1DB50>]}
[0m12:51:52.463266 [debug] [Thread-4 (]: Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "olist.pg_catalog.pg_depend"?
  LINE 20:   from "olist"."main"."raw_order_payments"
                  ^
[0m12:51:52.468919 [debug] [Thread-2 (]: Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m12:51:52.465263 [error] [Thread-3 (]: 3 of 6 ERROR creating sql table model analytics_staging.stg_orders__orders ..... [[31mERROR[0m in 0.37s]
[0m12:51:52.470916 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba1381f-efa5-47c8-b455-99897f6e96df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C799E8ED0>]}
[0m12:51:52.473905 [debug] [Thread-1 (]: Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "information_schema.columns"?
  LINE 20:   from "olist"."main"."raw_customers"
                  ^
[0m12:51:52.474903 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba1381f-efa5-47c8-b455-99897f6e96df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C79681750>]}
[0m12:51:52.475902 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_orders__orders
[0m12:51:52.478892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba1381f-efa5-47c8-b455-99897f6e96df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C796D69D0>]}
[0m12:51:52.476898 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model analytics_staging.stg_payments__payments . [[31mERROR[0m in 0.38s]
[0m12:51:52.482882 [debug] [Thread-3 (]: Began running node model.olist_project.stg_products__products
[0m12:51:52.480888 [error] [Thread-2 (]: 2 of 6 ERROR creating sql table model analytics_staging.stg_order_items__order_items  [[31mERROR[0m in 0.39s]
[0m12:51:52.489864 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_payments__payments
[0m12:51:52.487868 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model analytics_staging.stg_customers__customers  [[31mERROR[0m in 0.40s]
[0m12:51:52.492856 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_order_items__order_items
[0m12:51:52.490861 [info ] [Thread-3 (]: 5 of 6 START sql table model analytics_staging.stg_products__products .......... [RUN]
[0m12:51:52.496854 [debug] [Thread-4 (]: Began running node model.olist_project.stg_sellers__sellers
[0m12:51:52.499837 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_customers__customers
[0m12:51:52.503826 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_orders__orders, now model.olist_project.stg_products__products)
[0m12:51:52.507818 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_products__products
[0m12:51:52.505821 [info ] [Thread-4 (]: 6 of 6 START sql table model analytics_staging.stg_sellers__sellers ............ [RUN]
[0m12:51:52.517008 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_products__products"
[0m12:51:52.520998 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_payments__payments, now model.olist_project.stg_sellers__sellers)
[0m12:51:52.522995 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_sellers__sellers
[0m12:51:52.532967 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_products__products (compile): 12:51:52.508813 => 12:51:52.531969
[0m12:51:52.534962 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_sellers__sellers"
[0m12:51:52.536958 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_products__products
[0m12:51:52.549922 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_sellers__sellers (compile): 12:51:52.524987 => 12:51:52.548925
[0m12:51:52.552913 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_products__products"
[0m12:51:52.554909 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_sellers__sellers
[0m12:51:52.565880 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_sellers__sellers"
[0m12:51:52.569868 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m12:51:52.572860 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m12:51:52.573858 [debug] [Thread-4 (]: On model.olist_project.stg_sellers__sellers: BEGIN
[0m12:51:52.575855 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: BEGIN
[0m12:51:52.576849 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:51:52.577846 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:51:52.597507 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m12:51:52.598505 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m12:51:52.600498 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m12:51:52.601496 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m12:51:52.603491 [debug] [Thread-4 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp"
  
    as (
      

with source as (
  select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
  from "olist"."main"."raw_sellers"
)

select * from source
    );
  
  
[0m12:51:52.605486 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_products__products__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."main"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m12:51:52.687516 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_sellers__sellers (execute): 12:51:52.556903 => 12:51:52.686358
[0m12:51:52.689512 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_products__products (execute): 12:51:52.538952 => 12:51:52.688513
[0m12:51:52.691539 [debug] [Thread-4 (]: On model.olist_project.stg_sellers__sellers: ROLLBACK
[0m12:51:52.692738 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: ROLLBACK
[0m12:51:52.700717 [debug] [Thread-4 (]: Failed to rollback 'model.olist_project.stg_sellers__sellers'
[0m12:51:52.701716 [debug] [Thread-4 (]: On model.olist_project.stg_sellers__sellers: Close
[0m12:51:52.706699 [debug] [Thread-3 (]: Failed to rollback 'model.olist_project.stg_products__products'
[0m12:51:52.711687 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: Close
[0m12:51:52.722458 [debug] [Thread-4 (]: Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 19:   from "olist"."main"."raw_sellers"
                  ^
[0m12:51:52.724453 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba1381f-efa5-47c8-b455-99897f6e96df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C784BA750>]}
[0m12:51:52.728443 [debug] [Thread-3 (]: Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m12:51:52.731434 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba1381f-efa5-47c8-b455-99897f6e96df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C79A4C990>]}
[0m12:51:52.730439 [error] [Thread-4 (]: 6 of 6 ERROR creating sql table model analytics_staging.stg_sellers__sellers ... [[31mERROR[0m in 0.21s]
[0m12:51:52.736421 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_sellers__sellers
[0m12:51:52.733430 [error] [Thread-3 (]: 5 of 6 ERROR creating sql table model analytics_staging.stg_products__products . [[31mERROR[0m in 0.23s]
[0m12:51:52.739415 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_products__products
[0m12:51:52.742407 [debug] [MainThread]: Using duckdb connection "master"
[0m12:51:52.744400 [debug] [MainThread]: On master: BEGIN
[0m12:51:52.745399 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:51:52.762353 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:51:52.764351 [debug] [MainThread]: On master: COMMIT
[0m12:51:52.765345 [debug] [MainThread]: Using duckdb connection "master"
[0m12:51:52.767339 [debug] [MainThread]: On master: COMMIT
[0m12:51:52.769334 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:51:52.771331 [debug] [MainThread]: On master: Close
[0m12:51:52.778311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:52.779307 [debug] [MainThread]: Connection 'create_olist_analytics_staging' was properly closed.
[0m12:51:52.780306 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m12:51:52.782300 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m12:51:52.783296 [debug] [MainThread]: Connection 'model.olist_project.stg_customers__customers' was properly closed.
[0m12:51:52.784296 [debug] [MainThread]: Connection 'model.olist_project.stg_order_items__order_items' was properly closed.
[0m12:51:52.787287 [debug] [MainThread]: Connection 'model.olist_project.stg_products__products' was properly closed.
[0m12:51:52.789280 [debug] [MainThread]: Connection 'model.olist_project.stg_sellers__sellers' was properly closed.
[0m12:51:52.791313 [info ] [MainThread]: 
[0m12:51:52.791313 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m12:51:52.791313 [debug] [MainThread]: Command end result
[0m12:51:52.822836 [info ] [MainThread]: 
[0m12:51:52.826825 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m12:51:52.828821 [info ] [MainThread]: 
[0m12:51:52.830814 [error] [MainThread]:   Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "information_schema.tables"?
  LINE 23:   from "olist"."main"."raw_orders"
                  ^
[0m12:51:52.834804 [info ] [MainThread]: 
[0m12:51:52.836801 [error] [MainThread]:   Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "olist.pg_catalog.pg_depend"?
  LINE 20:   from "olist"."main"."raw_order_payments"
                  ^
[0m12:51:52.842890 [info ] [MainThread]: 
[0m12:51:52.844884 [error] [MainThread]:   Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m12:51:52.847876 [info ] [MainThread]: 
[0m12:51:52.849871 [error] [MainThread]:   Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "information_schema.columns"?
  LINE 20:   from "olist"."main"."raw_customers"
                  ^
[0m12:51:52.854876 [info ] [MainThread]: 
[0m12:51:52.856852 [error] [MainThread]:   Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 19:   from "olist"."main"."raw_sellers"
                  ^
[0m12:51:52.860842 [info ] [MainThread]: 
[0m12:51:52.862846 [error] [MainThread]:   Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m12:51:52.870585 [info ] [MainThread]: 
[0m12:51:52.873578 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m12:51:52.877569 [debug] [MainThread]: Command `dbt run` failed at 12:51:52.876570 after 2.42 seconds
[0m12:51:52.878564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C75746790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C716A9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C716A9DD0>]}
[0m12:51:52.880559 [debug] [MainThread]: Flushing usage events
[0m13:06:22.770363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C1444610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C0280450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C0BC8110>]}


============================== 13:06:22.770363 | eb915524-e4f5-471b-b2c3-6fce9f5db19c ==============================
[0m13:06:22.770363 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:06:22.782493 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m13:06:23.190252 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:06:23.193273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eb915524-e4f5-471b-b2c3-6fce9f5db19c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C1430A10>]}
[0m13:06:23.404835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb915524-e4f5-471b-b2c3-6fce9f5db19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C14BD590>]}
[0m13:06:23.586495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb915524-e4f5-471b-b2c3-6fce9f5db19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C0C4B9D0>]}
[0m13:06:23.588526 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m13:06:23.614283 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m13:06:23.881864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m13:06:23.884857 [debug] [MainThread]: Partial parsing: updated file: olist_project://models\staging\stg_payments__payments.sql
[0m13:06:23.886066 [debug] [MainThread]: Partial parsing: updated file: olist_project://models\staging\stg_products__products.sql
[0m13:06:23.888062 [debug] [MainThread]: Partial parsing: updated file: olist_project://models\staging\stg_customers__customers.sql
[0m13:06:23.890058 [debug] [MainThread]: Partial parsing: updated file: olist_project://models\staging\stg_order_items__order_items.sql
[0m13:06:23.894048 [debug] [MainThread]: Partial parsing: updated file: olist_project://models\staging\stg_sellers__sellers.sql
[0m13:06:23.896042 [debug] [MainThread]: Partial parsing: updated file: olist_project://models\staging\stg_orders__orders.sql
[0m13:06:24.360870 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m13:06:24.376053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb915524-e4f5-471b-b2c3-6fce9f5db19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C2629E50>]}
[0m13:06:24.403984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb915524-e4f5-471b-b2c3-6fce9f5db19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C27F0190>]}
[0m13:06:24.405979 [info ] [MainThread]: Found 9 seeds, 6 models, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m13:06:24.407976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb915524-e4f5-471b-b2c3-6fce9f5db19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C274C910>]}
[0m13:06:24.414954 [info ] [MainThread]: 
[0m13:06:24.417948 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:06:24.421937 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m13:06:24.455016 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m13:06:24.456013 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"olist"'
    
  
  
[0m13:06:24.456013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:24.503966 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:06:24.506959 [debug] [ThreadPool]: On list_olist: Close
[0m13:06:24.512942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_analytics_staging)
[0m13:06:24.514937 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "analytics_staging"
"
[0m13:06:24.527901 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:06:24.528899 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
        select type from duckdb_databases()
        where database_name='olist'
        and type='sqlite'
    
  
[0m13:06:24.529896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:06:24.548631 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:06:24.552619 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:06:24.553617 [debug] [ThreadPool]: On create_olist_analytics_staging: BEGIN
[0m13:06:24.555612 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:06:24.557607 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:06:24.558603 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
    
        create schema if not exists "olist"."analytics_staging"
    
[0m13:06:24.561596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:06:24.563762 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m13:06:24.565757 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:06:24.566756 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m13:06:24.567751 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:06:24.568750 [debug] [ThreadPool]: On create_olist_analytics_staging: Close
[0m13:06:24.577726 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m13:06:24.578722 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m13:06:24.594683 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:06:24.602657 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:06:24.605652 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m13:06:24.606648 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m13:06:24.608645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:24.610637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:24.623673 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:06:24.625666 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:06:24.626662 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:06:24.627667 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:06:24.628657 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m13:06:24.630653 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m13:06:24.725849 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:06:24.727844 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m13:06:24.729838 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:06:24.732829 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m13:06:24.734824 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m13:06:24.735822 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m13:06:24.736821 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m13:06:24.740947 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m13:06:24.741984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb915524-e4f5-471b-b2c3-6fce9f5db19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C2794B90>]}
[0m13:06:24.741984 [debug] [MainThread]: Using duckdb connection "master"
[0m13:06:24.741984 [debug] [MainThread]: On master: BEGIN
[0m13:06:24.750408 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:06:24.768060 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:06:24.770055 [debug] [MainThread]: On master: COMMIT
[0m13:06:24.772048 [debug] [MainThread]: Using duckdb connection "master"
[0m13:06:24.774043 [debug] [MainThread]: On master: COMMIT
[0m13:06:24.775041 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:06:24.777036 [debug] [MainThread]: On master: Close
[0m13:06:24.781027 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:06:24.783019 [info ] [MainThread]: 
[0m13:06:24.790001 [debug] [Thread-1 (]: Began running node model.olist_project.stg_customers__customers
[0m13:06:24.791996 [debug] [Thread-2 (]: Began running node model.olist_project.stg_order_items__order_items
[0m13:06:24.793990 [debug] [Thread-3 (]: Began running node model.olist_project.stg_orders__orders
[0m13:06:24.794991 [debug] [Thread-4 (]: Began running node model.olist_project.stg_payments__payments
[0m13:06:24.797983 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_customers__customers ........ [RUN]
[0m13:06:24.799974 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_order_items__order_items .... [RUN]
[0m13:06:24.801970 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_orders__orders .............. [RUN]
[0m13:06:24.805958 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_project.stg_customers__customers'
[0m13:06:24.803964 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_staging.stg_payments__payments .......... [RUN]
[0m13:06:24.808953 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_project.stg_order_items__order_items'
[0m13:06:24.812848 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_project.stg_orders__orders'
[0m13:06:24.814844 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_customers__customers
[0m13:06:24.816992 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_project.stg_payments__payments'
[0m13:06:24.818989 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_order_items__order_items
[0m13:06:24.820983 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_orders__orders
[0m13:06:24.844494 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_customers__customers"
[0m13:06:24.847484 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_payments__payments
[0m13:06:24.858458 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_order_items__order_items"
[0m13:06:24.867619 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_orders__orders"
[0m13:06:24.876595 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_payments__payments"
[0m13:06:24.879587 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (compile): 13:06:24.822978 => 13:06:24.878589
[0m13:06:24.882578 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (compile): 13:06:24.848482 => 13:06:24.881581
[0m13:06:24.884572 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_customers__customers
[0m13:06:24.886575 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (compile): 13:06:24.859454 => 13:06:24.885574
[0m13:06:24.888704 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (compile): 13:06:24.868616 => 13:06:24.887703
[0m13:06:24.889701 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_order_items__order_items
[0m13:06:24.955808 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_customers__customers"
[0m13:06:24.956802 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_orders__orders
[0m13:06:24.957799 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_payments__payments
[0m13:06:24.969120 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_order_items__order_items"
[0m13:06:24.979094 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_orders__orders"
[0m13:06:24.988071 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_payments__payments"
[0m13:06:24.989068 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:06:24.992059 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:06:24.994054 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: BEGIN
[0m13:06:24.996048 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:06:24.998043 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: BEGIN
[0m13:06:24.999041 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:06:25.000040 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:06:25.002035 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: BEGIN
[0m13:06:25.003033 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:06:25.005024 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: BEGIN
[0m13:06:25.019438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:06:25.021434 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:06:25.023426 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:06:25.025421 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:06:25.028413 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:06:25.030406 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:06:25.032401 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:06:25.034396 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_customers__customers__dbt_tmp"
  
    as (
      

with source as (
  select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
  from main.raw_customers
)

select
  customer_id,
  customer_unique_id,
  customer_zip_code_prefix,
  customer_city,
  customer_state
from source
    );
  
  
[0m13:06:25.036392 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:06:25.037500 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:06:25.038498 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from main.raw_order_items
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m13:06:25.041634 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:06:25.043630 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_orders__orders__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
  from main.raw_orders
)


, cleaned as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_at,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_at,
    order_delivered_customer_date::timestamp as order_delivered_customer_at,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_at,
    case 
      when order_delivered_customer_date is not null 
      then (order_delivered_customer_date::timestamp - order_purchase_timestamp::timestamp).days
      else null 
    end as days_to_delivery,
    case
      when order_delivered_customer_date > order_estimated_delivery_date then true
      else false
    end as is_late_delivery
  from source
)

select * from cleaned
    );
  
  
[0m13:06:25.046620 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_payments__payments__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
  from main.raw_order_payments
)

select * from source
    );
  
  
[0m13:06:25.124119 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (execute): 13:06:24.970118 => 13:06:25.123122
[0m13:06:25.126115 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (execute): 13:06:24.958797 => 13:06:25.125116
[0m13:06:25.128110 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (execute): 13:06:24.890932 => 13:06:25.127111
[0m13:06:25.130103 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (execute): 13:06:24.980092 => 13:06:25.130103
[0m13:06:25.131100 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: ROLLBACK
[0m13:06:25.133094 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: ROLLBACK
[0m13:06:25.135090 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: ROLLBACK
[0m13:06:25.136086 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: ROLLBACK
[0m13:06:25.166023 [debug] [Thread-2 (]: Failed to rollback 'model.olist_project.stg_order_items__order_items'
[0m13:06:25.169158 [debug] [Thread-3 (]: Failed to rollback 'model.olist_project.stg_orders__orders'
[0m13:06:25.173150 [debug] [Thread-1 (]: Failed to rollback 'model.olist_project.stg_customers__customers'
[0m13:06:25.176139 [debug] [Thread-4 (]: Failed to rollback 'model.olist_project.stg_payments__payments'
[0m13:06:25.177136 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: Close
[0m13:06:25.178134 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: Close
[0m13:06:25.179131 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: Close
[0m13:06:25.180129 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: Close
[0m13:06:25.192482 [debug] [Thread-2 (]: Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m13:06:25.203456 [debug] [Thread-3 (]: Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "information_schema.tables"?
  LINE 23:   from main.raw_orders
                  ^
[0m13:06:25.204450 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb915524-e4f5-471b-b2c3-6fce9f5db19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C298E810>]}
[0m13:06:25.207444 [debug] [Thread-1 (]: Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "information_schema.columns"?
  LINE 20:   from main.raw_customers
                  ^
[0m13:06:25.208440 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb915524-e4f5-471b-b2c3-6fce9f5db19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C29AB7D0>]}
[0m13:06:25.213426 [debug] [Thread-4 (]: Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "olist.pg_catalog.pg_depend"?
  LINE 20:   from main.raw_order_payments
                  ^
[0m13:06:25.210436 [error] [Thread-2 (]: 2 of 6 ERROR creating sql table model analytics_staging.stg_order_items__order_items  [[31mERROR[0m in 0.40s]
[0m13:06:25.215421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb915524-e4f5-471b-b2c3-6fce9f5db19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C27DB710>]}
[0m13:06:25.217416 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb915524-e4f5-471b-b2c3-6fce9f5db19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C2A2F4D0>]}
[0m13:06:25.216419 [error] [Thread-3 (]: 3 of 6 ERROR creating sql table model analytics_staging.stg_orders__orders ..... [[31mERROR[0m in 0.40s]
[0m13:06:25.220412 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_order_items__order_items
[0m13:06:25.222403 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model analytics_staging.stg_customers__customers  [[31mERROR[0m in 0.41s]
[0m13:06:25.227390 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_orders__orders
[0m13:06:25.224397 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model analytics_staging.stg_payments__payments . [[31mERROR[0m in 0.40s]
[0m13:06:25.229385 [debug] [Thread-2 (]: Began running node model.olist_project.stg_products__products
[0m13:06:25.237363 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_customers__customers
[0m13:06:25.239358 [debug] [Thread-3 (]: Began running node model.olist_project.stg_sellers__sellers
[0m13:06:25.242349 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_payments__payments
[0m13:06:25.244344 [info ] [Thread-2 (]: 5 of 6 START sql table model analytics_staging.stg_products__products .......... [RUN]
[0m13:06:25.253321 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_order_items__order_items, now model.olist_project.stg_products__products)
[0m13:06:25.248335 [info ] [Thread-3 (]: 6 of 6 START sql table model analytics_staging.stg_sellers__sellers ............ [RUN]
[0m13:06:25.254319 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_products__products
[0m13:06:25.257311 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_orders__orders, now model.olist_project.stg_sellers__sellers)
[0m13:06:25.268280 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_products__products"
[0m13:06:25.269277 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_sellers__sellers
[0m13:06:25.283241 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_sellers__sellers"
[0m13:06:25.286238 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_products__products (compile): 13:06:25.257311 => 13:06:25.285239
[0m13:06:25.288228 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_sellers__sellers (compile): 13:06:25.272269 => 13:06:25.287229
[0m13:06:25.289224 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_products__products
[0m13:06:25.291220 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_sellers__sellers
[0m13:06:25.309173 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_products__products"
[0m13:06:25.322136 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_sellers__sellers"
[0m13:06:25.325129 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:06:25.326125 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: BEGIN
[0m13:06:25.327125 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:06:25.329118 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:06:25.332112 [debug] [Thread-3 (]: On model.olist_project.stg_sellers__sellers: BEGIN
[0m13:06:25.346336 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:06:25.348331 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:06:25.350327 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:06:25.353317 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:06:25.353317 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_products__products__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from main.raw_product_category_translation
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m13:06:25.355311 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:06:25.357308 [debug] [Thread-3 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp"
  
    as (
      

with source as (
  select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
  from main.raw_sellers
)

select * from source
    );
  
  
[0m13:06:25.420942 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_products__products (execute): 13:06:25.292218 => 13:06:25.419945
[0m13:06:25.421941 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: ROLLBACK
[0m13:06:25.423934 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_sellers__sellers (execute): 13:06:25.310168 => 13:06:25.423934
[0m13:06:25.426926 [debug] [Thread-3 (]: On model.olist_project.stg_sellers__sellers: ROLLBACK
[0m13:06:25.433907 [debug] [Thread-2 (]: Failed to rollback 'model.olist_project.stg_products__products'
[0m13:06:25.434905 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: Close
[0m13:06:25.441888 [debug] [Thread-3 (]: Failed to rollback 'model.olist_project.stg_sellers__sellers'
[0m13:06:25.442884 [debug] [Thread-3 (]: On model.olist_project.stg_sellers__sellers: Close
[0m13:06:25.452857 [debug] [Thread-2 (]: Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "temp.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m13:06:25.453856 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb915524-e4f5-471b-b2c3-6fce9f5db19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C2B11C50>]}
[0m13:06:25.457843 [debug] [Thread-3 (]: Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "information_schema.tables"?
  LINE 19:   from main.raw_sellers
                  ^
[0m13:06:25.459839 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb915524-e4f5-471b-b2c3-6fce9f5db19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C2B11B10>]}
[0m13:06:25.458842 [error] [Thread-2 (]: 5 of 6 ERROR creating sql table model analytics_staging.stg_products__products . [[31mERROR[0m in 0.20s]
[0m13:06:25.464020 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_products__products
[0m13:06:25.462024 [error] [Thread-3 (]: 6 of 6 ERROR creating sql table model analytics_staging.stg_sellers__sellers ... [[31mERROR[0m in 0.20s]
[0m13:06:25.467158 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_sellers__sellers
[0m13:06:25.471149 [debug] [MainThread]: Using duckdb connection "master"
[0m13:06:25.473144 [debug] [MainThread]: On master: BEGIN
[0m13:06:25.475139 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:06:25.493633 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:06:25.493633 [debug] [MainThread]: On master: COMMIT
[0m13:06:25.496915 [debug] [MainThread]: Using duckdb connection "master"
[0m13:06:25.501292 [debug] [MainThread]: On master: COMMIT
[0m13:06:25.503286 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:06:25.505281 [debug] [MainThread]: On master: Close
[0m13:06:25.512462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:06:25.515457 [debug] [MainThread]: Connection 'create_olist_analytics_staging' was properly closed.
[0m13:06:25.516485 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m13:06:25.516485 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m13:06:25.516485 [debug] [MainThread]: Connection 'model.olist_project.stg_customers__customers' was properly closed.
[0m13:06:25.520504 [debug] [MainThread]: Connection 'model.olist_project.stg_products__products' was properly closed.
[0m13:06:25.520504 [debug] [MainThread]: Connection 'model.olist_project.stg_sellers__sellers' was properly closed.
[0m13:06:25.520504 [debug] [MainThread]: Connection 'model.olist_project.stg_payments__payments' was properly closed.
[0m13:06:25.520504 [info ] [MainThread]: 
[0m13:06:25.520504 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m13:06:25.532920 [debug] [MainThread]: Command end result
[0m13:06:25.621932 [info ] [MainThread]: 
[0m13:06:25.623928 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m13:06:25.624924 [info ] [MainThread]: 
[0m13:06:25.626919 [error] [MainThread]:   Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m13:06:25.629911 [info ] [MainThread]: 
[0m13:06:25.631907 [error] [MainThread]:   Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "information_schema.tables"?
  LINE 23:   from main.raw_orders
                  ^
[0m13:06:25.636893 [info ] [MainThread]: 
[0m13:06:25.638887 [error] [MainThread]:   Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "information_schema.columns"?
  LINE 20:   from main.raw_customers
                  ^
[0m13:06:25.642876 [info ] [MainThread]: 
[0m13:06:25.647864 [error] [MainThread]:   Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "olist.pg_catalog.pg_depend"?
  LINE 20:   from main.raw_order_payments
                  ^
[0m13:06:25.649859 [info ] [MainThread]: 
[0m13:06:25.651853 [error] [MainThread]:   Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "temp.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m13:06:25.654847 [info ] [MainThread]: 
[0m13:06:25.657837 [error] [MainThread]:   Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "information_schema.tables"?
  LINE 19:   from main.raw_sellers
                  ^
[0m13:06:25.660830 [info ] [MainThread]: 
[0m13:06:25.664818 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m13:06:25.668807 [debug] [MainThread]: Command `dbt run` failed at 13:06:25.667810 after 3.07 seconds
[0m13:06:25.669804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5BA699F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5BA699A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5C27098D0>]}
[0m13:06:25.671801 [debug] [MainThread]: Flushing usage events
[0m13:12:54.236274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944A449BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944A28BE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944A44B650>]}


============================== 13:12:54.245248 | c546ce47-0ded-4d0f-b43f-ac606ce312dc ==============================
[0m13:12:54.245248 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:12:54.245248 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m13:12:54.533301 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:12:54.535295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c546ce47-0ded-4d0f-b43f-ac606ce312dc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019449C54610>]}
[0m13:12:54.760469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c546ce47-0ded-4d0f-b43f-ac606ce312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944A4E7E90>]}
[0m13:12:54.955605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c546ce47-0ded-4d0f-b43f-ac606ce312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944A58FC90>]}
[0m13:12:54.957601 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m13:12:54.994504 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m13:12:56.731037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:56.732034 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:56.738151 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m13:12:56.762728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c546ce47-0ded-4d0f-b43f-ac606ce312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944B81E0D0>]}
[0m13:12:56.887961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c546ce47-0ded-4d0f-b43f-ac606ce312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944B658E10>]}
[0m13:12:56.888959 [info ] [MainThread]: Found 9 seeds, 6 models, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m13:12:56.890954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c546ce47-0ded-4d0f-b43f-ac606ce312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944B71F890>]}
[0m13:12:56.895940 [info ] [MainThread]: 
[0m13:12:56.899931 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:12:56.906914 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m13:12:56.938825 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m13:12:56.940822 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"olist"'
    
  
  
[0m13:12:56.941818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:56.977272 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:12:56.979272 [debug] [ThreadPool]: On list_olist: Close
[0m13:12:56.984258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_analytics_staging)
[0m13:12:56.987251 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "analytics_staging"
"
[0m13:12:57.001212 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:12:57.002211 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
        select type from duckdb_databases()
        where database_name='olist'
        and type='sqlite'
    
  
[0m13:12:57.003206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:57.024748 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:12:57.027738 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:12:57.028736 [debug] [ThreadPool]: On create_olist_analytics_staging: BEGIN
[0m13:12:57.029733 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:12:57.030731 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:12:57.032726 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
    
        create schema if not exists "olist"."analytics_staging"
    
[0m13:12:57.034720 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:12:57.037713 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m13:12:57.039709 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:12:57.040705 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m13:12:57.041703 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:12:57.042700 [debug] [ThreadPool]: On create_olist_analytics_staging: Close
[0m13:12:57.048683 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m13:12:57.049681 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m13:12:57.059654 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:12:57.063642 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:12:57.064640 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m13:12:57.065637 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m13:12:57.066635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:57.067632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:57.080674 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:12:57.081671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:12:57.082670 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:12:57.083668 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:12:57.085662 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m13:12:57.087657 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m13:12:57.167564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:12:57.170559 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m13:12:57.171554 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:12:57.174544 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m13:12:57.193647 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m13:12:57.193647 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m13:12:57.194644 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m13:12:57.195641 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m13:12:57.201626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c546ce47-0ded-4d0f-b43f-ac606ce312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944B623E90>]}
[0m13:12:57.202624 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:57.204619 [debug] [MainThread]: On master: BEGIN
[0m13:12:57.205614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:57.225698 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:12:57.226696 [debug] [MainThread]: On master: COMMIT
[0m13:12:57.228692 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:57.229688 [debug] [MainThread]: On master: COMMIT
[0m13:12:57.231682 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:12:57.232682 [debug] [MainThread]: On master: Close
[0m13:12:57.237667 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:12:57.239660 [info ] [MainThread]: 
[0m13:12:57.246028 [debug] [Thread-1 (]: Began running node model.olist_project.stg_customers__customers
[0m13:12:57.246028 [debug] [Thread-2 (]: Began running node model.olist_project.stg_order_items__order_items
[0m13:12:57.247026 [debug] [Thread-3 (]: Began running node model.olist_project.stg_orders__orders
[0m13:12:57.248024 [debug] [Thread-4 (]: Began running node model.olist_project.stg_payments__payments
[0m13:12:57.248024 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_customers__customers ........ [RUN]
[0m13:12:57.250020 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_order_items__order_items .... [RUN]
[0m13:12:57.257002 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_project.stg_customers__customers'
[0m13:12:57.252015 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_orders__orders .............. [RUN]
[0m13:12:57.259992 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_project.stg_order_items__order_items'
[0m13:12:57.255005 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_staging.stg_payments__payments .......... [RUN]
[0m13:12:57.261987 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_customers__customers
[0m13:12:57.263981 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_project.stg_orders__orders'
[0m13:12:57.264979 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_order_items__order_items
[0m13:12:57.266974 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_project.stg_payments__payments'
[0m13:12:57.291907 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_customers__customers"
[0m13:12:57.305873 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (compile): 13:12:57.268969 => 13:12:57.304873
[0m13:12:57.292905 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_orders__orders
[0m13:12:57.301879 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_payments__payments
[0m13:12:57.299885 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_order_items__order_items"
[0m13:12:57.308862 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_customers__customers
[0m13:12:57.318720 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_orders__orders"
[0m13:12:57.328693 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_payments__payments"
[0m13:12:57.384543 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_customers__customers"
[0m13:12:57.385539 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (compile): 13:12:57.294899 => 13:12:57.385539
[0m13:12:57.388676 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (compile): 13:12:57.309862 => 13:12:57.387678
[0m13:12:57.389674 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_order_items__order_items
[0m13:12:57.391705 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (compile): 13:12:57.319718 => 13:12:57.390671
[0m13:12:57.391705 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:12:57.393232 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_orders__orders
[0m13:12:57.402594 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_order_items__order_items"
[0m13:12:57.403598 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_payments__payments
[0m13:12:57.405586 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: BEGIN
[0m13:12:57.410568 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_orders__orders"
[0m13:12:57.418546 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_payments__payments"
[0m13:12:57.420543 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:12:57.421543 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:12:57.438495 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:12:57.439506 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: BEGIN
[0m13:12:57.440621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:12:57.441620 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:12:57.442554 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: BEGIN
[0m13:12:57.443555 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:12:57.444554 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:12:57.445549 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: BEGIN
[0m13:12:57.446546 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:12:57.448542 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:12:57.448542 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_customers__customers__dbt_tmp"
  
    as (
      

with source as (
  select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
  from main.raw_customers
)

select
  customer_id,
  customer_unique_id,
  customer_zip_code_prefix,
  customer_city,
  customer_state
from source
    );
  
  
[0m13:12:57.449540 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:12:57.451534 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:12:57.452533 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:12:57.455660 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:12:57.456658 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:12:57.457655 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from main.raw_order_items
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m13:12:57.459650 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:12:57.460648 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_orders__orders__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
  from main.raw_orders
)


, cleaned as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_at,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_at,
    order_delivered_customer_date::timestamp as order_delivered_customer_at,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_at,
    case 
      when order_delivered_customer_date is not null 
      then (order_delivered_customer_date::timestamp - order_purchase_timestamp::timestamp).days
      else null 
    end as days_to_delivery,
    case
      when order_delivered_customer_date > order_estimated_delivery_date then true
      else false
    end as is_late_delivery
  from source
)

select * from cleaned
    );
  
  
[0m13:12:57.462763 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_payments__payments__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
  from main.raw_order_payments
)

select * from source
    );
  
  
[0m13:12:57.547215 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (execute): 13:12:57.412564 => 13:12:57.547215
[0m13:12:57.549213 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (execute): 13:12:57.393232 => 13:12:57.548216
[0m13:12:57.550210 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (execute): 13:12:57.330688 => 13:12:57.549213
[0m13:12:57.551207 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (execute): 13:12:57.405586 => 13:12:57.550210
[0m13:12:57.552205 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: ROLLBACK
[0m13:12:57.553202 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: ROLLBACK
[0m13:12:57.554202 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: ROLLBACK
[0m13:12:57.555197 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: ROLLBACK
[0m13:12:57.758727 [debug] [Thread-4 (]: Failed to rollback 'model.olist_project.stg_payments__payments'
[0m13:12:57.761777 [debug] [Thread-2 (]: Failed to rollback 'model.olist_project.stg_order_items__order_items'
[0m13:12:57.764770 [debug] [Thread-3 (]: Failed to rollback 'model.olist_project.stg_orders__orders'
[0m13:12:57.765895 [debug] [Thread-1 (]: Failed to rollback 'model.olist_project.stg_customers__customers'
[0m13:12:57.766931 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: Close
[0m13:12:57.767891 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: Close
[0m13:12:57.768925 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: Close
[0m13:12:57.769886 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: Close
[0m13:12:57.785844 [debug] [Thread-4 (]: Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "pg_catalog.pg_depend"?
  LINE 20:   from main.raw_order_payments
                  ^
[0m13:12:57.789975 [debug] [Thread-2 (]: Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m13:12:57.790972 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c546ce47-0ded-4d0f-b43f-ac606ce312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944B8C83D0>]}
[0m13:12:57.792171 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c546ce47-0ded-4d0f-b43f-ac606ce312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944B8C8A50>]}
[0m13:12:57.795166 [debug] [Thread-3 (]: Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "information_schema.tables"?
  LINE 23:   from main.raw_orders
                  ^
[0m13:12:57.797194 [debug] [Thread-1 (]: Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "temp.information_schema.columns"?
  LINE 20:   from main.raw_customers
                  ^
[0m13:12:57.798171 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model analytics_staging.stg_payments__payments . [[31mERROR[0m in 0.52s]
[0m13:12:57.801147 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c546ce47-0ded-4d0f-b43f-ac606ce312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944B623F90>]}
[0m13:12:57.800187 [error] [Thread-2 (]: 2 of 6 ERROR creating sql table model analytics_staging.stg_order_items__order_items  [[31mERROR[0m in 0.53s]
[0m13:12:57.802319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c546ce47-0ded-4d0f-b43f-ac606ce312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944B9156D0>]}
[0m13:12:57.804319 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_payments__payments
[0m13:12:57.808308 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_order_items__order_items
[0m13:12:57.806312 [error] [Thread-3 (]: 3 of 6 ERROR creating sql table model analytics_staging.stg_orders__orders ..... [[31mERROR[0m in 0.54s]
[0m13:12:57.812300 [debug] [Thread-4 (]: Began running node model.olist_project.stg_products__products
[0m13:12:57.810302 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model analytics_staging.stg_customers__customers  [[31mERROR[0m in 0.55s]
[0m13:12:57.815290 [debug] [Thread-2 (]: Began running node model.olist_project.stg_sellers__sellers
[0m13:12:57.817285 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_orders__orders
[0m13:12:57.822270 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_customers__customers
[0m13:12:57.819279 [info ] [Thread-4 (]: 5 of 6 START sql table model analytics_staging.stg_products__products .......... [RUN]
[0m13:12:57.824265 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics_staging.stg_sellers__sellers ............ [RUN]
[0m13:12:57.828254 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_payments__payments, now model.olist_project.stg_products__products)
[0m13:12:57.830249 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_order_items__order_items, now model.olist_project.stg_sellers__sellers)
[0m13:12:57.832245 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_products__products
[0m13:12:57.833241 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_sellers__sellers
[0m13:12:57.842217 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_products__products"
[0m13:12:57.852192 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_sellers__sellers"
[0m13:12:57.854185 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_products__products (compile): 13:12:57.834239 => 13:12:57.853191
[0m13:12:57.857176 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_sellers__sellers (compile): 13:12:57.844213 => 13:12:57.856179
[0m13:12:57.860169 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_sellers__sellers
[0m13:12:57.858173 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_products__products
[0m13:12:57.873136 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_sellers__sellers"
[0m13:12:57.886101 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_products__products"
[0m13:12:57.889091 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:12:57.891090 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: BEGIN
[0m13:12:57.893084 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:12:57.908039 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:12:57.909039 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:12:57.910036 [debug] [Thread-4 (]: On model.olist_project.stg_products__products: BEGIN
[0m13:12:57.911032 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:12:57.912029 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:12:57.913027 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp"
  
    as (
      

with source as (
  select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
  from main.raw_sellers
)

select * from source
    );
  
  
[0m13:12:57.915022 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:12:57.917016 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:12:57.918015 [debug] [Thread-4 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_products__products__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from main.raw_product_category_translation
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m13:12:57.970873 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_sellers__sellers (execute): 13:12:57.862164 => 13:12:57.969876
[0m13:12:57.971871 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: ROLLBACK
[0m13:12:57.973865 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_products__products (execute): 13:12:57.875128 => 13:12:57.972867
[0m13:12:57.976857 [debug] [Thread-4 (]: On model.olist_project.stg_products__products: ROLLBACK
[0m13:12:57.982841 [debug] [Thread-2 (]: Failed to rollback 'model.olist_project.stg_sellers__sellers'
[0m13:12:57.983837 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: Close
[0m13:12:57.987935 [debug] [Thread-4 (]: Failed to rollback 'model.olist_project.stg_products__products'
[0m13:12:57.988932 [debug] [Thread-4 (]: On model.olist_project.stg_products__products: Close
[0m13:12:57.996143 [debug] [Thread-2 (]: Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "information_schema.tables"?
  LINE 19:   from main.raw_sellers
                  ^
[0m13:12:57.997140 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c546ce47-0ded-4d0f-b43f-ac606ce312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944B8C9590>]}
[0m13:12:58.000133 [debug] [Thread-4 (]: Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m13:12:58.002130 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c546ce47-0ded-4d0f-b43f-ac606ce312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001944B927A50>]}
[0m13:12:58.001130 [error] [Thread-2 (]: 6 of 6 ERROR creating sql table model analytics_staging.stg_sellers__sellers ... [[31mERROR[0m in 0.17s]
[0m13:12:58.006117 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_sellers__sellers
[0m13:12:58.004122 [error] [Thread-4 (]: 5 of 6 ERROR creating sql table model analytics_staging.stg_products__products . [[31mERROR[0m in 0.17s]
[0m13:12:58.008112 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_products__products
[0m13:12:58.010106 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:58.011104 [debug] [MainThread]: On master: BEGIN
[0m13:12:58.012213 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:12:58.026300 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:12:58.027295 [debug] [MainThread]: On master: COMMIT
[0m13:12:58.029289 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:58.030287 [debug] [MainThread]: On master: COMMIT
[0m13:12:58.032281 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:12:58.033278 [debug] [MainThread]: On master: Close
[0m13:12:58.036270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:58.037265 [debug] [MainThread]: Connection 'create_olist_analytics_staging' was properly closed.
[0m13:12:58.038264 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m13:12:58.040259 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m13:12:58.042342 [debug] [MainThread]: Connection 'model.olist_project.stg_customers__customers' was properly closed.
[0m13:12:58.044340 [debug] [MainThread]: Connection 'model.olist_project.stg_sellers__sellers' was properly closed.
[0m13:12:58.045339 [debug] [MainThread]: Connection 'model.olist_project.stg_orders__orders' was properly closed.
[0m13:12:58.046333 [debug] [MainThread]: Connection 'model.olist_project.stg_products__products' was properly closed.
[0m13:12:58.049337 [info ] [MainThread]: 
[0m13:12:58.050321 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m13:12:58.054311 [debug] [MainThread]: Command end result
[0m13:12:58.078251 [info ] [MainThread]: 
[0m13:12:58.081238 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m13:12:58.084231 [info ] [MainThread]: 
[0m13:12:58.086226 [error] [MainThread]:   Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "pg_catalog.pg_depend"?
  LINE 20:   from main.raw_order_payments
                  ^
[0m13:12:58.092963 [info ] [MainThread]: 
[0m13:12:58.093984 [error] [MainThread]:   Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m13:12:58.093984 [info ] [MainThread]: 
[0m13:12:58.093984 [error] [MainThread]:   Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "information_schema.tables"?
  LINE 23:   from main.raw_orders
                  ^
[0m13:12:58.100015 [info ] [MainThread]: 
[0m13:12:58.100015 [error] [MainThread]:   Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "temp.information_schema.columns"?
  LINE 20:   from main.raw_customers
                  ^
[0m13:12:58.107628 [info ] [MainThread]: 
[0m13:12:58.109616 [error] [MainThread]:   Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "information_schema.tables"?
  LINE 19:   from main.raw_sellers
                  ^
[0m13:12:58.112735 [info ] [MainThread]: 
[0m13:12:58.114729 [error] [MainThread]:   Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m13:12:58.116850 [info ] [MainThread]: 
[0m13:12:58.118846 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m13:12:58.121838 [debug] [MainThread]: Command `dbt run` failed at 13:12:58.120839 after 4.09 seconds
[0m13:12:58.123834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019443679AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019443679990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019443679D50>]}
[0m13:12:58.128819 [debug] [MainThread]: Flushing usage events
[0m13:13:12.233415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E8B04410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E7F1B090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E8AF4FD0>]}


============================== 13:13:12.240586 | 1b99ca53-f14d-4613-b8a1-32e3f04735da ==============================
[0m13:13:12.240586 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:13:12.242547 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m13:13:12.463189 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:13:12.464148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1b99ca53-f14d-4613-b8a1-32e3f04735da', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E8AE8D50>]}
[0m13:13:12.643223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b99ca53-f14d-4613-b8a1-32e3f04735da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E8B03590>]}
[0m13:13:12.786447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b99ca53-f14d-4613-b8a1-32e3f04735da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E8C31110>]}
[0m13:13:12.789438 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m13:13:12.803400 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m13:13:12.911874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:13:12.912909 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:13:12.914869 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m13:13:12.927318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b99ca53-f14d-4613-b8a1-32e3f04735da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E9E38310>]}
[0m13:13:12.952214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b99ca53-f14d-4613-b8a1-32e3f04735da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E8B8D990>]}
[0m13:13:12.953210 [info ] [MainThread]: Found 9 seeds, 6 models, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m13:13:12.955205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b99ca53-f14d-4613-b8a1-32e3f04735da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E9DAF2D0>]}
[0m13:13:12.960196 [info ] [MainThread]: 
[0m13:13:12.962186 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:13:12.964180 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m13:13:12.994215 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m13:13:12.995214 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"olist"'
    
  
  
[0m13:13:12.997206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:13.016154 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:13:13.019149 [debug] [ThreadPool]: On list_olist: Close
[0m13:13:13.023139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_analytics_staging)
[0m13:13:13.026129 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "analytics_staging"
"
[0m13:13:13.040197 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:13:13.041196 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
        select type from duckdb_databases()
        where database_name='olist'
        and type='sqlite'
    
  
[0m13:13:13.043195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:13.055157 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:13:13.058147 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:13:13.059148 [debug] [ThreadPool]: On create_olist_analytics_staging: BEGIN
[0m13:13:13.060148 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:13:13.061142 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:13:13.062137 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
    
        create schema if not exists "olist"."analytics_staging"
    
[0m13:13:13.064133 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:13:13.067134 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m13:13:13.068122 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:13:13.070118 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m13:13:13.072111 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:13:13.073107 [debug] [ThreadPool]: On create_olist_analytics_staging: Close
[0m13:13:13.081087 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m13:13:13.083086 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m13:13:13.095049 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:13:13.098042 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:13:13.099039 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m13:13:13.100036 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m13:13:13.101077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:13.103063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:13.117074 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:13:13.118024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:13:13.119022 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:13:13.120019 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:13:13.121017 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m13:13:13.123009 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m13:13:13.208558 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:13:13.209555 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:13:13.212672 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m13:13:13.215657 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m13:13:13.217790 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m13:13:13.217790 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m13:13:13.219785 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m13:13:13.221779 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m13:13:13.226766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b99ca53-f14d-4613-b8a1-32e3f04735da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E8B7BA90>]}
[0m13:13:13.227763 [debug] [MainThread]: Using duckdb connection "master"
[0m13:13:13.228760 [debug] [MainThread]: On master: BEGIN
[0m13:13:13.229757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:13.241726 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:13:13.243720 [debug] [MainThread]: On master: COMMIT
[0m13:13:13.243720 [debug] [MainThread]: Using duckdb connection "master"
[0m13:13:13.244718 [debug] [MainThread]: On master: COMMIT
[0m13:13:13.246712 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:13:13.247708 [debug] [MainThread]: On master: Close
[0m13:13:13.250702 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:13:13.251700 [info ] [MainThread]: 
[0m13:13:13.256686 [debug] [Thread-1 (]: Began running node model.olist_project.stg_customers__customers
[0m13:13:13.257685 [debug] [Thread-2 (]: Began running node model.olist_project.stg_order_items__order_items
[0m13:13:13.258681 [debug] [Thread-3 (]: Began running node model.olist_project.stg_orders__orders
[0m13:13:13.259678 [debug] [Thread-4 (]: Began running node model.olist_project.stg_payments__payments
[0m13:13:13.260678 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_customers__customers ........ [RUN]
[0m13:13:13.262976 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_order_items__order_items .... [RUN]
[0m13:13:13.269959 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_project.stg_customers__customers'
[0m13:13:13.264972 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_orders__orders .............. [RUN]
[0m13:13:13.272952 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_project.stg_order_items__order_items'
[0m13:13:13.266967 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_staging.stg_payments__payments .......... [RUN]
[0m13:13:13.274947 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_customers__customers
[0m13:13:13.276956 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_project.stg_orders__orders'
[0m13:13:13.278934 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_order_items__order_items
[0m13:13:13.280929 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_project.stg_payments__payments'
[0m13:13:13.300877 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_customers__customers"
[0m13:13:13.301874 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_orders__orders
[0m13:13:13.310850 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_order_items__order_items"
[0m13:13:13.311846 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_payments__payments
[0m13:13:13.321822 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_orders__orders"
[0m13:13:13.323816 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (compile): 13:13:13.281927 => 13:13:13.322816
[0m13:13:13.332792 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_payments__payments"
[0m13:13:13.334785 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (compile): 13:13:13.302872 => 13:13:13.333788
[0m13:13:13.336781 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_customers__customers
[0m13:13:13.338775 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_order_items__order_items
[0m13:13:13.340771 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (compile): 13:13:13.313843 => 13:13:13.339773
[0m13:13:13.343198 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (compile): 13:13:13.324812 => 13:13:13.342285
[0m13:13:13.415512 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_customers__customers"
[0m13:13:13.422459 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_order_items__order_items"
[0m13:13:13.423454 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_orders__orders
[0m13:13:13.424454 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_payments__payments
[0m13:13:13.435458 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:13:13.434460 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_orders__orders"
[0m13:13:13.446433 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_payments__payments"
[0m13:13:13.446433 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:13:13.448387 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: BEGIN
[0m13:13:13.450382 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: BEGIN
[0m13:13:13.451380 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:13:13.452377 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:13:13.453436 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:13:13.454372 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:13:13.455370 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: BEGIN
[0m13:13:13.456365 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: BEGIN
[0m13:13:13.469928 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:13:13.470925 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:13:13.471922 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:13:13.473916 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:13:13.474950 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:13:13.475912 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:13:13.477906 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:13:13.478902 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:13:13.479900 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_customers__customers__dbt_tmp"
  
    as (
      

with source as (
  select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
  from main.raw_customers
)

select
  customer_id,
  customer_unique_id,
  customer_zip_code_prefix,
  customer_city,
  customer_state
from source
    );
  
  
[0m13:13:13.480904 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from main.raw_order_items
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m13:13:13.482893 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:13:13.483890 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:13:13.486884 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_orders__orders__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
  from main.raw_orders
)


, cleaned as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_at,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_at,
    order_delivered_customer_date::timestamp as order_delivered_customer_at,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_at,
    case 
      when order_delivered_customer_date is not null 
      then (order_delivered_customer_date::timestamp - order_purchase_timestamp::timestamp).days
      else null 
    end as days_to_delivery,
    case
      when order_delivered_customer_date > order_estimated_delivery_date then true
      else false
    end as is_late_delivery
  from source
)

select * from cleaned
    );
  
  
[0m13:13:13.487878 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_payments__payments__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
  from main.raw_order_payments
)

select * from source
    );
  
  
[0m13:13:13.551710 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (execute): 13:13:13.425462 => 13:13:13.550710
[0m13:13:13.554701 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: ROLLBACK
[0m13:13:13.558693 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (execute): 13:13:13.344197 => 13:13:13.557693
[0m13:13:13.560684 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: ROLLBACK
[0m13:13:13.569660 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (execute): 13:13:13.436420 => 13:13:13.568663
[0m13:13:13.571655 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: ROLLBACK
[0m13:13:13.574648 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (execute): 13:13:13.415512 => 13:13:13.574648
[0m13:13:13.578637 [debug] [Thread-1 (]: Failed to rollback 'model.olist_project.stg_customers__customers'
[0m13:13:13.580631 [debug] [Thread-3 (]: Failed to rollback 'model.olist_project.stg_orders__orders'
[0m13:13:13.581628 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: ROLLBACK
[0m13:13:13.582627 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: Close
[0m13:13:13.583626 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: Close
[0m13:13:13.585624 [debug] [Thread-4 (]: Failed to rollback 'model.olist_project.stg_payments__payments'
[0m13:13:13.596589 [debug] [Thread-1 (]: Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "information_schema.columns"?
  LINE 20:   from main.raw_customers
                  ^
[0m13:13:13.596589 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: Close
[0m13:13:13.599581 [debug] [Thread-2 (]: Failed to rollback 'model.olist_project.stg_order_items__order_items'
[0m13:13:13.600578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b99ca53-f14d-4613-b8a1-32e3f04735da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E9DED8D0>]}
[0m13:13:13.602572 [debug] [Thread-3 (]: Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 23:   from main.raw_orders
                  ^
[0m13:13:13.606564 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: Close
[0m13:13:13.612550 [debug] [Thread-4 (]: Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "pg_catalog.pg_depend"?
  LINE 20:   from main.raw_order_payments
                  ^
[0m13:13:13.609554 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model analytics_staging.stg_customers__customers  [[31mERROR[0m in 0.33s]
[0m13:13:13.614541 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b99ca53-f14d-4613-b8a1-32e3f04735da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E9C92090>]}
[0m13:13:13.620525 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b99ca53-f14d-4613-b8a1-32e3f04735da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E9F8D790>]}
[0m13:13:13.623516 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_customers__customers
[0m13:13:13.628504 [debug] [Thread-2 (]: Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m13:13:13.625513 [error] [Thread-3 (]: 3 of 6 ERROR creating sql table model analytics_staging.stg_orders__orders ..... [[31mERROR[0m in 0.34s]
[0m13:13:13.631496 [debug] [Thread-1 (]: Began running node model.olist_project.stg_products__products
[0m13:13:13.629502 [error] [Thread-4 (]: 4 of 6 ERROR creating sql table model analytics_staging.stg_payments__payments . [[31mERROR[0m in 0.34s]
[0m13:13:13.640472 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_payments__payments
[0m13:13:13.634489 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b99ca53-f14d-4613-b8a1-32e3f04735da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E9F8F090>]}
[0m13:13:13.637480 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_orders__orders
[0m13:13:13.642467 [debug] [Thread-4 (]: Began running node model.olist_project.stg_sellers__sellers
[0m13:13:13.639476 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics_staging.stg_products__products .......... [RUN]
[0m13:13:13.645457 [error] [Thread-2 (]: 2 of 6 ERROR creating sql table model analytics_staging.stg_order_items__order_items  [[31mERROR[0m in 0.36s]
[0m13:13:13.651443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_customers__customers, now model.olist_project.stg_products__products)
[0m13:13:13.655431 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_order_items__order_items
[0m13:13:13.648451 [info ] [Thread-4 (]: 6 of 6 START sql table model analytics_staging.stg_sellers__sellers ............ [RUN]
[0m13:13:13.657426 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_products__products
[0m13:13:13.659422 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_payments__payments, now model.olist_project.stg_sellers__sellers)
[0m13:13:13.668401 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_products__products"
[0m13:13:13.670391 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_sellers__sellers
[0m13:13:13.680364 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_sellers__sellers"
[0m13:13:13.682360 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_products__products (compile): 13:13:13.662414 => 13:13:13.681362
[0m13:13:13.684354 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_products__products
[0m13:13:13.687549 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_sellers__sellers (compile): 13:13:13.672391 => 13:13:13.685351
[0m13:13:13.697409 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_products__products"
[0m13:13:13.698403 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_sellers__sellers
[0m13:13:13.708379 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_sellers__sellers"
[0m13:13:13.710371 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:13:13.712919 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: BEGIN
[0m13:13:13.714915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:13.717031 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:13:13.731993 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:13:13.732989 [debug] [Thread-4 (]: On model.olist_project.stg_sellers__sellers: BEGIN
[0m13:13:13.734985 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:13:13.735981 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:13:13.737108 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_products__products__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from main.raw_product_category_translation
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m13:13:13.740101 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:13:13.741098 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:13:13.743470 [debug] [Thread-4 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp"
  
    as (
      

with source as (
  select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
  from main.raw_sellers
)

select * from source
    );
  
  
[0m13:13:13.796690 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_sellers__sellers (execute): 13:13:13.700399 => 13:13:13.796690
[0m13:13:13.797688 [debug] [Thread-4 (]: On model.olist_project.stg_sellers__sellers: ROLLBACK
[0m13:13:13.800679 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_products__products (execute): 13:13:13.688550 => 13:13:13.800679
[0m13:13:13.801678 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: ROLLBACK
[0m13:13:13.804666 [debug] [Thread-4 (]: Failed to rollback 'model.olist_project.stg_sellers__sellers'
[0m13:13:13.806662 [debug] [Thread-4 (]: On model.olist_project.stg_sellers__sellers: Close
[0m13:13:13.812647 [debug] [Thread-1 (]: Failed to rollback 'model.olist_project.stg_products__products'
[0m13:13:13.813643 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: Close
[0m13:13:13.820624 [debug] [Thread-4 (]: Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "information_schema.tables"?
  LINE 19:   from main.raw_sellers
                  ^
[0m13:13:13.822619 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b99ca53-f14d-4613-b8a1-32e3f04735da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E8B8B390>]}
[0m13:13:13.823616 [error] [Thread-4 (]: 6 of 6 ERROR creating sql table model analytics_staging.stg_sellers__sellers ... [[31mERROR[0m in 0.16s]
[0m13:13:13.826608 [debug] [Thread-1 (]: Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m13:13:13.828604 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_sellers__sellers
[0m13:13:13.829601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b99ca53-f14d-4613-b8a1-32e3f04735da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E8B78550>]}
[0m13:13:13.831595 [error] [Thread-1 (]: 5 of 6 ERROR creating sql table model analytics_staging.stg_products__products . [[31mERROR[0m in 0.18s]
[0m13:13:13.833591 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_products__products
[0m13:13:13.836583 [debug] [MainThread]: Using duckdb connection "master"
[0m13:13:13.837584 [debug] [MainThread]: On master: BEGIN
[0m13:13:13.838581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:13:13.854535 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:13:13.856530 [debug] [MainThread]: On master: COMMIT
[0m13:13:13.857527 [debug] [MainThread]: Using duckdb connection "master"
[0m13:13:13.859523 [debug] [MainThread]: On master: COMMIT
[0m13:13:13.861517 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:13:13.863511 [debug] [MainThread]: On master: Close
[0m13:13:13.866534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:13.866534 [debug] [MainThread]: Connection 'create_olist_analytics_staging' was properly closed.
[0m13:13:13.870058 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m13:13:13.870058 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m13:13:13.870058 [debug] [MainThread]: Connection 'model.olist_project.stg_products__products' was properly closed.
[0m13:13:13.870058 [debug] [MainThread]: Connection 'model.olist_project.stg_order_items__order_items' was properly closed.
[0m13:13:13.875276 [debug] [MainThread]: Connection 'model.olist_project.stg_orders__orders' was properly closed.
[0m13:13:13.876274 [debug] [MainThread]: Connection 'model.olist_project.stg_sellers__sellers' was properly closed.
[0m13:13:13.878270 [info ] [MainThread]: 
[0m13:13:13.880265 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m13:13:13.884254 [debug] [MainThread]: Command end result
[0m13:13:13.908216 [info ] [MainThread]: 
[0m13:13:13.910184 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m13:13:13.913175 [info ] [MainThread]: 
[0m13:13:13.915171 [error] [MainThread]:   Runtime Error in model stg_customers__customers (models\staging\stg_customers__customers.sql)
  Catalog Error: Table with name raw_customers does not exist!
  Did you mean "information_schema.columns"?
  LINE 20:   from main.raw_customers
                  ^
[0m13:13:13.917166 [info ] [MainThread]: 
[0m13:13:13.923150 [error] [MainThread]:   Runtime Error in model stg_payments__payments (models\staging\stg_payments__payments.sql)
  Catalog Error: Table with name raw_order_payments does not exist!
  Did you mean "pg_catalog.pg_depend"?
  LINE 20:   from main.raw_order_payments
                  ^
[0m13:13:13.926143 [info ] [MainThread]: 
[0m13:13:13.928137 [error] [MainThread]:   Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Catalog Error: Table with name raw_orders does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 23:   from main.raw_orders
                  ^
[0m13:13:13.935712 [info ] [MainThread]: 
[0m13:13:13.937802 [error] [MainThread]:   Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m13:13:13.939798 [info ] [MainThread]: 
[0m13:13:13.942289 [error] [MainThread]:   Runtime Error in model stg_sellers__sellers (models\staging\stg_sellers__sellers.sql)
  Catalog Error: Table with name raw_sellers does not exist!
  Did you mean "information_schema.tables"?
  LINE 19:   from main.raw_sellers
                  ^
[0m13:13:13.945283 [info ] [MainThread]: 
[0m13:13:13.947278 [error] [MainThread]:   Runtime Error in model stg_products__products (models\staging\stg_products__products.sql)
  Catalog Error: Table with name raw_products does not exist!
  Did you mean "olist.pg_catalog.pg_proc"?
  LINE 24:   from "olist"."main"."raw_products"
                  ^
[0m13:13:13.950273 [info ] [MainThread]: 
[0m13:13:13.952264 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m13:13:13.955258 [debug] [MainThread]: Command `dbt run` failed at 13:13:13.954260 after 1.83 seconds
[0m13:13:13.956255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E891F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E891EF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9E8ADAA10>]}
[0m13:13:13.957251 [debug] [MainThread]: Flushing usage events
[0m13:14:03.832671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88D716D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88C303E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88D6FF510>]}


============================== 13:14:03.839966 | 0b414011-8973-4959-9cfe-f484e1fd86d2 ==============================
[0m13:14:03.839966 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:14:03.841959 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m13:14:04.069343 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:14:04.071338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0b414011-8973-4959-9cfe-f484e1fd86d2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88D8508D0>]}
[0m13:14:04.245150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b414011-8973-4959-9cfe-f484e1fd86d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88D853A10>]}
[0m13:14:04.390890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b414011-8973-4959-9cfe-f484e1fd86d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88D853A10>]}
[0m13:14:04.392881 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m13:14:04.409227 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m13:14:04.538197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:14:04.540204 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:14:04.542808 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m13:14:04.557771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b414011-8973-4959-9cfe-f484e1fd86d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88EA73450>]}
[0m13:14:04.584697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b414011-8973-4959-9cfe-f484e1fd86d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88E9A6150>]}
[0m13:14:04.586695 [info ] [MainThread]: Found 9 seeds, 6 models, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m13:14:04.590068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b414011-8973-4959-9cfe-f484e1fd86d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88E9BF610>]}
[0m13:14:04.596053 [info ] [MainThread]: 
[0m13:14:04.599044 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:14:04.602039 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m13:14:04.626972 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m13:14:04.630961 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"olist"'
    
  
  
[0m13:14:04.631958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:04.668691 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:04.672682 [debug] [ThreadPool]: On list_olist: Close
[0m13:14:04.677668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_analytics_staging)
[0m13:14:04.680660 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "analytics_staging"
"
[0m13:14:04.730066 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:14:04.733034 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
        select type from duckdb_databases()
        where database_name='olist'
        and type='sqlite'
    
  
[0m13:14:04.735030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:04.762102 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:04.787035 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:14:04.789031 [debug] [ThreadPool]: On create_olist_analytics_staging: BEGIN
[0m13:14:04.791024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:04.792066 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:14:04.792066 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
    
        create schema if not exists "olist"."analytics_staging"
    
[0m13:14:04.795075 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:04.795075 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m13:14:04.795075 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:14:04.800103 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m13:14:04.800103 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:04.800103 [debug] [ThreadPool]: On create_olist_analytics_staging: Close
[0m13:14:04.835056 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m13:14:04.838048 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m13:14:04.851547 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:14:04.858529 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:14:04.860524 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m13:14:04.861520 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m13:14:04.862518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:04.864512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:04.881468 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:04.883461 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:04.883461 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:14:04.884459 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:14:04.885456 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m13:14:04.886454 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m13:14:04.969233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:04.970274 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:04.973220 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m13:14:04.975216 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m13:14:04.977211 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m13:14:04.978208 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m13:14:04.978208 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m13:14:04.979205 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m13:14:04.988180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b414011-8973-4959-9cfe-f484e1fd86d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88E9A1DD0>]}
[0m13:14:04.990176 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:04.992370 [debug] [MainThread]: On master: BEGIN
[0m13:14:04.993368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:05.006332 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:14:05.008328 [debug] [MainThread]: On master: COMMIT
[0m13:14:05.009325 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:05.010323 [debug] [MainThread]: On master: COMMIT
[0m13:14:05.011320 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:14:05.012317 [debug] [MainThread]: On master: Close
[0m13:14:05.015309 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:14:05.017305 [info ] [MainThread]: 
[0m13:14:05.022292 [debug] [Thread-1 (]: Began running node model.olist_project.stg_customers__customers
[0m13:14:05.023288 [debug] [Thread-2 (]: Began running node model.olist_project.stg_order_items__order_items
[0m13:14:05.023288 [debug] [Thread-3 (]: Began running node model.olist_project.stg_orders__orders
[0m13:14:05.024284 [debug] [Thread-4 (]: Began running node model.olist_project.stg_payments__payments
[0m13:14:05.025283 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_customers__customers ........ [RUN]
[0m13:14:05.027278 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_order_items__order_items .... [RUN]
[0m13:14:05.033263 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_project.stg_customers__customers'
[0m13:14:05.036254 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_project.stg_order_items__order_items'
[0m13:14:05.038248 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_customers__customers
[0m13:14:05.040244 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_order_items__order_items
[0m13:14:05.028274 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_orders__orders .............. [RUN]
[0m13:14:05.061187 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_customers__customers"
[0m13:14:05.070069 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_order_items__order_items"
[0m13:14:05.030270 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_staging.stg_payments__payments .......... [RUN]
[0m13:14:05.073062 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_project.stg_orders__orders'
[0m13:14:05.077050 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (compile): 13:14:05.041241 => 13:14:05.076056
[0m13:14:05.080043 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_project.stg_payments__payments'
[0m13:14:05.082037 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (compile): 13:14:05.062964 => 13:14:05.081041
[0m13:14:05.084031 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_orders__orders
[0m13:14:05.085029 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_customers__customers
[0m13:14:05.086025 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_payments__payments
[0m13:14:05.087616 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_order_items__order_items
[0m13:14:05.094602 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_orders__orders"
[0m13:14:05.174751 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_customers__customers"
[0m13:14:05.179028 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_payments__payments"
[0m13:14:05.187044 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_order_items__order_items"
[0m13:14:05.189003 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (compile): 13:14:05.088615 => 13:14:05.189003
[0m13:14:05.192463 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_orders__orders
[0m13:14:05.193461 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:14:05.195457 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (compile): 13:14:05.176034 => 13:14:05.194462
[0m13:14:05.196456 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:14:05.203469 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_orders__orders"
[0m13:14:05.204469 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: BEGIN
[0m13:14:05.205430 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_payments__payments
[0m13:14:05.206427 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: BEGIN
[0m13:14:05.208421 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:14:05.216401 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_payments__payments"
[0m13:14:05.218396 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:14:05.219391 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:14:05.234277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.236273 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:14:05.237413 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.238412 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: BEGIN
[0m13:14:05.239411 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:14:05.240406 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: BEGIN
[0m13:14:05.243695 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:14:05.244695 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:14:05.246721 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_customers__customers__dbt_tmp"
  
    as (
      

with source as (
  select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
  from main.raw_customers
)

select
  customer_id,
  customer_unique_id,
  customer_zip_code_prefix,
  customer_city,
  customer_state
from source
    );
  
  
[0m13:14:05.247682 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:14:05.248680 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from main.raw_order_items
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m13:14:05.249678 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.252669 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.253667 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:14:05.254663 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:14:05.255662 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_orders__orders__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
  from main.raw_orders
)


, cleaned as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_at,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_at,
    order_delivered_customer_date::timestamp as order_delivered_customer_at,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_at,
    case 
      when order_delivered_customer_date is not null 
      then (order_delivered_customer_date::timestamp - order_purchase_timestamp::timestamp).days
      else null 
    end as days_to_delivery,
    case
      when order_delivered_customer_date > order_estimated_delivery_date then true
      else false
    end as is_late_delivery
  from source
)

select * from cleaned
    );
  
  
[0m13:14:05.256687 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_payments__payments__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
  from main.raw_order_payments
)

select * from source
    );
  
  
[0m13:14:05.263640 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (execute): 13:14:05.180027 => 13:14:05.262646
[0m13:14:05.265634 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (execute): 13:14:05.196456 => 13:14:05.264637
[0m13:14:05.266631 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: ROLLBACK
[0m13:14:05.267629 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: ROLLBACK
[0m13:14:05.284584 [debug] [Thread-2 (]: Failed to rollback 'model.olist_project.stg_order_items__order_items'
[0m13:14:05.287576 [debug] [Thread-3 (]: Failed to rollback 'model.olist_project.stg_orders__orders'
[0m13:14:05.289571 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: Close
[0m13:14:05.290567 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: Close
[0m13:14:05.300541 [debug] [Thread-2 (]: Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Binder Error: Referenced column "product_category_name_english" not found in FROM clause!
  Candidate bindings: "p.product_category_name"
  LINE 30:     product_category_name_english
               ^
[0m13:14:05.304532 [debug] [Thread-3 (]: Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Binder Error: Cannot extract field 'days' from expression "(order_delivered_customer_date - order_purchase_timestamp)" because it is not a struct, union, or json
[0m13:14:05.305529 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b414011-8973-4959-9cfe-f484e1fd86d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88E984D50>]}
[0m13:14:05.306525 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b414011-8973-4959-9cfe-f484e1fd86d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88EB2BF50>]}
[0m13:14:05.308519 [error] [Thread-2 (]: 2 of 6 ERROR creating sql table model analytics_staging.stg_order_items__order_items  [[31mERROR[0m in 0.27s]
[0m13:14:05.313507 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_order_items__order_items
[0m13:14:05.310515 [error] [Thread-3 (]: 3 of 6 ERROR creating sql table model analytics_staging.stg_orders__orders ..... [[31mERROR[0m in 0.23s]
[0m13:14:05.315501 [debug] [Thread-2 (]: Began running node model.olist_project.stg_products__products
[0m13:14:05.318493 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_orders__orders
[0m13:14:05.323482 [debug] [Thread-3 (]: Began running node model.olist_project.stg_sellers__sellers
[0m13:14:05.322483 [info ] [Thread-2 (]: 5 of 6 START sql table model analytics_staging.stg_products__products .......... [RUN]
[0m13:14:05.348415 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_order_items__order_items, now model.olist_project.stg_products__products)
[0m13:14:05.350410 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_products__products
[0m13:14:05.360383 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_products__products"
[0m13:14:05.326474 [info ] [Thread-3 (]: 6 of 6 START sql table model analytics_staging.stg_sellers__sellers ............ [RUN]
[0m13:14:05.364371 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_orders__orders, now model.olist_project.stg_sellers__sellers)
[0m13:14:05.366365 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.367363 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_products__products (compile): 13:14:05.352406 => 13:14:05.367363
[0m13:14:05.372870 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_sellers__sellers
[0m13:14:05.382842 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_products__products
[0m13:14:05.388826 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:14:05.399797 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_sellers__sellers"
[0m13:14:05.411767 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_products__products"
[0m13:14:05.413760 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */
alter table "olist"."analytics_staging"."stg_payments__payments__dbt_tmp" rename to "stg_payments__payments"
[0m13:14:05.416753 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_sellers__sellers (compile): 13:14:05.391819 => 13:14:05.415754
[0m13:14:05.418748 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:14:05.422736 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_sellers__sellers
[0m13:14:05.424731 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: BEGIN
[0m13:14:05.426727 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.438694 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_sellers__sellers"
[0m13:14:05.439691 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:14:05.462440 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.463438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.486375 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: COMMIT
[0m13:14:05.487553 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:14:05.488550 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:14:05.496019 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:14:05.497017 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:14:05.498015 [debug] [Thread-3 (]: On model.olist_project.stg_sellers__sellers: BEGIN
[0m13:14:05.499012 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_products__products__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from main.raw_product_category_translation
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m13:14:05.501014 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */
alter table "olist"."analytics_staging"."stg_customers__customers__dbt_tmp" rename to "stg_customers__customers"
[0m13:14:05.502004 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: COMMIT
[0m13:14:05.503001 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:14:05.505995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.513974 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: COMMIT
[0m13:14:05.515967 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.517963 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:14:05.519956 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:14:05.521953 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: COMMIT
[0m13:14:05.523945 [debug] [Thread-3 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp"
  
    as (
      

with source as (
  select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
  from main.raw_sellers
)

select * from source
    );
  
  
[0m13:14:05.576235 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.594186 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:14:05.596186 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */
drop table if exists "olist"."analytics_staging"."stg_payments__payments__dbt_backup" cascade
[0m13:14:05.597179 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.604160 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:14:05.605159 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */
alter table "olist"."analytics_staging"."stg_products__products__dbt_tmp" rename to "stg_products__products"
[0m13:14:05.607152 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.611140 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: COMMIT
[0m13:14:05.612137 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:14:05.613135 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: COMMIT
[0m13:14:05.641060 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.648045 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:14:05.649040 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.650038 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */
drop table if exists "olist"."analytics_staging"."stg_customers__customers__dbt_backup" cascade
[0m13:14:05.657016 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:14:05.659014 [debug] [Thread-3 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */
alter table "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp" rename to "stg_sellers__sellers"
[0m13:14:05.662004 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.665993 [debug] [Thread-3 (]: On model.olist_project.stg_sellers__sellers: COMMIT
[0m13:14:05.666991 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:14:05.668985 [debug] [Thread-3 (]: On model.olist_project.stg_sellers__sellers: COMMIT
[0m13:14:05.670980 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.677962 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:14:05.678959 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.678959 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.679957 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.680953 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */
drop table if exists "olist"."analytics_staging"."stg_products__products__dbt_backup" cascade
[0m13:14:05.685939 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:14:05.688933 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (execute): 13:14:05.095598 => 13:14:05.687937
[0m13:14:05.691925 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (execute): 13:14:05.209467 => 13:14:05.691925
[0m13:14:05.693920 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.694917 [debug] [Thread-3 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */
drop table if exists "olist"."analytics_staging"."stg_sellers__sellers__dbt_backup" cascade
[0m13:14:05.695914 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: Close
[0m13:14:05.696913 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: Close
[0m13:14:05.699904 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_products__products (execute): 13:14:05.400804 => 13:14:05.699904
[0m13:14:05.701898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b414011-8973-4959-9cfe-f484e1fd86d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88D78AD90>]}
[0m13:14:05.702898 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:14:05.704891 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b414011-8973-4959-9cfe-f484e1fd86d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88EBCA0D0>]}
[0m13:14:05.705889 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: Close
[0m13:14:05.709880 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_sellers__sellers (execute): 13:14:05.427724 => 13:14:05.709880
[0m13:14:05.706884 [info ] [Thread-1 (]: 1 of 6 OK created sql table model analytics_staging.stg_customers__customers ... [[32mOK[0m in 0.67s]
[0m13:14:05.713867 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b414011-8973-4959-9cfe-f484e1fd86d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88EB60B50>]}
[0m13:14:05.711873 [info ] [Thread-4 (]: 4 of 6 OK created sql table model analytics_staging.stg_payments__payments ..... [[32mOK[0m in 0.63s]
[0m13:14:05.714863 [debug] [Thread-3 (]: On model.olist_project.stg_sellers__sellers: Close
[0m13:14:05.716859 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_customers__customers
[0m13:14:05.719851 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_payments__payments
[0m13:14:05.717856 [info ] [Thread-2 (]: 5 of 6 OK created sql table model analytics_staging.stg_products__products ..... [[32mOK[0m in 0.37s]
[0m13:14:06.122536 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b414011-8973-4959-9cfe-f484e1fd86d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88E9FED50>]}
[0m13:14:06.124527 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_products__products
[0m13:14:06.126525 [info ] [Thread-3 (]: 6 of 6 OK created sql table model analytics_staging.stg_sellers__sellers ....... [[32mOK[0m in 0.76s]
[0m13:14:06.131509 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_sellers__sellers
[0m13:14:06.135498 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:06.136496 [debug] [MainThread]: On master: BEGIN
[0m13:14:06.137493 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:06.169610 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:14:06.170608 [debug] [MainThread]: On master: COMMIT
[0m13:14:06.171605 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:06.172603 [debug] [MainThread]: On master: COMMIT
[0m13:14:06.175023 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:14:06.176489 [debug] [MainThread]: On master: Close
[0m13:14:06.180480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:06.181478 [debug] [MainThread]: Connection 'create_olist_analytics_staging' was properly closed.
[0m13:14:06.182475 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m13:14:06.183471 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m13:14:06.184469 [debug] [MainThread]: Connection 'model.olist_project.stg_customers__customers' was properly closed.
[0m13:14:06.185466 [debug] [MainThread]: Connection 'model.olist_project.stg_products__products' was properly closed.
[0m13:14:06.186463 [debug] [MainThread]: Connection 'model.olist_project.stg_sellers__sellers' was properly closed.
[0m13:14:06.187461 [debug] [MainThread]: Connection 'model.olist_project.stg_payments__payments' was properly closed.
[0m13:14:06.188457 [info ] [MainThread]: 
[0m13:14:06.189454 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m13:14:06.193482 [debug] [MainThread]: Command end result
[0m13:14:06.208404 [info ] [MainThread]: 
[0m13:14:06.210398 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:14:06.213391 [info ] [MainThread]: 
[0m13:14:06.214389 [error] [MainThread]:   Runtime Error in model stg_order_items__order_items (models\staging\stg_order_items__order_items.sql)
  Binder Error: Referenced column "product_category_name_english" not found in FROM clause!
  Candidate bindings: "p.product_category_name"
  LINE 30:     product_category_name_english
               ^
[0m13:14:06.217381 [info ] [MainThread]: 
[0m13:14:06.218379 [error] [MainThread]:   Runtime Error in model stg_orders__orders (models\staging\stg_orders__orders.sql)
  Binder Error: Cannot extract field 'days' from expression "(order_delivered_customer_date - order_purchase_timestamp)" because it is not a struct, union, or json
[0m13:14:06.220372 [info ] [MainThread]: 
[0m13:14:06.222367 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m13:14:06.225359 [debug] [MainThread]: Command `dbt run` failed at 13:14:06.225359 after 2.49 seconds
[0m13:14:06.227358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88CEF5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A88CB2A9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A886869F10>]}
[0m13:14:06.228380 [debug] [MainThread]: Flushing usage events
[0m13:14:41.156978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114CFF7F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114BD32410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114CACD510>]}


============================== 13:14:41.162998 | 4f6b9ef4-b837-4917-ae6f-7e291f804737 ==============================
[0m13:14:41.162998 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:14:41.165966 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m13:14:41.406379 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:14:41.408793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4f6b9ef4-b837-4917-ae6f-7e291f804737', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114D015E90>]}
[0m13:14:41.596750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f6b9ef4-b837-4917-ae6f-7e291f804737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114D06ACD0>]}
[0m13:14:41.731972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f6b9ef4-b837-4917-ae6f-7e291f804737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114D13AA90>]}
[0m13:14:41.734511 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m13:14:41.749719 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m13:14:41.905557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:14:41.906554 [debug] [MainThread]: Partial parsing: updated file: olist_project://models\staging\stg_orders__orders.sql
[0m13:14:41.907552 [debug] [MainThread]: Partial parsing: updated file: olist_project://models\staging\stg_order_items__order_items.sql
[0m13:14:42.154474 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m13:14:42.164445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f6b9ef4-b837-4917-ae6f-7e291f804737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114E460250>]}
[0m13:14:42.186388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f6b9ef4-b837-4917-ae6f-7e291f804737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114E39D750>]}
[0m13:14:42.188384 [info ] [MainThread]: Found 9 seeds, 6 models, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m13:14:42.190378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f6b9ef4-b837-4917-ae6f-7e291f804737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114E3B2590>]}
[0m13:14:42.196399 [info ] [MainThread]: 
[0m13:14:42.199356 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:14:42.202345 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m13:14:42.235258 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m13:14:42.236256 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"olist"'
    
  
  
[0m13:14:42.237622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:42.259563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:42.264683 [debug] [ThreadPool]: On list_olist: Close
[0m13:14:42.270784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_analytics_staging)
[0m13:14:42.273777 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "analytics_staging"
"
[0m13:14:42.286740 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:14:42.287738 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
        select type from duckdb_databases()
        where database_name='olist'
        and type='sqlite'
    
  
[0m13:14:42.289733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:42.303694 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:42.306687 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:14:42.307684 [debug] [ThreadPool]: On create_olist_analytics_staging: BEGIN
[0m13:14:42.308682 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:42.310688 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:14:42.311674 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
    
        create schema if not exists "olist"."analytics_staging"
    
[0m13:14:42.312670 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:42.315664 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m13:14:42.316661 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:14:42.317659 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m13:14:42.318655 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:42.319654 [debug] [ThreadPool]: On create_olist_analytics_staging: Close
[0m13:14:42.327632 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m13:14:42.329625 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m13:14:42.340590 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:14:42.345098 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:14:42.345098 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m13:14:42.345098 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m13:14:42.345098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:42.345098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:42.362315 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:42.363313 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:42.364311 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:14:42.365306 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:14:42.366304 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m13:14:42.367301 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m13:14:42.427389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:42.448333 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m13:14:42.449334 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:14:42.451325 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m13:14:42.452322 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m13:14:42.454317 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m13:14:42.454317 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m13:14:42.456311 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m13:14:42.464289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f6b9ef4-b837-4917-ae6f-7e291f804737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114E388810>]}
[0m13:14:42.465287 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:42.466285 [debug] [MainThread]: On master: BEGIN
[0m13:14:42.467284 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:42.482243 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:14:42.483240 [debug] [MainThread]: On master: COMMIT
[0m13:14:42.484237 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:42.485235 [debug] [MainThread]: On master: COMMIT
[0m13:14:42.486232 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:14:42.487229 [debug] [MainThread]: On master: Close
[0m13:14:42.493214 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:14:42.495209 [info ] [MainThread]: 
[0m13:14:42.502221 [debug] [Thread-1 (]: Began running node model.olist_project.stg_customers__customers
[0m13:14:42.503186 [debug] [Thread-2 (]: Began running node model.olist_project.stg_order_items__order_items
[0m13:14:42.503186 [debug] [Thread-3 (]: Began running node model.olist_project.stg_orders__orders
[0m13:14:42.504213 [debug] [Thread-4 (]: Began running node model.olist_project.stg_payments__payments
[0m13:14:42.505180 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_customers__customers ........ [RUN]
[0m13:14:42.507177 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_order_items__order_items .... [RUN]
[0m13:14:42.509171 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_orders__orders .............. [RUN]
[0m13:14:42.513160 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_project.stg_customers__customers'
[0m13:14:42.510167 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_staging.stg_payments__payments .......... [RUN]
[0m13:14:42.516155 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_project.stg_order_items__order_items'
[0m13:14:42.519147 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_project.stg_orders__orders'
[0m13:14:42.521139 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_customers__customers
[0m13:14:42.524130 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_project.stg_payments__payments'
[0m13:14:42.525128 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_order_items__order_items
[0m13:14:42.527125 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_orders__orders
[0m13:14:42.545588 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_customers__customers"
[0m13:14:42.546589 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_payments__payments
[0m13:14:42.554564 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_order_items__order_items"
[0m13:14:42.565535 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_orders__orders"
[0m13:14:42.574511 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_payments__payments"
[0m13:14:42.576506 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (compile): 13:14:42.529117 => 13:14:42.575508
[0m13:14:42.579503 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_customers__customers
[0m13:14:42.647521 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (compile): 13:14:42.554564 => 13:14:42.647521
[0m13:14:42.663589 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (compile): 13:14:42.547585 => 13:14:42.663589
[0m13:14:42.666686 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_customers__customers"
[0m13:14:42.667686 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_orders__orders
[0m13:14:42.669681 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (compile): 13:14:42.567529 => 13:14:42.668683
[0m13:14:42.670677 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_order_items__order_items
[0m13:14:42.679653 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_orders__orders"
[0m13:14:42.680650 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_payments__payments
[0m13:14:42.681648 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:14:42.687631 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_order_items__order_items"
[0m13:14:42.697873 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_payments__payments"
[0m13:14:42.698871 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:14:42.699907 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: BEGIN
[0m13:14:42.701867 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:14:42.702861 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: BEGIN
[0m13:14:42.704856 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:14:42.705853 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:14:42.706850 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: BEGIN
[0m13:14:42.707848 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:14:42.708876 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: BEGIN
[0m13:14:42.723807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:14:42.724803 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:14:42.726818 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:14:42.727795 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:14:42.728791 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:14:42.730786 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:14:42.732783 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:42.732783 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:14:42.733778 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_customers__customers__dbt_tmp"
  
    as (
      

with source as (
  select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
  from main.raw_customers
)

select
  customer_id,
  customer_unique_id,
  customer_zip_code_prefix,
  customer_city,
  customer_state
from source
    );
  
  
[0m13:14:42.734776 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:14:42.735773 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:14:42.737767 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_orders__orders__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
  from "olist"."main"."raw_orders"
)


, cleaned as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_at,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_at,
    order_delivered_customer_date::timestamp as order_delivered_customer_at,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_at,
    case 
      when order_delivered_customer_date is not null 
      then date_diff('day', order_purchase_timestamp::timestamp, order_delivered_customer_date::timestamp)
      else null 
    end as days_to_delivery,
    case
      when order_delivered_customer_date > order_estimated_delivery_date then true
      else false
    end as is_late_delivery
  from source
)

select * from cleaned
    );
  
  
[0m13:14:42.738767 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."main"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m13:14:42.741291 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_payments__payments__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
  from main.raw_order_payments
)

select * from source
    );
  
  
[0m13:14:42.852330 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:14:42.869284 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:14:42.871278 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */
alter table "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp" rename to "stg_order_items__order_items"
[0m13:14:42.872368 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:42.880347 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:14:42.882218 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */
alter table "olist"."analytics_staging"."stg_payments__payments" rename to "stg_payments__payments__dbt_backup"
[0m13:14:42.884214 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:14:42.885210 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:42.927203 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: COMMIT
[0m13:14:42.935183 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:14:42.936179 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:14:42.938174 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */
alter table "olist"."analytics_staging"."stg_payments__payments__dbt_tmp" rename to "stg_payments__payments"
[0m13:14:42.939171 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: COMMIT
[0m13:14:42.943160 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:42.957122 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: COMMIT
[0m13:14:42.960115 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:14:42.963219 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: COMMIT
[0m13:14:42.964214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:14:42.965211 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:14:42.973190 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:14:42.983548 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:14:42.985542 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */
alter table "olist"."analytics_staging"."stg_customers__customers" rename to "stg_customers__customers__dbt_backup"
[0m13:14:42.986538 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:14:42.987536 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */
alter table "olist"."analytics_staging"."stg_orders__orders__dbt_tmp" rename to "stg_orders__orders"
[0m13:14:42.989533 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.062259 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:14:43.063257 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.069336 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:14:43.070334 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.071331 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */
drop table if exists "olist"."analytics_staging"."stg_order_items__order_items__dbt_backup" cascade
[0m13:14:43.078312 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:14:43.079310 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */
alter table "olist"."analytics_staging"."stg_customers__customers__dbt_tmp" rename to "stg_customers__customers"
[0m13:14:43.082302 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: COMMIT
[0m13:14:43.083301 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.084298 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */
drop table if exists "olist"."analytics_staging"."stg_payments__payments__dbt_backup" cascade
[0m13:14:43.086293 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:14:43.087293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.092276 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (execute): 13:14:42.682646 => 13:14:43.091279
[0m13:14:43.094271 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: COMMIT
[0m13:14:43.100253 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: COMMIT
[0m13:14:43.102251 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: Close
[0m13:14:43.104246 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:14:43.105245 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.108234 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f6b9ef4-b837-4917-ae6f-7e291f804737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114E543BD0>]}
[0m13:14:43.110230 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: COMMIT
[0m13:14:43.114219 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (execute): 13:14:42.688631 => 13:14:43.113222
[0m13:14:43.118966 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: Close
[0m13:14:43.116982 [info ] [Thread-2 (]: 2 of 6 OK created sql table model analytics_staging.stg_order_items__order_items  [[32mOK[0m in 0.59s]
[0m13:14:43.121958 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f6b9ef4-b837-4917-ae6f-7e291f804737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114E1E7AD0>]}
[0m13:14:43.123953 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_order_items__order_items
[0m13:14:43.127941 [debug] [Thread-2 (]: Began running node model.olist_project.stg_products__products
[0m13:14:43.125947 [info ] [Thread-4 (]: 4 of 6 OK created sql table model analytics_staging.stg_payments__payments ..... [[32mOK[0m in 0.60s]
[0m13:14:43.131931 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_payments__payments
[0m13:14:43.129936 [info ] [Thread-2 (]: 5 of 6 START sql table model analytics_staging.stg_products__products .......... [RUN]
[0m13:14:43.133925 [debug] [Thread-4 (]: Began running node model.olist_project.stg_sellers__sellers
[0m13:14:43.137052 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_order_items__order_items, now model.olist_project.stg_products__products)
[0m13:14:43.140045 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_products__products
[0m13:14:43.139050 [info ] [Thread-4 (]: 6 of 6 START sql table model analytics_staging.stg_sellers__sellers ............ [RUN]
[0m13:14:43.151018 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_products__products"
[0m13:14:43.154007 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_payments__payments, now model.olist_project.stg_sellers__sellers)
[0m13:14:43.156004 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_sellers__sellers
[0m13:14:43.163982 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_sellers__sellers"
[0m13:14:43.165976 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_products__products (compile): 13:14:43.144036 => 13:14:43.164978
[0m13:14:43.168971 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_sellers__sellers (compile): 13:14:43.157001 => 13:14:43.166974
[0m13:14:43.169966 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_products__products
[0m13:14:43.174952 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_sellers__sellers
[0m13:14:43.184925 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_products__products"
[0m13:14:43.194898 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_sellers__sellers"
[0m13:14:43.197891 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:14:43.198889 [debug] [Thread-4 (]: On model.olist_project.stg_sellers__sellers: BEGIN
[0m13:14:43.200883 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:14:43.201880 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.202878 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:14:43.204872 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: BEGIN
[0m13:14:43.211855 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:14:43.224961 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.226953 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:14:43.228949 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */
drop table if exists "olist"."analytics_staging"."stg_orders__orders__dbt_backup" cascade
[0m13:14:43.229946 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:14:43.231939 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.234931 [debug] [Thread-4 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp"
  
    as (
      

with source as (
  select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
  from main.raw_sellers
)

select * from source
    );
  
  
[0m13:14:43.235929 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:14:43.237924 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_products__products__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from main.raw_product_category_translation
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m13:14:43.282171 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.283166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.286159 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (execute): 13:14:42.671674 => 13:14:43.285162
[0m13:14:43.287292 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.295271 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:14:43.296272 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: Close
[0m13:14:43.302253 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:14:43.304248 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */
drop table if exists "olist"."analytics_staging"."stg_customers__customers__dbt_backup" cascade
[0m13:14:43.306243 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f6b9ef4-b837-4917-ae6f-7e291f804737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114E4E1790>]}
[0m13:14:43.308237 [debug] [Thread-4 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */
alter table "olist"."analytics_staging"."stg_sellers__sellers" rename to "stg_sellers__sellers__dbt_backup"
[0m13:14:43.314506 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.312228 [info ] [Thread-3 (]: 3 of 6 OK created sql table model analytics_staging.stg_orders__orders ......... [[32mOK[0m in 0.79s]
[0m13:14:43.320602 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:14:43.321601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.323595 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_orders__orders
[0m13:14:43.325590 [debug] [Thread-4 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */
alter table "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp" rename to "stg_sellers__sellers"
[0m13:14:43.330575 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (execute): 13:14:42.580498 => 13:14:43.329578
[0m13:14:43.333569 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: Close
[0m13:14:43.334567 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.336561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f6b9ef4-b837-4917-ae6f-7e291f804737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114E546D10>]}
[0m13:14:43.343763 [debug] [Thread-4 (]: On model.olist_project.stg_sellers__sellers: COMMIT
[0m13:14:43.348751 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.346769 [info ] [Thread-1 (]: 1 of 6 OK created sql table model analytics_staging.stg_customers__customers ... [[32mOK[0m in 0.82s]
[0m13:14:43.350747 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:14:43.361714 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:14:43.362711 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_customers__customers
[0m13:14:43.363710 [debug] [Thread-4 (]: On model.olist_project.stg_sellers__sellers: COMMIT
[0m13:14:43.365704 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */
alter table "olist"."analytics_staging"."stg_products__products" rename to "stg_products__products__dbt_backup"
[0m13:14:43.368812 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.378787 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:14:43.379786 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.381778 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */
alter table "olist"."analytics_staging"."stg_products__products__dbt_tmp" rename to "stg_products__products"
[0m13:14:43.387876 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:14:43.388874 [debug] [Thread-4 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */
drop table if exists "olist"."analytics_staging"."stg_sellers__sellers__dbt_backup" cascade
[0m13:14:43.389872 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.397850 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: COMMIT
[0m13:14:43.398849 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.398849 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:14:43.401927 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_sellers__sellers (execute): 13:14:43.185924 => 13:14:43.401927
[0m13:14:43.402925 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: COMMIT
[0m13:14:43.403922 [debug] [Thread-4 (]: On model.olist_project.stg_sellers__sellers: Close
[0m13:14:43.406916 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f6b9ef4-b837-4917-ae6f-7e291f804737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114E587A50>]}
[0m13:14:43.407916 [info ] [Thread-4 (]: 6 of 6 OK created sql table model analytics_staging.stg_sellers__sellers ....... [[32mOK[0m in 0.25s]
[0m13:14:43.411904 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_sellers__sellers
[0m13:14:43.434837 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:14:43.440823 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:14:43.441819 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */
drop table if exists "olist"."analytics_staging"."stg_products__products__dbt_backup" cascade
[0m13:14:44.053714 [debug] [Thread-2 (]: SQL status: OK in 1.0 seconds
[0m13:14:44.055745 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_products__products (execute): 13:14:43.175948 => 13:14:44.055745
[0m13:14:44.057704 [debug] [Thread-2 (]: On model.olist_project.stg_products__products: Close
[0m13:14:44.068711 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f6b9ef4-b837-4917-ae6f-7e291f804737', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114E55A2D0>]}
[0m13:14:44.069708 [info ] [Thread-2 (]: 5 of 6 OK created sql table model analytics_staging.stg_products__products ..... [[32mOK[0m in 0.93s]
[0m13:14:44.071668 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_products__products
[0m13:14:44.075655 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:44.076652 [debug] [MainThread]: On master: BEGIN
[0m13:14:44.078648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:44.113424 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:14:44.115403 [debug] [MainThread]: On master: COMMIT
[0m13:14:44.116436 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:44.118392 [debug] [MainThread]: On master: COMMIT
[0m13:14:44.120387 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:14:44.121390 [debug] [MainThread]: On master: Close
[0m13:14:44.126371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:44.133354 [debug] [MainThread]: Connection 'create_olist_analytics_staging' was properly closed.
[0m13:14:44.134349 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m13:14:44.136380 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m13:14:44.137471 [debug] [MainThread]: Connection 'model.olist_project.stg_customers__customers' was properly closed.
[0m13:14:44.138511 [debug] [MainThread]: Connection 'model.olist_project.stg_products__products' was properly closed.
[0m13:14:44.139467 [debug] [MainThread]: Connection 'model.olist_project.stg_orders__orders' was properly closed.
[0m13:14:44.140471 [debug] [MainThread]: Connection 'model.olist_project.stg_sellers__sellers' was properly closed.
[0m13:14:44.142572 [info ] [MainThread]: 
[0m13:14:44.145565 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m13:14:44.151551 [debug] [MainThread]: Command end result
[0m13:14:44.176490 [info ] [MainThread]: 
[0m13:14:44.178478 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:14:44.181470 [info ] [MainThread]: 
[0m13:14:44.182465 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:14:44.185495 [debug] [MainThread]: Command `dbt run` succeeded at 13:14:44.185495 after 3.12 seconds
[0m13:14:44.187454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114CA3A350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114C7D5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002114CFBFAD0>]}
[0m13:14:44.188487 [debug] [MainThread]: Flushing usage events
[0m13:15:29.190103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E793448050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E79342F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7935FA850>]}


============================== 13:15:29.196403 | ad430a5d-d5f5-4e14-a9f5-aa04f356534a ==============================
[0m13:15:29.196403 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:15:29.198362 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m13:15:29.407723 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:15:29.409684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ad430a5d-d5f5-4e14-a9f5-aa04f356534a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E793696690>]}
[0m13:15:29.574019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad430a5d-d5f5-4e14-a9f5-aa04f356534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E793644950>]}
[0m13:15:29.718449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad430a5d-d5f5-4e14-a9f5-aa04f356534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7935366D0>]}
[0m13:15:29.720401 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m13:15:29.735362 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m13:15:29.851595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:15:29.852636 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:15:29.854586 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m13:15:29.862672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad430a5d-d5f5-4e14-a9f5-aa04f356534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E793694910>]}
[0m13:15:29.892218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad430a5d-d5f5-4e14-a9f5-aa04f356534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7948AF910>]}
[0m13:15:29.893219 [info ] [MainThread]: Found 9 seeds, 6 models, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m13:15:29.895213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad430a5d-d5f5-4e14-a9f5-aa04f356534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7948CF690>]}
[0m13:15:29.899237 [info ] [MainThread]: 
[0m13:15:29.901197 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:15:29.905184 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m13:15:29.933114 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m13:15:29.934111 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"olist"'
    
  
  
[0m13:15:29.935113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:29.960037 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:15:29.963280 [debug] [ThreadPool]: On list_olist: Close
[0m13:15:29.967400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_analytics_staging)
[0m13:15:29.969433 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "analytics_staging"
"
[0m13:15:29.982400 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:15:29.983394 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
        select type from duckdb_databases()
        where database_name='olist'
        and type='sqlite'
    
  
[0m13:15:29.984394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:30.001311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:15:30.003307 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:15:30.005300 [debug] [ThreadPool]: On create_olist_analytics_staging: BEGIN
[0m13:15:30.006335 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:15:30.007332 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:15:30.008293 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
    
        create schema if not exists "olist"."analytics_staging"
    
[0m13:15:30.010288 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:15:30.012323 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m13:15:30.013398 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:15:30.013398 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m13:15:30.015388 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:15:30.016466 [debug] [ThreadPool]: On create_olist_analytics_staging: Close
[0m13:15:30.022832 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m13:15:30.030812 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:15:30.032806 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m13:15:30.033804 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m13:15:30.038929 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:15:30.039931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:30.040925 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m13:15:30.057881 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:15:30.058896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:30.059874 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:15:30.060871 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:15:30.061985 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m13:15:30.062983 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:15:30.064979 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m13:15:30.132188 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:15:30.148747 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m13:15:30.149745 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:15:30.151741 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m13:15:30.154735 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m13:15:30.155730 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m13:15:30.157724 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m13:15:30.163815 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m13:15:30.168914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad430a5d-d5f5-4e14-a9f5-aa04f356534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E792AA1B10>]}
[0m13:15:30.169910 [debug] [MainThread]: Using duckdb connection "master"
[0m13:15:30.170908 [debug] [MainThread]: On master: BEGIN
[0m13:15:30.171905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:15:30.184870 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:15:30.185868 [debug] [MainThread]: On master: COMMIT
[0m13:15:30.186866 [debug] [MainThread]: Using duckdb connection "master"
[0m13:15:30.187862 [debug] [MainThread]: On master: COMMIT
[0m13:15:30.188860 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:15:30.190855 [debug] [MainThread]: On master: Close
[0m13:15:30.193849 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:15:30.195841 [info ] [MainThread]: 
[0m13:15:30.201826 [debug] [Thread-1 (]: Began running node model.olist_project.stg_customers__customers
[0m13:15:30.202825 [debug] [Thread-2 (]: Began running node model.olist_project.stg_order_items__order_items
[0m13:15:30.204819 [debug] [Thread-3 (]: Began running node model.olist_project.stg_orders__orders
[0m13:15:30.206812 [debug] [Thread-4 (]: Began running node model.olist_project.stg_payments__payments
[0m13:15:30.208808 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_customers__customers ........ [RUN]
[0m13:15:30.210802 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_order_items__order_items .... [RUN]
[0m13:15:30.212796 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_orders__orders .............. [RUN]
[0m13:15:30.216903 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_project.stg_customers__customers'
[0m13:15:30.214792 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_staging.stg_payments__payments .......... [RUN]
[0m13:15:30.216903 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_project.stg_order_items__order_items'
[0m13:15:30.219920 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_project.stg_orders__orders'
[0m13:15:30.219920 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_customers__customers
[0m13:15:30.225928 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_project.stg_payments__payments'
[0m13:15:30.226926 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_order_items__order_items
[0m13:15:30.228921 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_orders__orders
[0m13:15:30.243983 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_customers__customers"
[0m13:15:30.244979 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_payments__payments
[0m13:15:30.252170 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_order_items__order_items"
[0m13:15:30.259153 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_orders__orders"
[0m13:15:30.264886 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_payments__payments"
[0m13:15:30.267005 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (compile): 13:15:30.229918 => 13:15:30.265882
[0m13:15:30.269000 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (compile): 13:15:30.246182 => 13:15:30.268003
[0m13:15:30.270996 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_customers__customers
[0m13:15:30.271991 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (compile): 13:15:30.261147 => 13:15:30.271991
[0m13:15:30.273987 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_order_items__order_items
[0m13:15:30.274985 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (compile): 13:15:30.253167 => 13:15:30.274985
[0m13:15:30.334824 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_payments__payments
[0m13:15:30.335821 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_customers__customers"
[0m13:15:30.344104 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_order_items__order_items"
[0m13:15:30.344684 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_orders__orders
[0m13:15:30.352702 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_payments__payments"
[0m13:15:30.354662 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:15:30.362677 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_orders__orders"
[0m13:15:30.363638 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:15:30.365632 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: BEGIN
[0m13:15:30.366631 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:15:30.368623 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: BEGIN
[0m13:15:30.369620 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:15:30.370620 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:15:30.371615 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: BEGIN
[0m13:15:30.373611 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:15:30.374608 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: BEGIN
[0m13:15:30.388754 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:15:30.390717 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.391747 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.391747 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:15:30.391747 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.391747 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:15:30.391747 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:15:30.391747 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.391747 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:15:30.400018 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_customers__customers__dbt_tmp"
  
    as (
      

with source as (
  select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
  from main.raw_customers
)

select
  customer_id,
  customer_unique_id,
  customer_zip_code_prefix,
  customer_city,
  customer_state
from source
    );
  
  
[0m13:15:30.401015 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."main"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m13:15:30.403011 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:15:30.404009 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_payments__payments__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
  from main.raw_order_payments
)

select * from source
    );
  
  
[0m13:15:30.406008 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_orders__orders__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
  from "olist"."main"."raw_orders"
)


, cleaned as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_at,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_at,
    order_delivered_customer_date::timestamp as order_delivered_customer_at,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_at,
    case 
      when order_delivered_customer_date is not null 
      then date_diff('day', order_purchase_timestamp::timestamp, order_delivered_customer_date::timestamp)
      else null 
    end as days_to_delivery,
    case
      when order_delivered_customer_date > order_estimated_delivery_date then true
      else false
    end as is_late_delivery
  from source
)

select * from cleaned
    );
  
  
[0m13:15:30.485316 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.502781 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:15:30.504776 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */
alter table "olist"."analytics_staging"."stg_order_items__order_items" rename to "stg_order_items__order_items__dbt_backup"
[0m13:15:30.506771 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.513753 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:15:30.514748 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.516745 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */
alter table "olist"."analytics_staging"."stg_payments__payments" rename to "stg_payments__payments__dbt_backup"
[0m13:15:30.525722 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:15:30.527714 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.528711 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */
alter table "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp" rename to "stg_order_items__order_items"
[0m13:15:30.535692 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:15:30.538130 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.539128 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */
alter table "olist"."analytics_staging"."stg_payments__payments__dbt_tmp" rename to "stg_payments__payments"
[0m13:15:30.586413 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: COMMIT
[0m13:15:30.589406 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:15:30.590402 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.591893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.591893 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.591893 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: COMMIT
[0m13:15:30.591893 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: COMMIT
[0m13:15:30.604002 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:15:30.608988 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:15:30.609989 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:15:30.612100 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */
alter table "olist"."analytics_staging"."stg_customers__customers" rename to "stg_customers__customers__dbt_backup"
[0m13:15:30.614096 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */
alter table "olist"."analytics_staging"."stg_orders__orders" rename to "stg_orders__orders__dbt_backup"
[0m13:15:30.615095 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: COMMIT
[0m13:15:30.617404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.618403 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.625383 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:15:30.633361 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:15:30.635357 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */
alter table "olist"."analytics_staging"."stg_customers__customers__dbt_tmp" rename to "stg_customers__customers"
[0m13:15:30.636353 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */
alter table "olist"."analytics_staging"."stg_orders__orders__dbt_tmp" rename to "stg_orders__orders"
[0m13:15:30.639462 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.643556 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: COMMIT
[0m13:15:30.644553 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.645551 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.646548 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:15:30.656521 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:15:30.660509 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: COMMIT
[0m13:15:30.662654 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: COMMIT
[0m13:15:30.663653 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */
drop table if exists "olist"."analytics_staging"."stg_order_items__order_items__dbt_backup" cascade
[0m13:15:30.664649 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:15:30.667953 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: COMMIT
[0m13:15:30.685904 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.692225 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:15:30.694221 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */
drop table if exists "olist"."analytics_staging"."stg_payments__payments__dbt_backup" cascade
[0m13:15:30.765064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.772285 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:15:30.773245 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */
drop table if exists "olist"."analytics_staging"."stg_customers__customers__dbt_backup" cascade
[0m13:15:30.840970 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.847125 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:15:30.849083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.850080 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.851078 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */
drop table if exists "olist"."analytics_staging"."stg_orders__orders__dbt_backup" cascade
[0m13:15:30.854069 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (execute): 13:15:30.275982 => 13:15:30.854069
[0m13:15:30.855066 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.857102 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (execute): 13:15:30.336970 => 13:15:30.857102
[0m13:15:30.859057 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: Close
[0m13:15:30.862162 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (execute): 13:15:30.345685 => 13:15:30.861050
[0m13:15:30.863162 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: Close
[0m13:15:30.865155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad430a5d-d5f5-4e14-a9f5-aa04f356534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7948963D0>]}
[0m13:15:30.866225 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: Close
[0m13:15:30.866225 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad430a5d-d5f5-4e14-a9f5-aa04f356534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7948ACD10>]}
[0m13:15:30.869750 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad430a5d-d5f5-4e14-a9f5-aa04f356534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7949CF290>]}
[0m13:15:30.869750 [info ] [Thread-1 (]: 1 of 6 OK created sql table model analytics_staging.stg_customers__customers ... [[32mOK[0m in 0.65s]
[0m13:15:30.869750 [info ] [Thread-2 (]: 2 of 6 OK created sql table model analytics_staging.stg_order_items__order_items  [[32mOK[0m in 0.65s]
[0m13:15:30.874757 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_customers__customers
[0m13:15:30.874757 [info ] [Thread-4 (]: 4 of 6 OK created sql table model analytics_staging.stg_payments__payments ..... [[32mOK[0m in 0.64s]
[0m13:15:30.879887 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_order_items__order_items
[0m13:15:30.881884 [debug] [Thread-1 (]: Began running node model.olist_project.stg_products__products
[0m13:15:30.883878 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_payments__payments
[0m13:15:30.885876 [debug] [Thread-2 (]: Began running node model.olist_project.stg_sellers__sellers
[0m13:15:30.886871 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics_staging.stg_products__products .......... [RUN]
[0m13:15:30.892245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_customers__customers, now model.olist_project.stg_products__products)
[0m13:15:30.889864 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics_staging.stg_sellers__sellers ............ [RUN]
[0m13:15:30.894242 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_products__products
[0m13:15:30.899228 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_order_items__order_items, now model.olist_project.stg_sellers__sellers)
[0m13:15:30.908204 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_products__products"
[0m13:15:30.911195 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_sellers__sellers
[0m13:15:30.919640 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_sellers__sellers"
[0m13:15:30.921636 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_products__products (compile): 13:15:30.900226 => 13:15:30.920638
[0m13:15:30.923630 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_products__products
[0m13:15:30.935633 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_products__products"
[0m13:15:30.937711 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_sellers__sellers (compile): 13:15:30.913366 => 13:15:30.936632
[0m13:15:30.939708 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_sellers__sellers
[0m13:15:30.949800 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_sellers__sellers"
[0m13:15:30.950796 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:15:30.952795 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: BEGIN
[0m13:15:30.953788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:30.954785 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:15:30.956779 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.956779 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: BEGIN
[0m13:15:30.958775 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:15:30.960770 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:15:30.962882 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_products__products__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from main.raw_product_category_translation
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m13:15:30.963881 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:15:30.965875 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:15:30.966987 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp"
  
    as (
      

with source as (
  select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
  from main.raw_sellers
)

select * from source
    );
  
  
[0m13:15:31.445927 [debug] [Thread-3 (]: SQL status: OK in 1.0 seconds
[0m13:15:31.449919 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (execute): 13:15:30.355658 => 13:15:31.448922
[0m13:15:31.450917 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:15:31.451914 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: Close
[0m13:15:31.458895 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:15:31.461888 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad430a5d-d5f5-4e14-a9f5-aa04f356534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E794850710>]}
[0m13:15:31.462885 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */
alter table "olist"."analytics_staging"."stg_sellers__sellers" rename to "stg_sellers__sellers__dbt_backup"
[0m13:15:31.466875 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:15:31.464879 [info ] [Thread-3 (]: 3 of 6 OK created sql table model analytics_staging.stg_orders__orders ......... [[32mOK[0m in 1.24s]
[0m13:15:31.474852 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:15:31.476851 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_orders__orders
[0m13:15:31.478843 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */
alter table "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp" rename to "stg_sellers__sellers"
[0m13:15:31.483833 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:15:31.487818 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: COMMIT
[0m13:15:31.488814 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:15:31.490810 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: COMMIT
[0m13:15:31.502778 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:15:31.508797 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:15:31.509759 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:15:31.510773 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */
drop table if exists "olist"."analytics_staging"."stg_sellers__sellers__dbt_backup" cascade
[0m13:15:31.517746 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:15:31.519454 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */
alter table "olist"."analytics_staging"."stg_products__products" rename to "stg_products__products__dbt_backup"
[0m13:15:31.520452 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:15:31.523480 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_sellers__sellers (execute): 13:15:30.940705 => 13:15:31.523480
[0m13:15:31.524476 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:15:31.525607 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: Close
[0m13:15:31.530715 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:15:31.532674 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad430a5d-d5f5-4e14-a9f5-aa04f356534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E79AAE2D10>]}
[0m13:15:31.533776 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */
alter table "olist"."analytics_staging"."stg_products__products__dbt_tmp" rename to "stg_products__products"
[0m13:15:31.534602 [info ] [Thread-2 (]: 6 of 6 OK created sql table model analytics_staging.stg_sellers__sellers ....... [[32mOK[0m in 0.63s]
[0m13:15:31.537598 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_sellers__sellers
[0m13:15:31.538597 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:15:31.595998 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: COMMIT
[0m13:15:31.596992 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:15:31.597992 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: COMMIT
[0m13:15:31.637801 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:15:31.642952 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:15:31.643950 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */
drop table if exists "olist"."analytics_staging"."stg_products__products__dbt_backup" cascade
[0m13:15:31.648440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:15:31.650438 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_products__products (execute): 13:15:30.924626 => 13:15:31.650438
[0m13:15:31.652434 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: Close
[0m13:15:31.755993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad430a5d-d5f5-4e14-a9f5-aa04f356534a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E79AAF47D0>]}
[0m13:15:31.756992 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics_staging.stg_products__products ..... [[32mOK[0m in 0.86s]
[0m13:15:31.759021 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_products__products
[0m13:15:31.763012 [debug] [MainThread]: Using duckdb connection "master"
[0m13:15:31.763972 [debug] [MainThread]: On master: BEGIN
[0m13:15:31.764971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:15:31.792269 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:15:31.793266 [debug] [MainThread]: On master: COMMIT
[0m13:15:31.794264 [debug] [MainThread]: Using duckdb connection "master"
[0m13:15:31.797257 [debug] [MainThread]: On master: COMMIT
[0m13:15:31.799268 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:15:31.800281 [debug] [MainThread]: On master: Close
[0m13:15:31.804275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:31.805272 [debug] [MainThread]: Connection 'create_olist_analytics_staging' was properly closed.
[0m13:15:31.806239 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m13:15:31.807228 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m13:15:31.808226 [debug] [MainThread]: Connection 'model.olist_project.stg_products__products' was properly closed.
[0m13:15:31.809223 [debug] [MainThread]: Connection 'model.olist_project.stg_sellers__sellers' was properly closed.
[0m13:15:31.810220 [debug] [MainThread]: Connection 'model.olist_project.stg_orders__orders' was properly closed.
[0m13:15:31.811218 [debug] [MainThread]: Connection 'model.olist_project.stg_payments__payments' was properly closed.
[0m13:15:31.813260 [info ] [MainThread]: 
[0m13:15:31.815209 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m13:15:31.818381 [debug] [MainThread]: Command end result
[0m13:15:31.837436 [info ] [MainThread]: 
[0m13:15:31.838436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:15:31.840429 [info ] [MainThread]: 
[0m13:15:31.841644 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:15:31.844641 [debug] [MainThread]: Command `dbt run` succeeded at 13:15:31.843640 after 2.75 seconds
[0m13:15:31.846631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E792A14910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78C7C9D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78C7C9990>]}
[0m13:15:31.847637 [debug] [MainThread]: Flushing usage events
[0m13:18:14.226815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CF4483390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CF3E0B150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CF3F5D910>]}


============================== 13:18:14.233772 | 57cd9ed7-c5d3-4203-a343-83be4a0338bc ==============================
[0m13:18:14.233772 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:18:14.235768 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m13:18:14.446215 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:18:14.448175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '57cd9ed7-c5d3-4203-a343-83be4a0338bc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CF45DDBD0>]}
[0m13:18:14.612860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57cd9ed7-c5d3-4203-a343-83be4a0338bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CF563EA10>]}
[0m13:18:14.749420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57cd9ed7-c5d3-4203-a343-83be4a0338bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CF449F6D0>]}
[0m13:18:14.752414 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m13:18:14.767411 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m13:18:14.872554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:18:14.873588 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:18:14.874549 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m13:18:14.885519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57cd9ed7-c5d3-4203-a343-83be4a0338bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CF5816810>]}
[0m13:18:14.913780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57cd9ed7-c5d3-4203-a343-83be4a0338bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CF4502950>]}
[0m13:18:14.914778 [info ] [MainThread]: Found 9 seeds, 6 models, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m13:18:14.916824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57cd9ed7-c5d3-4203-a343-83be4a0338bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CF572F890>]}
[0m13:18:14.921001 [info ] [MainThread]: 
[0m13:18:14.922996 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:18:14.924989 [debug] [MainThread]: Command end result
[0m13:18:14.941946 [debug] [MainThread]: Command `dbt test` succeeded at 13:18:14.940947 after 0.81 seconds
[0m13:18:14.944936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CF3F5D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CF3C01DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CED669990>]}
[0m13:18:14.948928 [debug] [MainThread]: Flushing usage events
[0m13:23:26.140029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF6451650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF5BAB490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF51F09D0>]}


============================== 13:23:26.146109 | c79f8949-628c-4dee-bee4-784b6a698b65 ==============================
[0m13:23:26.146109 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:23:26.147790 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt test', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m13:23:26.360336 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:23:26.361333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c79f8949-628c-4dee-bee4-784b6a698b65', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF5F0DE90>]}
[0m13:23:26.533907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c79f8949-628c-4dee-bee4-784b6a698b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF75EFB90>]}
[0m13:23:26.667417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c79f8949-628c-4dee-bee4-784b6a698b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF64AED10>]}
[0m13:23:26.670231 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m13:23:26.683199 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m13:23:26.870432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 6 files added, 0 files changed.
[0m13:23:26.872428 [debug] [MainThread]: Partial parsing: added file: olist_project://models\staging\stg_orders__orders.yml
[0m13:23:26.873421 [debug] [MainThread]: Partial parsing: added file: olist_project://models\staging\stg_order_items__order_items.yml
[0m13:23:26.874421 [debug] [MainThread]: Partial parsing: added file: olist_project://models\staging\stg_products__products.yml
[0m13:23:26.875418 [debug] [MainThread]: Partial parsing: added file: olist_project://models\staging\stg_customers__customers.yml
[0m13:23:26.876415 [debug] [MainThread]: Partial parsing: added file: olist_project://models\staging\stg_sellers__sellers.yml
[0m13:23:26.877413 [debug] [MainThread]: Partial parsing: added file: olist_project://models\staging\stg_payments__payments.yml
[0m13:23:27.154838 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m13:23:27.166963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c79f8949-628c-4dee-bee4-784b6a698b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF77BF990>]}
[0m13:23:27.195116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c79f8949-628c-4dee-bee4-784b6a698b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF7757250>]}
[0m13:23:27.198073 [info ] [MainThread]: Found 9 seeds, 6 models, 11 tests, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m13:23:27.200068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c79f8949-628c-4dee-bee4-784b6a698b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF77865D0>]}
[0m13:23:27.204092 [info ] [MainThread]: 
[0m13:23:27.206088 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:23:27.212072 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m13:23:27.214143 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m13:23:27.238077 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:23:27.243100 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:23:27.244065 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m13:23:27.245079 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m13:23:27.246057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:27.248053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:27.266718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:23:27.267717 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:23:27.268713 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:23:27.269709 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:23:27.270707 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m13:23:27.271706 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m13:23:27.345491 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:23:27.363444 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m13:23:27.364441 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:23:27.367433 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m13:23:27.371423 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m13:23:27.372420 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m13:23:27.374415 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m13:23:27.378403 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m13:23:27.384388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c79f8949-628c-4dee-bee4-784b6a698b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF77AD2D0>]}
[0m13:23:27.385386 [debug] [MainThread]: Using duckdb connection "master"
[0m13:23:27.386383 [debug] [MainThread]: On master: BEGIN
[0m13:23:27.387381 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:23:27.402340 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:23:27.403338 [debug] [MainThread]: On master: COMMIT
[0m13:23:27.404336 [debug] [MainThread]: Using duckdb connection "master"
[0m13:23:27.405333 [debug] [MainThread]: On master: COMMIT
[0m13:23:27.407326 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:23:27.408323 [debug] [MainThread]: On master: Close
[0m13:23:27.413407 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:23:27.414403 [info ] [MainThread]: 
[0m13:23:27.419530 [debug] [Thread-1 (]: Began running node test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57
[0m13:23:27.420528 [debug] [Thread-2 (]: Began running node test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d
[0m13:23:27.421525 [debug] [Thread-3 (]: Began running node test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec
[0m13:23:27.422525 [debug] [Thread-4 (]: Began running node test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb
[0m13:23:27.423519 [info ] [Thread-1 (]: 1 of 11 START test not_null_stg_customers__customers_customer_id ............... [RUN]
[0m13:23:27.425515 [info ] [Thread-2 (]: 2 of 11 START test not_null_stg_order_items__order_items_order_item_id ......... [RUN]
[0m13:23:27.427508 [info ] [Thread-3 (]: 3 of 11 START test not_null_stg_orders__orders_customer_id ..................... [RUN]
[0m13:23:27.432495 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57'
[0m13:23:27.435528 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d'
[0m13:23:27.429502 [info ] [Thread-4 (]: 4 of 11 START test not_null_stg_orders__orders_order_id ........................ [RUN]
[0m13:23:27.437521 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec'
[0m13:23:27.439476 [debug] [Thread-1 (]: Began compiling node test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57
[0m13:23:27.440474 [debug] [Thread-2 (]: Began compiling node test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d
[0m13:23:27.442468 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb'
[0m13:23:27.443467 [debug] [Thread-3 (]: Began compiling node test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec
[0m13:23:27.539210 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d"
[0m13:23:27.540207 [debug] [Thread-4 (]: Began compiling node test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb
[0m13:23:27.553172 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec"
[0m13:23:27.566138 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57"
[0m13:23:27.570128 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb"
[0m13:23:27.572122 [debug] [Thread-2 (]: Timing info for test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d (compile): 13:23:27.461419 => 13:23:27.571125
[0m13:23:27.575116 [debug] [Thread-3 (]: Timing info for test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec (compile): 13:23:27.542203 => 13:23:27.574117
[0m13:23:27.577109 [debug] [Thread-1 (]: Timing info for test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57 (compile): 13:23:27.444499 => 13:23:27.576112
[0m13:23:27.579103 [debug] [Thread-4 (]: Timing info for test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb (compile): 13:23:27.555168 => 13:23:27.579103
[0m13:23:27.581099 [debug] [Thread-2 (]: Began executing node test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d
[0m13:23:27.583094 [debug] [Thread-3 (]: Began executing node test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec
[0m13:23:27.584088 [debug] [Thread-1 (]: Began executing node test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57
[0m13:23:27.586084 [debug] [Thread-4 (]: Began executing node test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb
[0m13:23:27.674850 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d"
[0m13:23:27.678838 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec"
[0m13:23:27.732691 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57"
[0m13:23:27.737678 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb"
[0m13:23:27.740673 [debug] [Thread-2 (]: Using duckdb connection "test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d"
[0m13:23:27.741669 [debug] [Thread-2 (]: On test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d: BEGIN
[0m13:23:27.743663 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:23:27.758621 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:23:27.760618 [debug] [Thread-3 (]: Using duckdb connection "test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec"
[0m13:23:27.761613 [debug] [Thread-4 (]: Using duckdb connection "test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb"
[0m13:23:27.762747 [debug] [Thread-2 (]: Using duckdb connection "test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d"
[0m13:23:27.764745 [debug] [Thread-1 (]: Using duckdb connection "test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57"
[0m13:23:27.764745 [debug] [Thread-3 (]: On test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec: BEGIN
[0m13:23:27.766770 [debug] [Thread-4 (]: On test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb: BEGIN
[0m13:23:27.766770 [debug] [Thread-2 (]: On test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_item_id
from "olist"."analytics_staging"."stg_order_items__order_items"
where order_item_id is null



      
    ) dbt_internal_test
[0m13:23:27.769293 [debug] [Thread-1 (]: On test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57: BEGIN
[0m13:23:27.769293 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:23:27.769293 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:23:27.769293 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:23:27.769293 [debug] [Thread-2 (]: Timing info for test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d (execute): 13:23:27.587081 => 13:23:27.769293
[0m13:23:27.769293 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:23:27.779596 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:23:27.779596 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:23:27.779596 [debug] [Thread-2 (]: On test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d: ROLLBACK
[0m13:23:27.779596 [debug] [Thread-3 (]: Using duckdb connection "test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec"
[0m13:23:27.779596 [debug] [Thread-4 (]: Using duckdb connection "test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb"
[0m13:23:27.779596 [debug] [Thread-1 (]: Using duckdb connection "test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57"
[0m13:23:27.779596 [debug] [Thread-3 (]: On test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "olist"."analytics_staging"."stg_orders__orders"
where customer_id is null



      
    ) dbt_internal_test
[0m13:23:27.789641 [debug] [Thread-4 (]: On test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "olist"."analytics_staging"."stg_orders__orders"
where order_id is null



      
    ) dbt_internal_test
[0m13:23:27.789641 [debug] [Thread-1 (]: On test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "olist"."analytics_staging"."stg_customers__customers"
where customer_id is null



      
    ) dbt_internal_test
[0m13:23:27.796254 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:23:27.797252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:23:27.798248 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:23:27.803238 [debug] [Thread-4 (]: Timing info for test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb (execute): 13:23:27.733688 => 13:23:27.802239
[0m13:23:27.806227 [debug] [Thread-1 (]: Timing info for test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57 (execute): 13:23:27.679834 => 13:23:27.806227
[0m13:23:27.810219 [debug] [Thread-3 (]: Timing info for test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec (execute): 13:23:27.612014 => 13:23:27.809221
[0m13:23:27.811216 [debug] [Thread-4 (]: On test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb: ROLLBACK
[0m13:23:27.812379 [debug] [Thread-1 (]: On test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57: ROLLBACK
[0m13:23:27.813379 [debug] [Thread-3 (]: On test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec: ROLLBACK
[0m13:23:27.815373 [debug] [Thread-4 (]: Failed to rollback 'test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb'
[0m13:23:27.817010 [debug] [Thread-1 (]: Failed to rollback 'test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57'
[0m13:23:27.819006 [debug] [Thread-3 (]: Failed to rollback 'test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec'
[0m13:23:27.820004 [debug] [Thread-4 (]: On test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb: Close
[0m13:23:27.821999 [debug] [Thread-1 (]: On test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57: Close
[0m13:23:27.822993 [debug] [Thread-3 (]: On test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec: Close
[0m13:23:27.824778 [info ] [Thread-4 (]: 4 of 11 PASS not_null_stg_orders__orders_order_id .............................. [[32mPASS[0m in 0.38s]
[0m13:23:27.826771 [info ] [Thread-1 (]: 1 of 11 PASS not_null_stg_customers__customers_customer_id ..................... [[32mPASS[0m in 0.40s]
[0m13:23:27.831758 [debug] [Thread-4 (]: Finished running node test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb
[0m13:23:27.828768 [info ] [Thread-3 (]: 3 of 11 PASS not_null_stg_orders__orders_customer_id ........................... [[32mPASS[0m in 0.39s]
[0m13:23:27.833752 [debug] [Thread-1 (]: Finished running node test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57
[0m13:23:27.835747 [debug] [Thread-4 (]: Began running node test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2
[0m13:23:27.837742 [debug] [Thread-3 (]: Finished running node test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec
[0m13:23:27.839736 [debug] [Thread-1 (]: Began running node test.olist_project.not_null_stg_products__products_product_id.24f0101a0d
[0m13:23:27.845720 [debug] [Thread-2 (]: Failed to rollback 'test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d'
[0m13:23:27.841734 [info ] [Thread-4 (]: 5 of 11 START test not_null_stg_payments__payments_order_id .................... [RUN]
[0m13:23:27.846717 [debug] [Thread-3 (]: Began running node test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf
[0m13:23:27.853700 [debug] [Thread-2 (]: On test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d: Close
[0m13:23:27.851705 [info ] [Thread-1 (]: 6 of 11 START test not_null_stg_products__products_product_id .................. [RUN]
[0m13:23:27.855694 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb, now test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2)
[0m13:23:27.857690 [info ] [Thread-3 (]: 7 of 11 START test not_null_stg_sellers__sellers_seller_id ..................... [RUN]
[0m13:23:27.867666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57, now test.olist_project.not_null_stg_products__products_product_id.24f0101a0d)
[0m13:23:27.869657 [debug] [Thread-4 (]: Began compiling node test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2
[0m13:23:27.872649 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_order_items__order_items_order_item_id (models\staging\stg_order_items__order_items.yml)
  Binder Error: Referenced column "order_item_id" not found in FROM clause!
  Candidate bindings: "stg_order_items__order_items.product_id"
  LINE 15: where order_item_id is null
                 ^
[0m13:23:27.874644 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec, now test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf)
[0m13:23:27.875640 [debug] [Thread-1 (]: Began compiling node test.olist_project.not_null_stg_products__products_product_id.24f0101a0d
[0m13:23:27.885614 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2"
[0m13:23:27.887609 [error] [Thread-2 (]: 2 of 11 ERROR not_null_stg_order_items__order_items_order_item_id .............. [[31mERROR[0m in 0.45s]
[0m13:23:27.888606 [debug] [Thread-3 (]: Began compiling node test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf
[0m13:23:27.907555 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_project.not_null_stg_products__products_product_id.24f0101a0d"
[0m13:23:27.909550 [debug] [Thread-2 (]: Finished running node test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d
[0m13:23:27.919524 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf"
[0m13:23:27.921518 [debug] [Thread-4 (]: Timing info for test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2 (compile): 13:23:27.876638 => 13:23:27.920521
[0m13:23:27.923513 [debug] [Thread-2 (]: Began running node test.olist_project.unique_stg_customers__customers_customer_id.1950433078
[0m13:23:27.925506 [debug] [Thread-4 (]: Began executing node test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2
[0m13:23:27.928500 [debug] [Thread-1 (]: Timing info for test.olist_project.not_null_stg_products__products_product_id.24f0101a0d (compile): 13:23:27.893595 => 13:23:27.928500
[0m13:23:27.927503 [info ] [Thread-2 (]: 8 of 11 START test unique_stg_customers__customers_customer_id ................. [RUN]
[0m13:23:27.938472 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2"
[0m13:23:27.938472 [debug] [Thread-3 (]: Timing info for test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf (compile): 13:23:27.909550 => 13:23:27.938472
[0m13:23:27.939469 [debug] [Thread-1 (]: Began executing node test.olist_project.not_null_stg_products__products_product_id.24f0101a0d
[0m13:23:27.941466 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d, now test.olist_project.unique_stg_customers__customers_customer_id.1950433078)
[0m13:23:27.943461 [debug] [Thread-3 (]: Began executing node test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf
[0m13:23:27.950446 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_project.not_null_stg_products__products_product_id.24f0101a0d"
[0m13:23:27.952436 [debug] [Thread-2 (]: Began compiling node test.olist_project.unique_stg_customers__customers_customer_id.1950433078
[0m13:23:27.953436 [debug] [Thread-4 (]: Using duckdb connection "test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2"
[0m13:23:27.957422 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf"
[0m13:23:27.972381 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_project.unique_stg_customers__customers_customer_id.1950433078"
[0m13:23:27.973379 [debug] [Thread-4 (]: On test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2: BEGIN
[0m13:23:27.975374 [debug] [Thread-1 (]: Using duckdb connection "test.olist_project.not_null_stg_products__products_product_id.24f0101a0d"
[0m13:23:27.977368 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:23:27.978377 [debug] [Thread-1 (]: On test.olist_project.not_null_stg_products__products_product_id.24f0101a0d: BEGIN
[0m13:23:27.980360 [debug] [Thread-2 (]: Timing info for test.olist_project.unique_stg_customers__customers_customer_id.1950433078 (compile): 13:23:27.958418 => 13:23:27.979365
[0m13:23:27.997624 [debug] [Thread-3 (]: Using duckdb connection "test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf"
[0m13:23:27.999619 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:23:28.000616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:28.001615 [debug] [Thread-2 (]: Began executing node test.olist_project.unique_stg_customers__customers_customer_id.1950433078
[0m13:23:28.002611 [debug] [Thread-3 (]: On test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf: BEGIN
[0m13:23:28.003609 [debug] [Thread-4 (]: Using duckdb connection "test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2"
[0m13:23:28.004606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:23:28.008595 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_project.unique_stg_customers__customers_customer_id.1950433078"
[0m13:23:28.009591 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:23:28.011587 [debug] [Thread-4 (]: On test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "olist"."analytics_staging"."stg_payments__payments"
where order_id is null



      
    ) dbt_internal_test
[0m13:23:28.012585 [debug] [Thread-1 (]: Using duckdb connection "test.olist_project.not_null_stg_products__products_product_id.24f0101a0d"
[0m13:23:28.015578 [debug] [Thread-2 (]: Using duckdb connection "test.olist_project.unique_stg_customers__customers_customer_id.1950433078"
[0m13:23:28.016576 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:23:28.018572 [debug] [Thread-1 (]: On test.olist_project.not_null_stg_products__products_product_id.24f0101a0d: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.not_null_stg_products__products_product_id.24f0101a0d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "olist"."analytics_staging"."stg_products__products"
where product_id is null



      
    ) dbt_internal_test
[0m13:23:28.019565 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:23:28.019565 [debug] [Thread-2 (]: On test.olist_project.unique_stg_customers__customers_customer_id.1950433078: BEGIN
[0m13:23:28.021561 [debug] [Thread-3 (]: Using duckdb connection "test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf"
[0m13:23:28.024552 [debug] [Thread-4 (]: Timing info for test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2 (execute): 13:23:27.930493 => 13:23:28.024552
[0m13:23:28.030537 [debug] [Thread-4 (]: On test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2: ROLLBACK
[0m13:23:28.025550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:23:28.028542 [debug] [Thread-3 (]: On test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_id
from "olist"."analytics_staging"."stg_sellers__sellers"
where seller_id is null



      
    ) dbt_internal_test
[0m13:23:28.027544 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:23:28.032531 [debug] [Thread-4 (]: Failed to rollback 'test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2'
[0m13:23:28.034525 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:23:28.038636 [debug] [Thread-1 (]: Timing info for test.olist_project.not_null_stg_products__products_product_id.24f0101a0d (execute): 13:23:27.944456 => 13:23:28.037635
[0m13:23:28.039634 [debug] [Thread-4 (]: On test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2: Close
[0m13:23:28.040628 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:23:28.042125 [debug] [Thread-2 (]: Using duckdb connection "test.olist_project.unique_stg_customers__customers_customer_id.1950433078"
[0m13:23:28.043123 [debug] [Thread-1 (]: On test.olist_project.not_null_stg_products__products_product_id.24f0101a0d: ROLLBACK
[0m13:23:28.048109 [debug] [Thread-3 (]: Timing info for test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf (execute): 13:23:27.954430 => 13:23:28.047113
[0m13:23:28.045118 [info ] [Thread-4 (]: 5 of 11 PASS not_null_stg_payments__payments_order_id .......................... [[32mPASS[0m in 0.19s]
[0m13:23:28.049108 [debug] [Thread-2 (]: On test.olist_project.unique_stg_customers__customers_customer_id.1950433078: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.unique_stg_customers__customers_customer_id.1950433078"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "olist"."analytics_staging"."stg_customers__customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:23:28.051102 [debug] [Thread-1 (]: Failed to rollback 'test.olist_project.not_null_stg_products__products_product_id.24f0101a0d'
[0m13:23:28.051102 [debug] [Thread-3 (]: On test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf: ROLLBACK
[0m13:23:28.053096 [debug] [Thread-4 (]: Finished running node test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2
[0m13:23:28.055153 [debug] [Thread-1 (]: On test.olist_project.not_null_stg_products__products_product_id.24f0101a0d: Close
[0m13:23:28.057151 [debug] [Thread-3 (]: Failed to rollback 'test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf'
[0m13:23:28.059147 [debug] [Thread-4 (]: Began running node test.olist_project.unique_stg_orders__orders_order_id.6aa4906960
[0m13:23:28.063135 [debug] [Thread-3 (]: On test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf: Close
[0m13:23:28.062137 [info ] [Thread-1 (]: 6 of 11 PASS not_null_stg_products__products_product_id ........................ [[32mPASS[0m in 0.19s]
[0m13:23:28.072111 [debug] [Thread-1 (]: Finished running node test.olist_project.not_null_stg_products__products_product_id.24f0101a0d
[0m13:23:28.073108 [debug] [Thread-1 (]: Began running node test.olist_project.unique_stg_products__products_product_id.380ababbc0
[0m13:23:28.066128 [info ] [Thread-4 (]: 9 of 11 START test unique_stg_orders__orders_order_id .......................... [RUN]
[0m13:23:28.069119 [info ] [Thread-3 (]: 7 of 11 PASS not_null_stg_sellers__sellers_seller_id ........................... [[32mPASS[0m in 0.19s]
[0m13:23:28.078096 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2, now test.olist_project.unique_stg_orders__orders_order_id.6aa4906960)
[0m13:23:28.075103 [info ] [Thread-1 (]: 10 of 11 START test unique_stg_products__products_product_id ................... [RUN]
[0m13:23:28.082084 [debug] [Thread-3 (]: Finished running node test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf
[0m13:23:28.090063 [debug] [Thread-3 (]: Began running node test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a
[0m13:23:28.084079 [debug] [Thread-4 (]: Began compiling node test.olist_project.unique_stg_orders__orders_order_id.6aa4906960
[0m13:23:28.088069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_project.not_null_stg_products__products_product_id.24f0101a0d, now test.olist_project.unique_stg_products__products_product_id.380ababbc0)
[0m13:23:28.106020 [debug] [Thread-1 (]: Began compiling node test.olist_project.unique_stg_products__products_product_id.380ababbc0
[0m13:23:28.126964 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_project.unique_stg_orders__orders_order_id.6aa4906960"
[0m13:23:28.091061 [info ] [Thread-3 (]: 11 of 11 START test unique_stg_sellers__sellers_seller_id ...................... [RUN]
[0m13:23:28.128959 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_project.unique_stg_products__products_product_id.380ababbc0"
[0m13:23:28.128959 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:23:28.131951 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf, now test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a)
[0m13:23:28.134945 [debug] [Thread-4 (]: Timing info for test.olist_project.unique_stg_orders__orders_order_id.6aa4906960 (compile): 13:23:28.094052 => 13:23:28.133946
[0m13:23:28.137935 [debug] [Thread-2 (]: Timing info for test.olist_project.unique_stg_customers__customers_customer_id.1950433078 (execute): 13:23:28.005603 => 13:23:28.137935
[0m13:23:28.138932 [debug] [Thread-3 (]: Began compiling node test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a
[0m13:23:28.140929 [debug] [Thread-1 (]: Timing info for test.olist_project.unique_stg_products__products_product_id.380ababbc0 (compile): 13:23:28.108017 => 13:23:28.139929
[0m13:23:28.141925 [debug] [Thread-4 (]: Began executing node test.olist_project.unique_stg_orders__orders_order_id.6aa4906960
[0m13:23:28.142922 [debug] [Thread-2 (]: On test.olist_project.unique_stg_customers__customers_customer_id.1950433078: ROLLBACK
[0m13:23:28.149905 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a"
[0m13:23:28.150900 [debug] [Thread-1 (]: Began executing node test.olist_project.unique_stg_products__products_product_id.380ababbc0
[0m13:23:28.154889 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_project.unique_stg_orders__orders_order_id.6aa4906960"
[0m13:23:28.155887 [debug] [Thread-2 (]: Failed to rollback 'test.olist_project.unique_stg_customers__customers_customer_id.1950433078'
[0m13:23:28.162868 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_project.unique_stg_products__products_product_id.380ababbc0"
[0m13:23:28.164863 [debug] [Thread-2 (]: On test.olist_project.unique_stg_customers__customers_customer_id.1950433078: Close
[0m13:23:28.166857 [debug] [Thread-3 (]: Timing info for test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a (compile): 13:23:28.143919 => 13:23:28.165860
[0m13:23:28.167854 [debug] [Thread-4 (]: Using duckdb connection "test.olist_project.unique_stg_orders__orders_order_id.6aa4906960"
[0m13:23:28.174835 [debug] [Thread-3 (]: Began executing node test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a
[0m13:23:28.175833 [debug] [Thread-1 (]: Using duckdb connection "test.olist_project.unique_stg_products__products_product_id.380ababbc0"
[0m13:23:28.173838 [info ] [Thread-2 (]: 8 of 11 PASS unique_stg_customers__customers_customer_id ....................... [[32mPASS[0m in 0.23s]
[0m13:23:28.176831 [debug] [Thread-4 (]: On test.olist_project.unique_stg_orders__orders_order_id.6aa4906960: BEGIN
[0m13:23:28.180819 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a"
[0m13:23:28.182817 [debug] [Thread-1 (]: On test.olist_project.unique_stg_products__products_product_id.380ababbc0: BEGIN
[0m13:23:28.184810 [debug] [Thread-2 (]: Finished running node test.olist_project.unique_stg_customers__customers_customer_id.1950433078
[0m13:23:28.186905 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:23:28.187903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:28.189899 [debug] [Thread-3 (]: Using duckdb connection "test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a"
[0m13:23:28.206853 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:23:28.207850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:23:28.208847 [debug] [Thread-3 (]: On test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a: BEGIN
[0m13:23:28.209845 [debug] [Thread-4 (]: Using duckdb connection "test.olist_project.unique_stg_orders__orders_order_id.6aa4906960"
[0m13:23:28.210845 [debug] [Thread-1 (]: Using duckdb connection "test.olist_project.unique_stg_products__products_product_id.380ababbc0"
[0m13:23:28.211975 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:23:28.212974 [debug] [Thread-4 (]: On test.olist_project.unique_stg_orders__orders_order_id.6aa4906960: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.unique_stg_orders__orders_order_id.6aa4906960"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "olist"."analytics_staging"."stg_orders__orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:23:28.213971 [debug] [Thread-1 (]: On test.olist_project.unique_stg_products__products_product_id.380ababbc0: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.unique_stg_products__products_product_id.380ababbc0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "olist"."analytics_staging"."stg_products__products"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:23:28.215966 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:23:28.218958 [debug] [Thread-3 (]: Using duckdb connection "test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a"
[0m13:23:28.220954 [debug] [Thread-3 (]: On test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "olist"."analytics_staging"."stg_sellers__sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:23:28.232921 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:23:28.236911 [debug] [Thread-3 (]: Timing info for test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a (execute): 13:23:28.177828 => 13:23:28.236911
[0m13:23:28.238904 [debug] [Thread-3 (]: On test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a: ROLLBACK
[0m13:23:28.239902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:23:28.241896 [debug] [Thread-3 (]: Failed to rollback 'test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a'
[0m13:23:28.244888 [debug] [Thread-1 (]: Timing info for test.olist_project.unique_stg_products__products_product_id.380ababbc0 (execute): 13:23:28.157882 => 13:23:28.244888
[0m13:23:28.246882 [debug] [Thread-3 (]: On test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a: Close
[0m13:23:28.248877 [debug] [Thread-1 (]: On test.olist_project.unique_stg_products__products_product_id.380ababbc0: ROLLBACK
[0m13:23:28.252869 [debug] [Thread-1 (]: Failed to rollback 'test.olist_project.unique_stg_products__products_product_id.380ababbc0'
[0m13:23:28.250872 [info ] [Thread-3 (]: 11 of 11 PASS unique_stg_sellers__sellers_seller_id ............................ [[32mPASS[0m in 0.12s]
[0m13:23:28.253864 [debug] [Thread-1 (]: On test.olist_project.unique_stg_products__products_product_id.380ababbc0: Close
[0m13:23:28.256858 [debug] [Thread-3 (]: Finished running node test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a
[0m13:23:28.259850 [info ] [Thread-1 (]: 10 of 11 PASS unique_stg_products__products_product_id ......................... [[32mPASS[0m in 0.17s]
[0m13:23:28.263840 [debug] [Thread-1 (]: Finished running node test.olist_project.unique_stg_products__products_product_id.380ababbc0
[0m13:23:28.266830 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:23:28.269822 [debug] [Thread-4 (]: Timing info for test.olist_project.unique_stg_orders__orders_order_id.6aa4906960 (execute): 13:23:28.151899 => 13:23:28.269822
[0m13:23:28.271816 [debug] [Thread-4 (]: On test.olist_project.unique_stg_orders__orders_order_id.6aa4906960: ROLLBACK
[0m13:23:28.272815 [debug] [Thread-4 (]: Failed to rollback 'test.olist_project.unique_stg_orders__orders_order_id.6aa4906960'
[0m13:23:28.273812 [debug] [Thread-4 (]: On test.olist_project.unique_stg_orders__orders_order_id.6aa4906960: Close
[0m13:23:28.282786 [info ] [Thread-4 (]: 9 of 11 PASS unique_stg_orders__orders_order_id ................................ [[32mPASS[0m in 0.20s]
[0m13:23:28.285779 [debug] [Thread-4 (]: Finished running node test.olist_project.unique_stg_orders__orders_order_id.6aa4906960
[0m13:23:28.288771 [debug] [MainThread]: Using duckdb connection "master"
[0m13:23:28.289781 [debug] [MainThread]: On master: BEGIN
[0m13:23:28.291763 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:23:28.318800 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:23:28.319796 [debug] [MainThread]: On master: COMMIT
[0m13:23:28.320796 [debug] [MainThread]: Using duckdb connection "master"
[0m13:23:28.321792 [debug] [MainThread]: On master: COMMIT
[0m13:23:28.322787 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:23:28.323785 [debug] [MainThread]: On master: Close
[0m13:23:28.327775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:28.327775 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m13:23:28.328772 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m13:23:28.329769 [debug] [MainThread]: Connection 'test.olist_project.unique_stg_products__products_product_id.380ababbc0' was properly closed.
[0m13:23:28.330766 [debug] [MainThread]: Connection 'test.olist_project.unique_stg_customers__customers_customer_id.1950433078' was properly closed.
[0m13:23:28.331764 [debug] [MainThread]: Connection 'test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a' was properly closed.
[0m13:23:28.332761 [debug] [MainThread]: Connection 'test.olist_project.unique_stg_orders__orders_order_id.6aa4906960' was properly closed.
[0m13:23:28.334756 [info ] [MainThread]: 
[0m13:23:28.335753 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m13:23:28.340740 [debug] [MainThread]: Command end result
[0m13:23:28.360456 [info ] [MainThread]: 
[0m13:23:28.361576 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:23:28.363572 [info ] [MainThread]: 
[0m13:23:28.364569 [error] [MainThread]:   Runtime Error in test not_null_stg_order_items__order_items_order_item_id (models\staging\stg_order_items__order_items.yml)
  Binder Error: Referenced column "order_item_id" not found in FROM clause!
  Candidate bindings: "stg_order_items__order_items.product_id"
  LINE 15: where order_item_id is null
                 ^
[0m13:23:28.367563 [info ] [MainThread]: 
[0m13:23:28.370557 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m13:23:28.373545 [debug] [MainThread]: Command `dbt test` failed at 13:23:28.372548 after 2.34 seconds
[0m13:23:28.374542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF584AA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF77A5290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF5BAEB10>]}
[0m13:23:28.376537 [debug] [MainThread]: Flushing usage events
[0m13:25:09.903835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFE3EB1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFE3E9ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFE3E8BD0>]}


============================== 13:25:09.912402 | 9c54c074-3bda-481a-a418-72870f576bfc ==============================
[0m13:25:09.912402 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:25:09.914397 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m13:25:10.145591 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:25:10.147551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9c54c074-3bda-481a-a418-72870f576bfc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFD873950>]}
[0m13:25:10.312664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c54c074-3bda-481a-a418-72870f576bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFE49A9D0>]}
[0m13:25:10.449916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c54c074-3bda-481a-a418-72870f576bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFE55A6D0>]}
[0m13:25:10.452142 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m13:25:10.468958 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m13:25:10.616900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:25:10.617936 [debug] [MainThread]: Partial parsing: updated file: olist_project://models\staging\stg_order_items__order_items.sql
[0m13:25:10.619895 [debug] [MainThread]: Partial parsing: updated file: olist_project://models\staging\stg_products__products.sql
[0m13:25:11.103636 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m13:25:11.115606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c54c074-3bda-481a-a418-72870f576bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFF98CB10>]}
[0m13:25:11.145488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c54c074-3bda-481a-a418-72870f576bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFFA9B890>]}
[0m13:25:11.148517 [info ] [MainThread]: Found 9 seeds, 6 models, 11 tests, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m13:25:11.149477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c54c074-3bda-481a-a418-72870f576bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFF5997D0>]}
[0m13:25:11.154468 [info ] [MainThread]: 
[0m13:25:11.157456 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:25:11.163574 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m13:25:11.192871 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m13:25:11.195828 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"olist"'
    
  
  
[0m13:25:11.196823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:11.217802 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:25:11.220759 [debug] [ThreadPool]: On list_olist: Close
[0m13:25:11.224757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_analytics_staging)
[0m13:25:11.227739 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "analytics_staging"
"
[0m13:25:11.301579 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:25:11.302577 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
        select type from duckdb_databases()
        where database_name='olist'
        and type='sqlite'
    
  
[0m13:25:11.303537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:11.319492 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:25:11.322485 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:25:11.324481 [debug] [ThreadPool]: On create_olist_analytics_staging: BEGIN
[0m13:25:11.326476 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:25:11.327472 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:25:11.329469 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
    
        create schema if not exists "olist"."analytics_staging"
    
[0m13:25:11.330464 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:25:11.332463 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m13:25:11.333491 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:25:11.335452 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m13:25:11.336487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:25:11.338444 [debug] [ThreadPool]: On create_olist_analytics_staging: Close
[0m13:25:11.345424 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m13:25:11.348416 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m13:25:11.358389 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:25:11.365045 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:25:11.366079 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m13:25:11.367040 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m13:25:11.368037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:11.369035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:11.388310 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:25:11.389306 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:25:11.390304 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:25:11.391301 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:25:11.392478 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m13:25:11.393477 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m13:25:11.474260 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:25:11.485231 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:25:11.489221 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m13:25:11.492212 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m13:25:11.493209 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m13:25:11.495207 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m13:25:11.496203 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m13:25:11.498196 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m13:25:11.506175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c54c074-3bda-481a-a418-72870f576bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFFA7CA10>]}
[0m13:25:11.507172 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:11.508169 [debug] [MainThread]: On master: BEGIN
[0m13:25:11.509168 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:11.529115 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:25:11.530112 [debug] [MainThread]: On master: COMMIT
[0m13:25:11.532107 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:11.532107 [debug] [MainThread]: On master: COMMIT
[0m13:25:11.534101 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:25:11.535098 [debug] [MainThread]: On master: Close
[0m13:25:11.539087 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:25:11.540085 [info ] [MainThread]: 
[0m13:25:11.547065 [debug] [Thread-1 (]: Began running node model.olist_project.stg_customers__customers
[0m13:25:11.547065 [debug] [Thread-2 (]: Began running node model.olist_project.stg_order_items__order_items
[0m13:25:11.548063 [debug] [Thread-3 (]: Began running node model.olist_project.stg_orders__orders
[0m13:25:11.549072 [debug] [Thread-4 (]: Began running node model.olist_project.stg_payments__payments
[0m13:25:11.549072 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_customers__customers ........ [RUN]
[0m13:25:11.551057 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_order_items__order_items .... [RUN]
[0m13:25:11.553051 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_orders__orders .............. [RUN]
[0m13:25:11.557040 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_project.stg_customers__customers'
[0m13:25:11.555047 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_staging.stg_payments__payments .......... [RUN]
[0m13:25:11.560031 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_project.stg_order_items__order_items'
[0m13:25:11.563024 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_project.stg_orders__orders'
[0m13:25:11.565018 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_customers__customers
[0m13:25:11.567015 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_project.stg_payments__payments'
[0m13:25:11.568013 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_order_items__order_items
[0m13:25:11.570006 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_orders__orders
[0m13:25:11.588953 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_customers__customers"
[0m13:25:11.589957 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_payments__payments
[0m13:25:11.595936 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_order_items__order_items"
[0m13:25:11.602916 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_orders__orders"
[0m13:25:11.610897 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_payments__payments"
[0m13:25:11.612890 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (compile): 13:25:11.571002 => 13:25:11.611894
[0m13:25:11.615882 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (compile): 13:25:11.590950 => 13:25:11.614885
[0m13:25:11.617739 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (compile): 13:25:11.596934 => 13:25:11.616914
[0m13:25:11.618735 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_customers__customers
[0m13:25:11.620803 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_order_items__order_items
[0m13:25:11.621729 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_orders__orders
[0m13:25:11.623722 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (compile): 13:25:11.603915 => 13:25:11.622726
[0m13:25:11.680570 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_customers__customers"
[0m13:25:11.688548 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_order_items__order_items"
[0m13:25:11.698522 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_orders__orders"
[0m13:25:11.699519 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_payments__payments
[0m13:25:11.702511 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:25:11.711487 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_payments__payments"
[0m13:25:11.712487 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:25:11.713482 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:25:11.714480 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: BEGIN
[0m13:25:11.716476 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: BEGIN
[0m13:25:11.717471 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: BEGIN
[0m13:25:11.718469 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:25:11.719466 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:25:11.720462 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:25:11.721461 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:25:11.722460 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: BEGIN
[0m13:25:11.738416 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:25:11.739414 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:25:11.741409 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:11.741409 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:25:11.742407 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:25:11.743403 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:25:11.744399 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:25:11.746397 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:25:11.748389 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_customers__customers__dbt_tmp"
  
    as (
      

with source as (
  select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
  from main.raw_customers
)

select
  customer_id,
  customer_unique_id,
  customer_zip_code_prefix,
  customer_city,
  customer_state
from source
    );
  
  
[0m13:25:11.749386 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp"
  
    as (
      

select
  order_item_id,
  order_id,
  product_id,
  seller_id,
  shipping_limit_date,
  price,
  freight_value
from "olist"."main"."raw_order_items"
    );
  
  
[0m13:25:11.751381 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_orders__orders__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
  from "olist"."main"."raw_orders"
)


, cleaned as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_at,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_at,
    order_delivered_customer_date::timestamp as order_delivered_customer_at,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_at,
    case 
      when order_delivered_customer_date is not null 
      then date_diff('day', order_purchase_timestamp::timestamp, order_delivered_customer_date::timestamp)
      else null 
    end as days_to_delivery,
    case
      when order_delivered_customer_date > order_estimated_delivery_date then true
      else false
    end as is_late_delivery
  from source
)

select * from cleaned
    );
  
  
[0m13:25:11.752413 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:25:11.755376 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_payments__payments__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
  from main.raw_order_payments
)

select * from source
    );
  
  
[0m13:25:11.952351 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:25:11.967315 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:25:11.968314 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:25:11.970305 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */
alter table "olist"."analytics_staging"."stg_payments__payments" rename to "stg_payments__payments__dbt_backup"
[0m13:25:11.977285 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:25:11.980281 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */
alter table "olist"."analytics_staging"."stg_order_items__order_items" rename to "stg_order_items__order_items__dbt_backup"
[0m13:25:11.981275 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:25:11.990250 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:25:11.991248 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:25:11.992246 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */
alter table "olist"."analytics_staging"."stg_payments__payments__dbt_tmp" rename to "stg_payments__payments"
[0m13:25:12.001221 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:25:12.003220 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */
alter table "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp" rename to "stg_order_items__order_items"
[0m13:25:12.004214 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.027261 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.050521 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: COMMIT
[0m13:25:12.055506 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: COMMIT
[0m13:25:12.056504 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.057502 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.058499 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:25:12.059507 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:25:12.066591 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:25:12.072575 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:25:12.073572 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: COMMIT
[0m13:25:12.075569 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: COMMIT
[0m13:25:12.076566 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */
alter table "olist"."analytics_staging"."stg_customers__customers" rename to "stg_customers__customers__dbt_backup"
[0m13:25:12.077566 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */
alter table "olist"."analytics_staging"."stg_orders__orders" rename to "stg_orders__orders__dbt_backup"
[0m13:25:12.081552 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.083547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.090529 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:25:12.098508 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:25:12.099504 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */
alter table "olist"."analytics_staging"."stg_orders__orders__dbt_tmp" rename to "stg_orders__orders"
[0m13:25:12.101499 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */
alter table "olist"."analytics_staging"."stg_customers__customers__dbt_tmp" rename to "stg_customers__customers"
[0m13:25:12.103494 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.109477 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: COMMIT
[0m13:25:12.111799 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.113215 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:25:12.118201 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: COMMIT
[0m13:25:12.119199 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: COMMIT
[0m13:25:12.120196 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:25:12.122190 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: COMMIT
[0m13:25:12.146127 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.157101 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:25:12.159093 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */
drop table if exists "olist"."analytics_staging"."stg_payments__payments__dbt_backup" cascade
[0m13:25:12.268060 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.276039 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:25:12.277036 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */
drop table if exists "olist"."analytics_staging"."stg_order_items__order_items__dbt_backup" cascade
[0m13:25:12.357072 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.363286 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:25:12.365307 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */
drop table if exists "olist"."analytics_staging"."stg_orders__orders__dbt_backup" cascade
[0m13:25:12.433891 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.439874 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:25:12.440873 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.441868 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */
drop table if exists "olist"."analytics_staging"."stg_customers__customers__dbt_backup" cascade
[0m13:25:12.444861 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (execute): 13:25:11.689546 => 13:25:12.443865
[0m13:25:12.446856 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: Close
[0m13:25:12.447853 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.449849 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.450845 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c54c074-3bda-481a-a418-72870f576bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFFB1F6D0>]}
[0m13:25:12.454835 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (execute): 13:25:11.681567 => 13:25:12.453838
[0m13:25:12.456830 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (execute): 13:25:11.703508 => 13:25:12.456830
[0m13:25:12.459822 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: Close
[0m13:25:12.458860 [info ] [Thread-3 (]: 3 of 6 OK created sql table model analytics_staging.stg_orders__orders ......... [[32mOK[0m in 0.89s]
[0m13:25:12.462022 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: Close
[0m13:25:12.464021 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c54c074-3bda-481a-a418-72870f576bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFE49FE90>]}
[0m13:25:12.466012 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_orders__orders
[0m13:25:12.468007 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c54c074-3bda-481a-a418-72870f576bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFF8C5550>]}
[0m13:25:12.470002 [debug] [Thread-3 (]: Began running node model.olist_project.stg_products__products
[0m13:25:12.469004 [info ] [Thread-2 (]: 2 of 6 OK created sql table model analytics_staging.stg_order_items__order_items  [[32mOK[0m in 0.90s]
[0m13:25:12.471998 [info ] [Thread-4 (]: 4 of 6 OK created sql table model analytics_staging.stg_payments__payments ..... [[32mOK[0m in 0.90s]
[0m13:25:12.475987 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_order_items__order_items
[0m13:25:12.473992 [info ] [Thread-3 (]: 5 of 6 START sql table model analytics_staging.stg_products__products .......... [RUN]
[0m13:25:12.478979 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_payments__payments
[0m13:25:12.480975 [debug] [Thread-2 (]: Began running node model.olist_project.stg_sellers__sellers
[0m13:25:12.483964 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_orders__orders, now model.olist_project.stg_products__products)
[0m13:25:12.487956 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_products__products
[0m13:25:12.498925 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_products__products"
[0m13:25:12.485960 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics_staging.stg_sellers__sellers ............ [RUN]
[0m13:25:12.503912 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_order_items__order_items, now model.olist_project.stg_sellers__sellers)
[0m13:25:12.505907 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_products__products (compile): 13:25:12.488951 => 13:25:12.504911
[0m13:25:12.506903 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_sellers__sellers
[0m13:25:12.507903 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_products__products
[0m13:25:12.515990 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_sellers__sellers"
[0m13:25:12.526076 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_products__products"
[0m13:25:12.528070 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:25:12.530064 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: BEGIN
[0m13:25:12.534053 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:25:12.536048 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.538045 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:25:12.539041 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_products__products__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."main"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m13:25:12.585448 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_sellers__sellers (compile): 13:25:12.508899 => 13:25:12.584451
[0m13:25:12.586447 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_sellers__sellers
[0m13:25:12.619502 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_sellers__sellers"
[0m13:25:12.621496 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:25:12.623491 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: BEGIN
[0m13:25:12.625486 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:25:12.627481 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:25:12.629475 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:25:12.669139 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp"
  
    as (
      

with source as (
  select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
  from main.raw_sellers
)

select * from source
    );
  
  
[0m13:25:13.925965 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:25:13.935937 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (execute): 13:25:11.623722 => 13:25:13.933949
[0m13:25:13.939927 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: Close
[0m13:25:13.943924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c54c074-3bda-481a-a418-72870f576bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFF973D90>]}
[0m13:25:13.945910 [debug] [Thread-2 (]: SQL status: OK in 1.0 seconds
[0m13:25:13.954887 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:25:13.946909 [info ] [Thread-1 (]: 1 of 6 OK created sql table model analytics_staging.stg_customers__customers ... [[32mOK[0m in 2.39s]
[0m13:25:13.955884 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */
alter table "olist"."analytics_staging"."stg_sellers__sellers" rename to "stg_sellers__sellers__dbt_backup"
[0m13:25:13.957880 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_customers__customers
[0m13:25:13.959874 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:25:13.968885 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:25:13.970845 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */
alter table "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp" rename to "stg_sellers__sellers"
[0m13:25:13.973836 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:25:13.978824 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: COMMIT
[0m13:25:13.980817 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:25:13.982818 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: COMMIT
[0m13:25:13.996783 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:25:13.998769 [debug] [Thread-3 (]: SQL status: OK in 1.0 seconds
[0m13:25:14.003755 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:25:14.008780 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:25:14.009745 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */
drop table if exists "olist"."analytics_staging"."stg_sellers__sellers__dbt_backup" cascade
[0m13:25:14.010736 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */
alter table "olist"."analytics_staging"."stg_products__products" rename to "stg_products__products__dbt_backup"
[0m13:25:14.014249 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:14.014249 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:25:14.021360 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:25:14.024350 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_sellers__sellers (execute): 13:25:12.587443 => 13:25:14.024350
[0m13:25:14.026347 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */
alter table "olist"."analytics_staging"."stg_products__products__dbt_tmp" rename to "stg_products__products"
[0m13:25:14.027343 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: Close
[0m13:25:14.030334 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c54c074-3bda-481a-a418-72870f576bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFFB87C10>]}
[0m13:25:14.031332 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:14.037505 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: COMMIT
[0m13:25:14.032504 [info ] [Thread-2 (]: 6 of 6 OK created sql table model analytics_staging.stg_sellers__sellers ....... [[32mOK[0m in 1.53s]
[0m13:25:14.038491 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:25:14.040486 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_sellers__sellers
[0m13:25:14.041485 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: COMMIT
[0m13:25:14.076485 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:14.083469 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:25:14.085464 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */
drop table if exists "olist"."analytics_staging"."stg_products__products__dbt_backup" cascade
[0m13:25:14.088105 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:14.090104 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_products__products (execute): 13:25:12.517097 => 13:25:14.090104
[0m13:25:14.091103 [debug] [Thread-3 (]: On model.olist_project.stg_products__products: Close
[0m13:25:14.185936 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c54c074-3bda-481a-a418-72870f576bfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFFAC3A90>]}
[0m13:25:14.187933 [info ] [Thread-3 (]: 5 of 6 OK created sql table model analytics_staging.stg_products__products ..... [[32mOK[0m in 1.70s]
[0m13:25:14.189928 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_products__products
[0m13:25:14.192917 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:14.194915 [debug] [MainThread]: On master: BEGIN
[0m13:25:14.195920 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:14.227975 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:25:14.228974 [debug] [MainThread]: On master: COMMIT
[0m13:25:14.229971 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:14.230966 [debug] [MainThread]: On master: COMMIT
[0m13:25:14.231966 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:25:14.232963 [debug] [MainThread]: On master: Close
[0m13:25:14.236473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:14.238502 [debug] [MainThread]: Connection 'create_olist_analytics_staging' was properly closed.
[0m13:25:14.239502 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m13:25:14.240463 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m13:25:14.241460 [debug] [MainThread]: Connection 'model.olist_project.stg_customers__customers' was properly closed.
[0m13:25:14.242456 [debug] [MainThread]: Connection 'model.olist_project.stg_sellers__sellers' was properly closed.
[0m13:25:14.243492 [debug] [MainThread]: Connection 'model.olist_project.stg_products__products' was properly closed.
[0m13:25:14.243492 [debug] [MainThread]: Connection 'model.olist_project.stg_payments__payments' was properly closed.
[0m13:25:14.244451 [info ] [MainThread]: 
[0m13:25:14.246448 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m13:25:14.249475 [debug] [MainThread]: Command end result
[0m13:25:14.268387 [info ] [MainThread]: 
[0m13:25:14.270384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:14.273375 [info ] [MainThread]: 
[0m13:25:14.275370 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:25:14.278365 [debug] [MainThread]: Command `dbt run` succeeded at 13:25:14.277364 after 4.47 seconds
[0m13:25:14.279361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFE3DF990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBFE3DF850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBF7559990>]}
[0m13:25:14.280357 [debug] [MainThread]: Flushing usage events
[0m13:25:20.288162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39E4886D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39E29BC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39E47C1D0>]}


============================== 13:25:20.292803 | 501c3fc8-56be-4c95-86a1-b5a90fa0d72d ==============================
[0m13:25:20.292803 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:25:20.292803 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m13:25:20.521874 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:25:20.523865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '501c3fc8-56be-4c95-86a1-b5a90fa0d72d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39E44D0D0>]}
[0m13:25:20.692412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '501c3fc8-56be-4c95-86a1-b5a90fa0d72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39E4A15D0>]}
[0m13:25:20.834308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '501c3fc8-56be-4c95-86a1-b5a90fa0d72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39E5B0B90>]}
[0m13:25:20.837265 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m13:25:20.851227 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m13:25:20.973675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:25:20.974676 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:25:20.976627 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m13:25:20.989592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '501c3fc8-56be-4c95-86a1-b5a90fa0d72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39E4E3F50>]}
[0m13:25:21.017518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '501c3fc8-56be-4c95-86a1-b5a90fa0d72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39F6FB950>]}
[0m13:25:21.018552 [info ] [MainThread]: Found 9 seeds, 6 models, 11 tests, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m13:25:21.019514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '501c3fc8-56be-4c95-86a1-b5a90fa0d72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39F66EB10>]}
[0m13:25:21.024536 [info ] [MainThread]: 
[0m13:25:21.026495 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:25:21.030487 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m13:25:21.033479 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m13:25:21.056451 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:25:21.063681 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:25:21.064635 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m13:25:21.065635 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m13:25:21.067632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:21.068625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:21.087456 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:25:21.089435 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:25:21.090433 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:25:21.091430 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:25:21.093425 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m13:25:21.094427 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m13:25:21.165233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:25:21.183185 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:25:21.186177 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m13:25:21.188171 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m13:25:21.190167 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m13:25:21.191163 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m13:25:21.192161 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m13:25:21.194156 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m13:25:21.203131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '501c3fc8-56be-4c95-86a1-b5a90fa0d72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E399FC2C90>]}
[0m13:25:21.204130 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:21.205127 [debug] [MainThread]: On master: BEGIN
[0m13:25:21.206123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:21.221084 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:25:21.222083 [debug] [MainThread]: On master: COMMIT
[0m13:25:21.223078 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:21.224077 [debug] [MainThread]: On master: COMMIT
[0m13:25:21.225073 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:25:21.226069 [debug] [MainThread]: On master: Close
[0m13:25:21.230060 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:25:21.233051 [info ] [MainThread]: 
[0m13:25:21.238038 [debug] [Thread-1 (]: Began running node test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57
[0m13:25:21.239036 [debug] [Thread-2 (]: Began running node test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d
[0m13:25:21.240037 [debug] [Thread-3 (]: Began running node test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec
[0m13:25:21.240037 [debug] [Thread-4 (]: Began running node test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb
[0m13:25:21.241032 [info ] [Thread-1 (]: 1 of 11 START test not_null_stg_customers__customers_customer_id ............... [RUN]
[0m13:25:21.242036 [info ] [Thread-2 (]: 2 of 11 START test not_null_stg_order_items__order_items_order_item_id ......... [RUN]
[0m13:25:21.248015 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57'
[0m13:25:21.244024 [info ] [Thread-3 (]: 3 of 11 START test not_null_stg_orders__orders_customer_id ..................... [RUN]
[0m13:25:21.251004 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d'
[0m13:25:21.246016 [info ] [Thread-4 (]: 4 of 11 START test not_null_stg_orders__orders_order_id ........................ [RUN]
[0m13:25:21.253000 [debug] [Thread-1 (]: Began compiling node test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57
[0m13:25:21.254995 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec'
[0m13:25:21.255990 [debug] [Thread-2 (]: Began compiling node test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d
[0m13:25:21.257985 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb'
[0m13:25:21.294009 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57"
[0m13:25:21.295004 [debug] [Thread-3 (]: Began compiling node test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec
[0m13:25:21.305975 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d"
[0m13:25:21.305975 [debug] [Thread-4 (]: Began compiling node test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb
[0m13:25:21.317521 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec"
[0m13:25:21.319516 [debug] [Thread-1 (]: Timing info for test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57 (compile): 13:25:21.259982 => 13:25:21.318517
[0m13:25:21.328492 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb"
[0m13:25:21.331487 [debug] [Thread-1 (]: Began executing node test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57
[0m13:25:21.332484 [debug] [Thread-2 (]: Timing info for test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d (compile): 13:25:21.296002 => 13:25:21.332484
[0m13:25:21.334475 [debug] [Thread-3 (]: Timing info for test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec (compile): 13:25:21.307973 => 13:25:21.333478
[0m13:25:21.359409 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57"
[0m13:25:21.360407 [debug] [Thread-4 (]: Timing info for test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb (compile): 13:25:21.320513 => 13:25:21.359409
[0m13:25:21.361404 [debug] [Thread-2 (]: Began executing node test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d
[0m13:25:21.363400 [debug] [Thread-3 (]: Began executing node test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec
[0m13:25:21.364395 [debug] [Thread-4 (]: Began executing node test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb
[0m13:25:21.370380 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d"
[0m13:25:21.371377 [debug] [Thread-1 (]: Using duckdb connection "test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57"
[0m13:25:21.375367 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec"
[0m13:25:21.380355 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb"
[0m13:25:21.382355 [debug] [Thread-1 (]: On test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57: BEGIN
[0m13:25:21.383345 [debug] [Thread-2 (]: Using duckdb connection "test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d"
[0m13:25:21.386338 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:25:21.388464 [debug] [Thread-3 (]: Using duckdb connection "test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec"
[0m13:25:21.389459 [debug] [Thread-4 (]: Using duckdb connection "test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb"
[0m13:25:21.390722 [debug] [Thread-2 (]: On test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d: BEGIN
[0m13:25:21.406676 [debug] [Thread-3 (]: On test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec: BEGIN
[0m13:25:21.407676 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.408672 [debug] [Thread-4 (]: On test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb: BEGIN
[0m13:25:21.409669 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:25:21.411664 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:25:21.412663 [debug] [Thread-1 (]: Using duckdb connection "test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57"
[0m13:25:21.413660 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:25:21.415654 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.416651 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.417649 [debug] [Thread-1 (]: On test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "olist"."analytics_staging"."stg_customers__customers"
where customer_id is null



      
    ) dbt_internal_test
[0m13:25:21.419650 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.420641 [debug] [Thread-2 (]: Using duckdb connection "test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d"
[0m13:25:21.421638 [debug] [Thread-3 (]: Using duckdb connection "test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec"
[0m13:25:21.423633 [debug] [Thread-4 (]: Using duckdb connection "test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb"
[0m13:25:21.424629 [debug] [Thread-2 (]: On test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_item_id
from "olist"."analytics_staging"."stg_order_items__order_items"
where order_item_id is null



      
    ) dbt_internal_test
[0m13:25:21.425627 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.427634 [debug] [Thread-3 (]: On test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "olist"."analytics_staging"."stg_orders__orders"
where customer_id is null



      
    ) dbt_internal_test
[0m13:25:21.429616 [debug] [Thread-4 (]: On test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "olist"."analytics_staging"."stg_orders__orders"
where order_id is null



      
    ) dbt_internal_test
[0m13:25:21.435599 [debug] [Thread-1 (]: Timing info for test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57 (execute): 13:25:21.335473 => 13:25:21.434602
[0m13:25:21.438593 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.439677 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.441586 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.442581 [debug] [Thread-1 (]: On test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57: ROLLBACK
[0m13:25:21.446571 [debug] [Thread-4 (]: Timing info for test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb (execute): 13:25:21.376363 => 13:25:21.445572
[0m13:25:21.450560 [debug] [Thread-3 (]: Timing info for test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec (execute): 13:25:21.372374 => 13:25:21.449563
[0m13:25:21.453552 [debug] [Thread-2 (]: Timing info for test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d (execute): 13:25:21.365400 => 13:25:21.452555
[0m13:25:21.455546 [debug] [Thread-1 (]: Failed to rollback 'test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57'
[0m13:25:21.456543 [debug] [Thread-4 (]: On test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb: ROLLBACK
[0m13:25:21.457541 [debug] [Thread-3 (]: On test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec: ROLLBACK
[0m13:25:21.458538 [debug] [Thread-2 (]: On test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d: ROLLBACK
[0m13:25:21.459542 [debug] [Thread-1 (]: On test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57: Close
[0m13:25:21.460533 [debug] [Thread-4 (]: Failed to rollback 'test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb'
[0m13:25:21.462528 [debug] [Thread-3 (]: Failed to rollback 'test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec'
[0m13:25:21.464629 [debug] [Thread-2 (]: Failed to rollback 'test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d'
[0m13:25:21.466623 [debug] [Thread-4 (]: On test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb: Close
[0m13:25:21.465627 [info ] [Thread-1 (]: 1 of 11 PASS not_null_stg_customers__customers_customer_id ..................... [[32mPASS[0m in 0.22s]
[0m13:25:21.467621 [debug] [Thread-3 (]: On test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec: Close
[0m13:25:21.468618 [debug] [Thread-2 (]: On test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d: Close
[0m13:25:21.472609 [debug] [Thread-1 (]: Finished running node test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57
[0m13:25:21.470614 [info ] [Thread-4 (]: 4 of 11 PASS not_null_stg_orders__orders_order_id .............................. [[32mPASS[0m in 0.21s]
[0m13:25:21.474606 [info ] [Thread-3 (]: 3 of 11 PASS not_null_stg_orders__orders_customer_id ........................... [[32mPASS[0m in 0.22s]
[0m13:25:21.486575 [debug] [Thread-3 (]: Finished running node test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec
[0m13:25:21.488565 [debug] [Thread-3 (]: Began running node test.olist_project.not_null_stg_products__products_product_id.24f0101a0d
[0m13:25:21.482582 [debug] [Thread-1 (]: Began running node test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2
[0m13:25:21.484576 [debug] [Thread-4 (]: Finished running node test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb
[0m13:25:21.479595 [info ] [Thread-2 (]: 2 of 11 PASS not_null_stg_order_items__order_items_order_item_id ............... [[32mPASS[0m in 0.23s]
[0m13:25:21.496544 [debug] [Thread-4 (]: Began running node test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf
[0m13:25:21.499536 [debug] [Thread-2 (]: Finished running node test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d
[0m13:25:21.491558 [info ] [Thread-3 (]: 6 of 11 START test not_null_stg_products__products_product_id .................. [RUN]
[0m13:25:21.503526 [debug] [Thread-2 (]: Began running node test.olist_project.unique_stg_customers__customers_customer_id.1950433078
[0m13:25:21.493554 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_payments__payments_order_id .................... [RUN]
[0m13:25:21.506518 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_project.not_null_stg_orders__orders_customer_id.b4e62b4cec, now test.olist_project.not_null_stg_products__products_product_id.24f0101a0d)
[0m13:25:21.501533 [info ] [Thread-4 (]: 7 of 11 START test not_null_stg_sellers__sellers_seller_id ..................... [RUN]
[0m13:25:21.509510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_project.not_null_stg_customers__customers_customer_id.e1f660dc57, now test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2)
[0m13:25:21.507514 [info ] [Thread-2 (]: 8 of 11 START test unique_stg_customers__customers_customer_id ................. [RUN]
[0m13:25:21.511504 [debug] [Thread-3 (]: Began compiling node test.olist_project.not_null_stg_products__products_product_id.24f0101a0d
[0m13:25:21.514641 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_project.not_null_stg_orders__orders_order_id.16a70c1bcb, now test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf)
[0m13:25:21.516664 [debug] [Thread-1 (]: Began compiling node test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2
[0m13:25:21.518745 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.olist_project.not_null_stg_order_items__order_items_order_item_id.0e478d2e7d, now test.olist_project.unique_stg_customers__customers_customer_id.1950433078)
[0m13:25:21.527721 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_project.not_null_stg_products__products_product_id.24f0101a0d"
[0m13:25:21.528719 [debug] [Thread-4 (]: Began compiling node test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf
[0m13:25:21.539688 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2"
[0m13:25:21.540685 [debug] [Thread-2 (]: Began compiling node test.olist_project.unique_stg_customers__customers_customer_id.1950433078
[0m13:25:21.551656 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf"
[0m13:25:21.553651 [debug] [Thread-3 (]: Timing info for test.olist_project.not_null_stg_products__products_product_id.24f0101a0d (compile): 13:25:21.519743 => 13:25:21.552653
[0m13:25:21.569607 [debug] [Thread-2 (]: Writing injected SQL for node "test.olist_project.unique_stg_customers__customers_customer_id.1950433078"
[0m13:25:21.571603 [debug] [Thread-3 (]: Began executing node test.olist_project.not_null_stg_products__products_product_id.24f0101a0d
[0m13:25:21.573598 [debug] [Thread-1 (]: Timing info for test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2 (compile): 13:25:21.530713 => 13:25:21.572600
[0m13:25:21.579580 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_project.not_null_stg_products__products_product_id.24f0101a0d"
[0m13:25:21.581576 [debug] [Thread-4 (]: Timing info for test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf (compile): 13:25:21.542680 => 13:25:21.580580
[0m13:25:21.582573 [debug] [Thread-1 (]: Began executing node test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2
[0m13:25:21.583569 [debug] [Thread-2 (]: Timing info for test.olist_project.unique_stg_customers__customers_customer_id.1950433078 (compile): 13:25:21.554648 => 13:25:21.583569
[0m13:25:21.585565 [debug] [Thread-4 (]: Began executing node test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf
[0m13:25:21.591550 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2"
[0m13:25:21.592547 [debug] [Thread-3 (]: Using duckdb connection "test.olist_project.not_null_stg_products__products_product_id.24f0101a0d"
[0m13:25:21.593545 [debug] [Thread-2 (]: Began executing node test.olist_project.unique_stg_customers__customers_customer_id.1950433078
[0m13:25:21.600526 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf"
[0m13:25:21.602523 [debug] [Thread-3 (]: On test.olist_project.not_null_stg_products__products_product_id.24f0101a0d: BEGIN
[0m13:25:21.608505 [debug] [Thread-2 (]: Writing runtime sql for node "test.olist_project.unique_stg_customers__customers_customer_id.1950433078"
[0m13:25:21.609502 [debug] [Thread-1 (]: Using duckdb connection "test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2"
[0m13:25:21.611501 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:25:21.613618 [debug] [Thread-1 (]: On test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2: BEGIN
[0m13:25:21.614617 [debug] [Thread-4 (]: Using duckdb connection "test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf"
[0m13:25:21.616611 [debug] [Thread-2 (]: Using duckdb connection "test.olist_project.unique_stg_customers__customers_customer_id.1950433078"
[0m13:25:21.631571 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.632568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:21.633565 [debug] [Thread-4 (]: On test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf: BEGIN
[0m13:25:21.634563 [debug] [Thread-2 (]: On test.olist_project.unique_stg_customers__customers_customer_id.1950433078: BEGIN
[0m13:25:21.635560 [debug] [Thread-3 (]: Using duckdb connection "test.olist_project.not_null_stg_products__products_product_id.24f0101a0d"
[0m13:25:21.637555 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.638551 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:25:21.639550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:25:21.640547 [debug] [Thread-3 (]: On test.olist_project.not_null_stg_products__products_product_id.24f0101a0d: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.not_null_stg_products__products_product_id.24f0101a0d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "olist"."analytics_staging"."stg_products__products"
where product_id is null



      
    ) dbt_internal_test
[0m13:25:21.641543 [debug] [Thread-1 (]: Using duckdb connection "test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2"
[0m13:25:21.643539 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.644543 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.645536 [debug] [Thread-1 (]: On test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "olist"."analytics_staging"."stg_payments__payments"
where order_id is null



      
    ) dbt_internal_test
[0m13:25:21.647530 [debug] [Thread-4 (]: Using duckdb connection "test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf"
[0m13:25:21.648527 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.649522 [debug] [Thread-2 (]: Using duckdb connection "test.olist_project.unique_stg_customers__customers_customer_id.1950433078"
[0m13:25:21.651518 [debug] [Thread-4 (]: On test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select seller_id
from "olist"."analytics_staging"."stg_sellers__sellers"
where seller_id is null



      
    ) dbt_internal_test
[0m13:25:21.654510 [debug] [Thread-3 (]: Timing info for test.olist_project.not_null_stg_products__products_product_id.24f0101a0d (execute): 13:25:21.575592 => 13:25:21.654510
[0m13:25:21.655507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.656503 [debug] [Thread-2 (]: On test.olist_project.unique_stg_customers__customers_customer_id.1950433078: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.unique_stg_customers__customers_customer_id.1950433078"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "olist"."analytics_staging"."stg_customers__customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:25:21.657501 [debug] [Thread-3 (]: On test.olist_project.not_null_stg_products__products_product_id.24f0101a0d: ROLLBACK
[0m13:25:21.660493 [debug] [Thread-1 (]: Timing info for test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2 (execute): 13:25:21.586566 => 13:25:21.660493
[0m13:25:21.661491 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.663596 [debug] [Thread-3 (]: Failed to rollback 'test.olist_project.not_null_stg_products__products_product_id.24f0101a0d'
[0m13:25:21.665591 [debug] [Thread-1 (]: On test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2: ROLLBACK
[0m13:25:21.668584 [debug] [Thread-4 (]: Timing info for test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf (execute): 13:25:21.594542 => 13:25:21.668584
[0m13:25:21.669580 [debug] [Thread-3 (]: On test.olist_project.not_null_stg_products__products_product_id.24f0101a0d: Close
[0m13:25:21.671575 [debug] [Thread-1 (]: Failed to rollback 'test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2'
[0m13:25:21.673569 [debug] [Thread-4 (]: On test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf: ROLLBACK
[0m13:25:21.676575 [debug] [Thread-1 (]: On test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2: Close
[0m13:25:21.675564 [info ] [Thread-3 (]: 6 of 11 PASS not_null_stg_products__products_product_id ........................ [[32mPASS[0m in 0.17s]
[0m13:25:21.678556 [debug] [Thread-4 (]: Failed to rollback 'test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf'
[0m13:25:21.683544 [debug] [Thread-3 (]: Finished running node test.olist_project.not_null_stg_products__products_product_id.24f0101a0d
[0m13:25:21.681548 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_payments__payments_order_id .......................... [[32mPASS[0m in 0.17s]
[0m13:25:21.685537 [debug] [Thread-4 (]: On test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf: Close
[0m13:25:21.686535 [debug] [Thread-3 (]: Began running node test.olist_project.unique_stg_orders__orders_order_id.6aa4906960
[0m13:25:21.688530 [debug] [Thread-1 (]: Finished running node test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2
[0m13:25:21.694513 [debug] [Thread-1 (]: Began running node test.olist_project.unique_stg_products__products_product_id.380ababbc0
[0m13:25:21.691524 [info ] [Thread-4 (]: 7 of 11 PASS not_null_stg_sellers__sellers_seller_id ........................... [[32mPASS[0m in 0.18s]
[0m13:25:21.693516 [info ] [Thread-3 (]: 9 of 11 START test unique_stg_orders__orders_order_id .......................... [RUN]
[0m13:25:21.703489 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.olist_project.not_null_stg_products__products_product_id.24f0101a0d, now test.olist_project.unique_stg_orders__orders_order_id.6aa4906960)
[0m13:25:21.705484 [debug] [Thread-3 (]: Began compiling node test.olist_project.unique_stg_orders__orders_order_id.6aa4906960
[0m13:25:21.699500 [debug] [Thread-4 (]: Finished running node test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf
[0m13:25:21.720568 [debug] [Thread-3 (]: Writing injected SQL for node "test.olist_project.unique_stg_orders__orders_order_id.6aa4906960"
[0m13:25:21.697506 [info ] [Thread-1 (]: 10 of 11 START test unique_stg_products__products_product_id ................... [RUN]
[0m13:25:21.721567 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.723560 [debug] [Thread-4 (]: Began running node test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a
[0m13:25:21.726551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.olist_project.not_null_stg_payments__payments_order_id.444a8c02a2, now test.olist_project.unique_stg_products__products_product_id.380ababbc0)
[0m13:25:21.728545 [debug] [Thread-3 (]: Timing info for test.olist_project.unique_stg_orders__orders_order_id.6aa4906960 (compile): 13:25:21.706485 => 13:25:21.727547
[0m13:25:21.735527 [debug] [Thread-2 (]: Timing info for test.olist_project.unique_stg_customers__customers_customer_id.1950433078 (execute): 13:25:21.603517 => 13:25:21.734531
[0m13:25:21.738637 [debug] [Thread-1 (]: Began compiling node test.olist_project.unique_stg_products__products_product_id.380ababbc0
[0m13:25:21.736525 [info ] [Thread-4 (]: 11 of 11 START test unique_stg_sellers__sellers_seller_id ...................... [RUN]
[0m13:25:21.739634 [debug] [Thread-3 (]: Began executing node test.olist_project.unique_stg_orders__orders_order_id.6aa4906960
[0m13:25:21.741750 [debug] [Thread-2 (]: On test.olist_project.unique_stg_customers__customers_customer_id.1950433078: ROLLBACK
[0m13:25:21.751726 [debug] [Thread-1 (]: Writing injected SQL for node "test.olist_project.unique_stg_products__products_product_id.380ababbc0"
[0m13:25:21.753722 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.olist_project.not_null_stg_sellers__sellers_seller_id.27a3835ddf, now test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a)
[0m13:25:21.760700 [debug] [Thread-3 (]: Writing runtime sql for node "test.olist_project.unique_stg_orders__orders_order_id.6aa4906960"
[0m13:25:21.762810 [debug] [Thread-2 (]: Failed to rollback 'test.olist_project.unique_stg_customers__customers_customer_id.1950433078'
[0m13:25:21.765804 [debug] [Thread-1 (]: Timing info for test.olist_project.unique_stg_products__products_product_id.380ababbc0 (compile): 13:25:21.741750 => 13:25:21.764807
[0m13:25:21.768513 [debug] [Thread-4 (]: Began compiling node test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a
[0m13:25:21.771504 [debug] [Thread-2 (]: On test.olist_project.unique_stg_customers__customers_customer_id.1950433078: Close
[0m13:25:21.772501 [debug] [Thread-3 (]: Using duckdb connection "test.olist_project.unique_stg_orders__orders_order_id.6aa4906960"
[0m13:25:21.773500 [debug] [Thread-1 (]: Began executing node test.olist_project.unique_stg_products__products_product_id.380ababbc0
[0m13:25:21.782474 [debug] [Thread-4 (]: Writing injected SQL for node "test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a"
[0m13:25:21.787631 [debug] [Thread-3 (]: On test.olist_project.unique_stg_orders__orders_order_id.6aa4906960: BEGIN
[0m13:25:21.786463 [info ] [Thread-2 (]: 8 of 11 PASS unique_stg_customers__customers_customer_id ....................... [[32mPASS[0m in 0.27s]
[0m13:25:21.792794 [debug] [Thread-1 (]: Writing runtime sql for node "test.olist_project.unique_stg_products__products_product_id.380ababbc0"
[0m13:25:21.793791 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:25:21.795787 [debug] [Thread-2 (]: Finished running node test.olist_project.unique_stg_customers__customers_customer_id.1950433078
[0m13:25:21.797781 [debug] [Thread-4 (]: Timing info for test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a (compile): 13:25:21.774495 => 13:25:21.796783
[0m13:25:21.815848 [debug] [Thread-1 (]: Using duckdb connection "test.olist_project.unique_stg_products__products_product_id.380ababbc0"
[0m13:25:21.817842 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.818840 [debug] [Thread-4 (]: Began executing node test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a
[0m13:25:21.820834 [debug] [Thread-1 (]: On test.olist_project.unique_stg_products__products_product_id.380ababbc0: BEGIN
[0m13:25:21.821832 [debug] [Thread-3 (]: Using duckdb connection "test.olist_project.unique_stg_orders__orders_order_id.6aa4906960"
[0m13:25:21.828811 [debug] [Thread-4 (]: Writing runtime sql for node "test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a"
[0m13:25:21.829809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:21.831804 [debug] [Thread-3 (]: On test.olist_project.unique_stg_orders__orders_order_id.6aa4906960: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.unique_stg_orders__orders_order_id.6aa4906960"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "olist"."analytics_staging"."stg_orders__orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:25:21.834798 [debug] [Thread-4 (]: Using duckdb connection "test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a"
[0m13:25:21.836913 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.837912 [debug] [Thread-4 (]: On test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a: BEGIN
[0m13:25:21.839907 [debug] [Thread-1 (]: Using duckdb connection "test.olist_project.unique_stg_products__products_product_id.380ababbc0"
[0m13:25:21.840903 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:25:21.843043 [debug] [Thread-1 (]: On test.olist_project.unique_stg_products__products_product_id.380ababbc0: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.unique_stg_products__products_product_id.380ababbc0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "olist"."analytics_staging"."stg_products__products"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:25:21.844041 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.846036 [debug] [Thread-4 (]: Using duckdb connection "test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a"
[0m13:25:21.848030 [debug] [Thread-4 (]: On test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "olist"."analytics_staging"."stg_sellers__sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:25:21.857006 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.860998 [debug] [Thread-4 (]: Timing info for test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a (execute): 13:25:21.822828 => 13:25:21.860001
[0m13:25:21.861995 [debug] [Thread-4 (]: On test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a: ROLLBACK
[0m13:25:21.864988 [debug] [Thread-4 (]: Failed to rollback 'test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a'
[0m13:25:21.866979 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.867979 [debug] [Thread-4 (]: On test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a: Close
[0m13:25:21.871966 [debug] [Thread-1 (]: Timing info for test.olist_project.unique_stg_products__products_product_id.380ababbc0 (execute): 13:25:21.788627 => 13:25:21.871966
[0m13:25:21.876956 [debug] [Thread-1 (]: On test.olist_project.unique_stg_products__products_product_id.380ababbc0: ROLLBACK
[0m13:25:21.878952 [debug] [Thread-1 (]: Failed to rollback 'test.olist_project.unique_stg_products__products_product_id.380ababbc0'
[0m13:25:21.880941 [debug] [Thread-1 (]: On test.olist_project.unique_stg_products__products_product_id.380ababbc0: Close
[0m13:25:21.874959 [info ] [Thread-4 (]: 11 of 11 PASS unique_stg_sellers__sellers_seller_id ............................ [[32mPASS[0m in 0.12s]
[0m13:25:21.885931 [debug] [Thread-4 (]: Finished running node test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a
[0m13:25:21.883934 [info ] [Thread-1 (]: 10 of 11 PASS unique_stg_products__products_product_id ......................... [[32mPASS[0m in 0.16s]
[0m13:25:21.886926 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:25:21.889920 [debug] [Thread-1 (]: Finished running node test.olist_project.unique_stg_products__products_product_id.380ababbc0
[0m13:25:21.893907 [debug] [Thread-3 (]: Timing info for test.olist_project.unique_stg_orders__orders_order_id.6aa4906960 (execute): 13:25:21.754718 => 13:25:21.892923
[0m13:25:21.894904 [debug] [Thread-3 (]: On test.olist_project.unique_stg_orders__orders_order_id.6aa4906960: ROLLBACK
[0m13:25:21.895912 [debug] [Thread-3 (]: Failed to rollback 'test.olist_project.unique_stg_orders__orders_order_id.6aa4906960'
[0m13:25:21.897896 [debug] [Thread-3 (]: On test.olist_project.unique_stg_orders__orders_order_id.6aa4906960: Close
[0m13:25:21.902885 [info ] [Thread-3 (]: 9 of 11 PASS unique_stg_orders__orders_order_id ................................ [[32mPASS[0m in 0.20s]
[0m13:25:21.904879 [debug] [Thread-3 (]: Finished running node test.olist_project.unique_stg_orders__orders_order_id.6aa4906960
[0m13:25:21.907870 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:21.909864 [debug] [MainThread]: On master: BEGIN
[0m13:25:21.911989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:21.930943 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:25:21.932934 [debug] [MainThread]: On master: COMMIT
[0m13:25:21.933932 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:21.934945 [debug] [MainThread]: On master: COMMIT
[0m13:25:21.936924 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:25:21.938917 [debug] [MainThread]: On master: Close
[0m13:25:21.944901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:21.945900 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m13:25:21.946898 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m13:25:21.949889 [debug] [MainThread]: Connection 'test.olist_project.unique_stg_products__products_product_id.380ababbc0' was properly closed.
[0m13:25:21.950886 [debug] [MainThread]: Connection 'test.olist_project.unique_stg_customers__customers_customer_id.1950433078' was properly closed.
[0m13:25:21.952882 [debug] [MainThread]: Connection 'test.olist_project.unique_stg_orders__orders_order_id.6aa4906960' was properly closed.
[0m13:25:21.953879 [debug] [MainThread]: Connection 'test.olist_project.unique_stg_sellers__sellers_seller_id.fef548536a' was properly closed.
[0m13:25:21.954881 [info ] [MainThread]: 
[0m13:25:21.956871 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m13:25:21.962961 [debug] [MainThread]: Command end result
[0m13:25:21.988892 [info ] [MainThread]: 
[0m13:25:21.991886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:21.993878 [info ] [MainThread]: 
[0m13:25:21.994878 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m13:25:21.997870 [debug] [MainThread]: Command `dbt test` succeeded at 13:25:21.996871 after 1.82 seconds
[0m13:25:21.999864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39E4886D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39E488A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3976C9D50>]}
[0m13:25:22.001871 [debug] [MainThread]: Flushing usage events
[0m13:26:39.656677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FE25CCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FE25D350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FE25C210>]}


============================== 13:26:39.663657 | 6720e63e-a1bf-412c-88c8-96a49100da05 ==============================
[0m13:26:39.663657 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:26:39.665651 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\Olist Ecommerce\\olist\\logs'}
[0m13:26:39.866728 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:26:39.868259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6720e63e-a1bf-412c-88c8-96a49100da05', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FE382110>]}
[0m13:26:40.025021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6720e63e-a1bf-412c-88c8-96a49100da05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FE274CD0>]}
[0m13:26:40.182331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6720e63e-a1bf-412c-88c8-96a49100da05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FD65A850>]}
[0m13:26:40.184648 [info ] [MainThread]: Registered adapter: duckdb=1.7.5
[0m13:26:40.198920 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m13:26:40.305464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:40.306424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:40.308456 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.olist_project.marts
[0m13:26:40.319526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6720e63e-a1bf-412c-88c8-96a49100da05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FF5F60D0>]}
[0m13:26:40.343465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6720e63e-a1bf-412c-88c8-96a49100da05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FF4CB890>]}
[0m13:26:40.345459 [info ] [MainThread]: Found 9 seeds, 6 models, 11 tests, 9 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m13:26:40.347452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6720e63e-a1bf-412c-88c8-96a49100da05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FF51FFD0>]}
[0m13:26:40.351442 [info ] [MainThread]: 
[0m13:26:40.354433 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:26:40.358421 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist'
[0m13:26:40.379368 [debug] [ThreadPool]: Using duckdb connection "list_olist"
[0m13:26:40.380363 [debug] [ThreadPool]: On list_olist: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"olist"'
    
  
  
[0m13:26:40.381396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:40.400310 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:26:40.402339 [debug] [ThreadPool]: On list_olist: Close
[0m13:26:40.407290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_olist, now create_olist_analytics_staging)
[0m13:26:40.408288 [debug] [ThreadPool]: Creating schema "database: "olist"
schema: "analytics_staging"
"
[0m13:26:40.420685 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:26:40.421700 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
        select type from duckdb_databases()
        where database_name='olist'
        and type='sqlite'
    
  
[0m13:26:40.422686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:40.438834 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:26:40.443822 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:26:40.444818 [debug] [ThreadPool]: On create_olist_analytics_staging: BEGIN
[0m13:26:40.445853 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:26:40.446855 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:26:40.447811 [debug] [ThreadPool]: On create_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "create_olist_analytics_staging"} */

    
    
        create schema if not exists "olist"."analytics_staging"
    
[0m13:26:40.449805 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:26:40.450804 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m13:26:40.452801 [debug] [ThreadPool]: Using duckdb connection "create_olist_analytics_staging"
[0m13:26:40.452801 [debug] [ThreadPool]: On create_olist_analytics_staging: COMMIT
[0m13:26:40.454794 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:26:40.455827 [debug] [ThreadPool]: On create_olist_analytics_staging: Close
[0m13:26:40.463805 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics'
[0m13:26:40.465762 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_olist_analytics_staging'
[0m13:26:40.474740 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:26:40.478727 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:26:40.482717 [debug] [ThreadPool]: On list_olist_analytics: BEGIN
[0m13:26:40.483262 [debug] [ThreadPool]: On list_olist_analytics_staging: BEGIN
[0m13:26:40.484495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:40.485257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:40.501286 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:26:40.502280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:26:40.503610 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics"
[0m13:26:40.504261 [debug] [ThreadPool]: Using duckdb connection "list_olist_analytics_staging"
[0m13:26:40.505401 [debug] [ThreadPool]: On list_olist_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics'
    and table_catalog = 'olist'
  
[0m13:26:40.506216 [debug] [ThreadPool]: On list_olist_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "connection_name": "list_olist_analytics_staging"} */
select
      'olist' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'analytics_staging'
    and table_catalog = 'olist'
  
[0m13:26:40.572550 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:26:40.582527 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:26:40.585517 [debug] [ThreadPool]: On list_olist_analytics: ROLLBACK
[0m13:26:40.588622 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics'
[0m13:26:40.591659 [debug] [ThreadPool]: On list_olist_analytics_staging: ROLLBACK
[0m13:26:40.591873 [debug] [ThreadPool]: On list_olist_analytics: Close
[0m13:26:40.593868 [debug] [ThreadPool]: Failed to rollback 'list_olist_analytics_staging'
[0m13:26:40.595863 [debug] [ThreadPool]: On list_olist_analytics_staging: Close
[0m13:26:40.602843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6720e63e-a1bf-412c-88c8-96a49100da05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FD6D5E10>]}
[0m13:26:40.603843 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:40.604840 [debug] [MainThread]: On master: BEGIN
[0m13:26:40.605837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:40.621075 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:26:40.622075 [debug] [MainThread]: On master: COMMIT
[0m13:26:40.623070 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:40.624067 [debug] [MainThread]: On master: COMMIT
[0m13:26:40.625065 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:26:40.626063 [debug] [MainThread]: On master: Close
[0m13:26:40.630051 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:26:40.632046 [info ] [MainThread]: 
[0m13:26:40.639027 [debug] [Thread-1 (]: Began running node model.olist_project.stg_customers__customers
[0m13:26:40.641023 [debug] [Thread-2 (]: Began running node model.olist_project.stg_order_items__order_items
[0m13:26:40.642018 [debug] [Thread-3 (]: Began running node model.olist_project.stg_orders__orders
[0m13:26:40.643018 [debug] [Thread-4 (]: Began running node model.olist_project.stg_payments__payments
[0m13:26:40.644016 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_customers__customers ........ [RUN]
[0m13:26:40.645011 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_order_items__order_items .... [RUN]
[0m13:26:40.652992 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.olist_project.stg_customers__customers'
[0m13:26:40.647006 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_orders__orders .............. [RUN]
[0m13:26:40.655982 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.olist_project.stg_order_items__order_items'
[0m13:26:40.649000 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_staging.stg_payments__payments .......... [RUN]
[0m13:26:40.658976 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_customers__customers
[0m13:26:40.660970 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.olist_project.stg_orders__orders'
[0m13:26:40.662963 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_order_items__order_items
[0m13:26:40.665956 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.olist_project.stg_payments__payments'
[0m13:26:40.681914 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_customers__customers"
[0m13:26:40.683075 [debug] [Thread-3 (]: Began compiling node model.olist_project.stg_orders__orders
[0m13:26:40.689099 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_order_items__order_items"
[0m13:26:40.690061 [debug] [Thread-4 (]: Began compiling node model.olist_project.stg_payments__payments
[0m13:26:40.698077 [debug] [Thread-3 (]: Writing injected SQL for node "model.olist_project.stg_orders__orders"
[0m13:26:40.699041 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (compile): 13:26:40.666954 => 13:26:40.699041
[0m13:26:40.705056 [debug] [Thread-4 (]: Writing injected SQL for node "model.olist_project.stg_payments__payments"
[0m13:26:40.707018 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (compile): 13:26:40.684079 => 13:26:40.706055
[0m13:26:40.709011 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_customers__customers
[0m13:26:40.711006 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (compile): 13:26:40.691058 => 13:26:40.710007
[0m13:26:40.712113 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_order_items__order_items
[0m13:26:40.724425 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (compile): 13:26:40.700034 => 13:26:40.724425
[0m13:26:40.776322 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_customers__customers"
[0m13:26:40.777284 [debug] [Thread-3 (]: Began executing node model.olist_project.stg_orders__orders
[0m13:26:40.785302 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_order_items__order_items"
[0m13:26:40.786262 [debug] [Thread-4 (]: Began executing node model.olist_project.stg_payments__payments
[0m13:26:40.794673 [debug] [Thread-3 (]: Writing runtime sql for node "model.olist_project.stg_orders__orders"
[0m13:26:40.795631 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:26:40.803646 [debug] [Thread-4 (]: Writing runtime sql for node "model.olist_project.stg_payments__payments"
[0m13:26:40.805607 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:26:40.806602 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: BEGIN
[0m13:26:40.808600 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:26:40.809596 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: BEGIN
[0m13:26:40.810593 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:26:40.812682 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:26:40.813681 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: BEGIN
[0m13:26:40.814680 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:26:40.815790 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: BEGIN
[0m13:26:40.829753 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:26:40.830752 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:26:40.832745 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:26:40.833743 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:26:40.834741 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:26:40.836737 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:26:40.837737 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:26:40.838731 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:26:40.840725 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_customers__customers__dbt_tmp"
  
    as (
      

with source as (
  select
    customer_id,
    customer_unique_id,
    customer_zip_code_prefix,
    customer_city,
    customer_state
  from main.raw_customers
)

select
  customer_id,
  customer_unique_id,
  customer_zip_code_prefix,
  customer_city,
  customer_state
from source
    );
  
  
[0m13:26:40.841722 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:26:40.842720 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:26:40.843718 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp"
  
    as (
      

select
  order_item_id,
  order_id,
  product_id,
  seller_id,
  shipping_limit_date,
  price,
  freight_value
from "olist"."main"."raw_order_items"
    );
  
  
[0m13:26:40.845712 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_orders__orders__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp,
    order_approved_at,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    order_estimated_delivery_date
  from "olist"."main"."raw_orders"
)


, cleaned as (
  select
    order_id,
    customer_id,
    order_status,
    order_purchase_timestamp::timestamp as order_purchase_at,
    order_approved_at::timestamp as order_approved_at,
    order_delivered_carrier_date::timestamp as order_delivered_carrier_at,
    order_delivered_customer_date::timestamp as order_delivered_customer_at,
    order_estimated_delivery_date::timestamp as order_estimated_delivery_at,
    case 
      when order_delivered_customer_date is not null 
      then date_diff('day', order_purchase_timestamp::timestamp, order_delivered_customer_date::timestamp)
      else null 
    end as days_to_delivery,
    case
      when order_delivered_customer_date > order_estimated_delivery_date then true
      else false
    end as is_late_delivery
  from source
)

select * from cleaned
    );
  
  
[0m13:26:40.846709 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_payments__payments__dbt_tmp"
  
    as (
      

with source as (
  select
    order_id,
    payment_sequential,
    payment_type,
    payment_installments,
    payment_value
  from main.raw_order_payments
)

select * from source
    );
  
  
[0m13:26:40.957414 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:26:40.973370 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:26:40.975365 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */
alter table "olist"."analytics_staging"."stg_payments__payments" rename to "stg_payments__payments__dbt_backup"
[0m13:26:40.977359 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:26:40.988330 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:26:40.989327 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:26:40.991323 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */
alter table "olist"."analytics_staging"."stg_payments__payments__dbt_tmp" rename to "stg_payments__payments"
[0m13:26:40.998305 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:26:41.001296 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */
alter table "olist"."analytics_staging"."stg_order_items__order_items" rename to "stg_order_items__order_items__dbt_backup"
[0m13:26:41.002294 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.044289 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: COMMIT
[0m13:26:41.046286 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.047281 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:26:41.055259 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.056258 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.054262 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:26:41.057257 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: COMMIT
[0m13:26:41.063341 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:26:41.067439 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:26:41.068438 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */
alter table "olist"."analytics_staging"."stg_order_items__order_items__dbt_tmp" rename to "stg_order_items__order_items"
[0m13:26:41.070435 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */
alter table "olist"."analytics_staging"."stg_customers__customers" rename to "stg_customers__customers__dbt_backup"
[0m13:26:41.072427 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */
alter table "olist"."analytics_staging"."stg_orders__orders" rename to "stg_orders__orders__dbt_backup"
[0m13:26:41.074421 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.075419 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.076419 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.081403 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: COMMIT
[0m13:26:41.088514 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:26:41.094661 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:26:41.099166 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:26:41.101163 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */
alter table "olist"."analytics_staging"."stg_customers__customers__dbt_tmp" rename to "stg_customers__customers"
[0m13:26:41.102162 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */
alter table "olist"."analytics_staging"."stg_orders__orders__dbt_tmp" rename to "stg_orders__orders"
[0m13:26:41.104155 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: COMMIT
[0m13:26:41.106151 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.106151 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.111137 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: COMMIT
[0m13:26:41.115204 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: COMMIT
[0m13:26:41.116202 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:26:41.118307 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:26:41.119304 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: COMMIT
[0m13:26:41.120301 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: COMMIT
[0m13:26:41.127282 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.138468 [debug] [Thread-4 (]: Using duckdb connection "model.olist_project.stg_payments__payments"
[0m13:26:41.139461 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_payments__payments"} */
drop table if exists "olist"."analytics_staging"."stg_payments__payments__dbt_backup" cascade
[0m13:26:41.226313 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.233294 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_order_items__order_items"
[0m13:26:41.234290 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_order_items__order_items"} */
drop table if exists "olist"."analytics_staging"."stg_order_items__order_items__dbt_backup" cascade
[0m13:26:41.295492 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.301478 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_customers__customers"
[0m13:26:41.302478 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_customers__customers"} */
drop table if exists "olist"."analytics_staging"."stg_customers__customers__dbt_backup" cascade
[0m13:26:41.368188 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.375168 [debug] [Thread-3 (]: Using duckdb connection "model.olist_project.stg_orders__orders"
[0m13:26:41.376165 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.377394 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.378397 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_orders__orders"} */
drop table if exists "olist"."analytics_staging"."stg_orders__orders__dbt_backup" cascade
[0m13:26:41.380391 [debug] [Thread-4 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.383414 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_customers__customers (execute): 13:26:40.712113 => 13:26:41.382419
[0m13:26:41.387516 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_order_items__order_items (execute): 13:26:40.777284 => 13:26:41.386516
[0m13:26:41.391698 [debug] [Thread-4 (]: Timing info for model.olist_project.stg_payments__payments (execute): 13:26:40.796631 => 13:26:41.390510
[0m13:26:41.392727 [debug] [Thread-1 (]: On model.olist_project.stg_customers__customers: Close
[0m13:26:41.394691 [debug] [Thread-2 (]: On model.olist_project.stg_order_items__order_items: Close
[0m13:26:41.395689 [debug] [Thread-4 (]: On model.olist_project.stg_payments__payments: Close
[0m13:26:41.397683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6720e63e-a1bf-412c-88c8-96a49100da05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FF84FE90>]}
[0m13:26:41.400678 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6720e63e-a1bf-412c-88c8-96a49100da05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FF524DD0>]}
[0m13:26:41.402673 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6720e63e-a1bf-412c-88c8-96a49100da05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FF7CFC50>]}
[0m13:26:41.404698 [info ] [Thread-1 (]: 1 of 6 OK created sql table model analytics_staging.stg_customers__customers ... [[32mOK[0m in 0.75s]
[0m13:26:41.405661 [info ] [Thread-2 (]: 2 of 6 OK created sql table model analytics_staging.stg_order_items__order_items  [[32mOK[0m in 0.75s]
[0m13:26:41.410647 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_customers__customers
[0m13:26:41.407656 [info ] [Thread-4 (]: 4 of 6 OK created sql table model analytics_staging.stg_payments__payments ..... [[32mOK[0m in 0.74s]
[0m13:26:41.412756 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_order_items__order_items
[0m13:26:41.413756 [debug] [Thread-1 (]: Began running node model.olist_project.stg_products__products
[0m13:26:41.416870 [debug] [Thread-4 (]: Finished running node model.olist_project.stg_payments__payments
[0m13:26:41.417868 [debug] [Thread-2 (]: Began running node model.olist_project.stg_sellers__sellers
[0m13:26:41.419863 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics_staging.stg_products__products .......... [RUN]
[0m13:26:41.423854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_customers__customers, now model.olist_project.stg_products__products)
[0m13:26:41.421859 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics_staging.stg_sellers__sellers ............ [RUN]
[0m13:26:41.425847 [debug] [Thread-1 (]: Began compiling node model.olist_project.stg_products__products
[0m13:26:41.427849 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.olist_project.stg_order_items__order_items, now model.olist_project.stg_sellers__sellers)
[0m13:26:41.436820 [debug] [Thread-1 (]: Writing injected SQL for node "model.olist_project.stg_products__products"
[0m13:26:41.438813 [debug] [Thread-2 (]: Began compiling node model.olist_project.stg_sellers__sellers
[0m13:26:41.447790 [debug] [Thread-2 (]: Writing injected SQL for node "model.olist_project.stg_sellers__sellers"
[0m13:26:41.449784 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_products__products (compile): 13:26:41.428840 => 13:26:41.448787
[0m13:26:41.450781 [debug] [Thread-1 (]: Began executing node model.olist_project.stg_products__products
[0m13:26:41.452776 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_sellers__sellers (compile): 13:26:41.439810 => 13:26:41.451777
[0m13:26:41.461751 [debug] [Thread-1 (]: Writing runtime sql for node "model.olist_project.stg_products__products"
[0m13:26:41.462747 [debug] [Thread-2 (]: Began executing node model.olist_project.stg_sellers__sellers
[0m13:26:41.527781 [debug] [Thread-2 (]: Writing runtime sql for node "model.olist_project.stg_sellers__sellers"
[0m13:26:41.529775 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:26:41.530774 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: BEGIN
[0m13:26:41.532769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:41.533765 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:26:41.535759 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.536769 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: BEGIN
[0m13:26:41.537897 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:26:41.538895 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:26:41.540889 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_products__products__dbt_tmp"
  
    as (
      

with products as (
  select
    product_id,
    product_category_name,
    product_name_lenght,
    product_description_lenght,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm
  from "olist"."main"."raw_products"
)

, category_translation as (
  select
    product_category_name,
    product_category_name_english
  from "olist"."main"."raw_product_category_translation"
)

, joined as (
  select
    p.product_id,
    p.product_category_name,
    ct.product_category_name_english,
    p.product_name_lenght,
    p.product_description_lenght,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm
  from products p
  left join category_translation ct
    on p.product_category_name = ct.product_category_name
)

select * from joined
    );
  
  
[0m13:26:41.541929 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:26:41.541929 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:26:41.541929 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */

  
    
    

    create  table
      "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp"
  
    as (
      

with source as (
  select
    seller_id,
    seller_zip_code_prefix,
    seller_city,
    seller_state
  from main.raw_sellers
)

select * from source
    );
  
  
[0m13:26:42.095366 [debug] [Thread-3 (]: SQL status: OK in 1.0 seconds
[0m13:26:42.100354 [debug] [Thread-3 (]: Timing info for model.olist_project.stg_orders__orders (execute): 13:26:40.787383 => 13:26:42.099357
[0m13:26:42.101351 [debug] [Thread-2 (]: SQL status: OK in 1.0 seconds
[0m13:26:42.102352 [debug] [Thread-3 (]: On model.olist_project.stg_orders__orders: Close
[0m13:26:42.109332 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:26:42.111325 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6720e63e-a1bf-412c-88c8-96a49100da05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FF8CE510>]}
[0m13:26:42.113496 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */
alter table "olist"."analytics_staging"."stg_sellers__sellers" rename to "stg_sellers__sellers__dbt_backup"
[0m13:26:42.116629 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:26:42.114494 [info ] [Thread-3 (]: 3 of 6 OK created sql table model analytics_staging.stg_orders__orders ......... [[32mOK[0m in 1.45s]
[0m13:26:42.124608 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:26:42.126603 [debug] [Thread-3 (]: Finished running node model.olist_project.stg_orders__orders
[0m13:26:42.127599 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */
alter table "olist"."analytics_staging"."stg_sellers__sellers__dbt_tmp" rename to "stg_sellers__sellers"
[0m13:26:42.130592 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:26:42.135577 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: COMMIT
[0m13:26:42.136574 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:26:42.138751 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: COMMIT
[0m13:26:42.147723 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:26:42.156701 [debug] [Thread-2 (]: Using duckdb connection "model.olist_project.stg_sellers__sellers"
[0m13:26:42.158696 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_sellers__sellers"} */
drop table if exists "olist"."analytics_staging"."stg_sellers__sellers__dbt_backup" cascade
[0m13:26:42.159691 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:26:42.166760 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:26:42.166792 [debug] [Thread-2 (]: SQL status: OK in 0.0 seconds
[0m13:26:42.167790 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */
alter table "olist"."analytics_staging"."stg_products__products" rename to "stg_products__products__dbt_backup"
[0m13:26:42.171816 [debug] [Thread-2 (]: Timing info for model.olist_project.stg_sellers__sellers (execute): 13:26:41.464743 => 13:26:42.170782
[0m13:26:42.173775 [debug] [Thread-2 (]: On model.olist_project.stg_sellers__sellers: Close
[0m13:26:42.173775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:26:42.176054 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6720e63e-a1bf-412c-88c8-96a49100da05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FF4D6CD0>]}
[0m13:26:42.180767 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:26:42.183758 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */
alter table "olist"."analytics_staging"."stg_products__products__dbt_tmp" rename to "stg_products__products"
[0m13:26:42.182761 [info ] [Thread-2 (]: 6 of 6 OK created sql table model analytics_staging.stg_sellers__sellers ....... [[32mOK[0m in 0.75s]
[0m13:26:42.186767 [debug] [Thread-2 (]: Finished running node model.olist_project.stg_sellers__sellers
[0m13:26:42.187784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:26:42.193734 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: COMMIT
[0m13:26:42.194772 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:26:42.195726 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: COMMIT
[0m13:26:42.227254 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:26:42.233239 [debug] [Thread-1 (]: Using duckdb connection "model.olist_project.stg_products__products"
[0m13:26:42.234236 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "olist_project", "target_name": "dev", "node_id": "model.olist_project.stg_products__products"} */
drop table if exists "olist"."analytics_staging"."stg_products__products__dbt_backup" cascade
[0m13:26:42.237329 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:26:42.240326 [debug] [Thread-1 (]: Timing info for model.olist_project.stg_products__products (execute): 13:26:41.453773 => 13:26:42.239326
[0m13:26:42.241320 [debug] [Thread-1 (]: On model.olist_project.stg_products__products: Close
[0m13:26:42.347272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6720e63e-a1bf-412c-88c8-96a49100da05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FF55FD90>]}
[0m13:26:42.349267 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics_staging.stg_products__products ..... [[32mOK[0m in 0.92s]
[0m13:26:42.351260 [debug] [Thread-1 (]: Finished running node model.olist_project.stg_products__products
[0m13:26:42.355285 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:42.355285 [debug] [MainThread]: On master: BEGIN
[0m13:26:42.356284 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:26:42.387275 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:26:42.388275 [debug] [MainThread]: On master: COMMIT
[0m13:26:42.389272 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:42.390270 [debug] [MainThread]: On master: COMMIT
[0m13:26:42.391267 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:26:42.392411 [debug] [MainThread]: On master: Close
[0m13:26:42.397400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:42.398395 [debug] [MainThread]: Connection 'create_olist_analytics_staging' was properly closed.
[0m13:26:42.399395 [debug] [MainThread]: Connection 'list_olist_analytics' was properly closed.
[0m13:26:42.400391 [debug] [MainThread]: Connection 'list_olist_analytics_staging' was properly closed.
[0m13:26:42.401390 [debug] [MainThread]: Connection 'model.olist_project.stg_products__products' was properly closed.
[0m13:26:42.402387 [debug] [MainThread]: Connection 'model.olist_project.stg_sellers__sellers' was properly closed.
[0m13:26:42.403383 [debug] [MainThread]: Connection 'model.olist_project.stg_orders__orders' was properly closed.
[0m13:26:42.404382 [debug] [MainThread]: Connection 'model.olist_project.stg_payments__payments' was properly closed.
[0m13:26:42.405379 [info ] [MainThread]: 
[0m13:26:42.406374 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m13:26:42.409367 [debug] [MainThread]: Command end result
[0m13:26:42.427546 [info ] [MainThread]: 
[0m13:26:42.429542 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:26:42.431536 [info ] [MainThread]: 
[0m13:26:42.433532 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:26:42.436559 [debug] [MainThread]: Command `dbt run` succeeded at 13:26:42.435526 after 2.89 seconds
[0m13:26:42.437554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FE26BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FCF93C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205FDA25010>]}
[0m13:26:42.438517 [debug] [MainThread]: Flushing usage events
